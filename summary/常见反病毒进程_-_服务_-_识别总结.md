<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/Z7VYVE-VxY_bmBQeVJ3aCg)

**0x01 前言**

上篇文章中给大家分享了一些我自己整理的常见 WAF 进程、服务以及用于识别 WAF 的相关项目，在这篇我将继续给大家分享一些常见反病毒的进程、服务以及识别反病毒的相关项目，至于文章中提到的一些绕过方法可能已经失效，不过还是可以作为参考的，都是以前实战项目中的笔记！

![](https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOfiaqslFGiaXMfGejEicHksQHsPue8icSxsC6w1KwNlu9yEnEoXXs6x5qKeiaEpfNdv31MZob0jQO4eJcg/640?wx_fmt=png)

  

**0x02 常见反病毒进程和服务**

#### (1) 金山毒霸

```
进程名：kxescore.exe、kupdata.exe、kxetray.exe、kwsprotect64.exe
```

#### (2) **360 杀毒 / 卫士**

```
服务名：ZhuDongFangYu（360主动防御的服务）、360 Skylar Service
360杀毒进程名：360sd.exe、360tray.exe、360rp.exe、LiveUpdate360.exe、zhudongfangyu.exe
360卫士进程名：360Safe.exe、360Tray.exe、LiveUpdate360.exe、ZhuDongFangYu.exe
360天擎终端安全管理系统进程名：360skylarsvc.exe
```

#### (3) **腾讯电脑管家**

```
服务名：QQPCRTP
进程名：QQPCRTP.exe、QQPCTray.exe、QQPCNetFlow.exe、QQPCRealTimeSpeedup.exe
```

#### (4) **火绒安全软件**

```
服务名：HipsDaemon
进程名：HipsDaemon.exe、HipsTray.exe、HipsLog.exe、HipsMain.exe、usysdiag.exe、wsctrl.exe
```

#### (5) AVG

```
进程名：avg.exe、avgwdsvc.exe
```

#### (6) **Avast**

```
进程名：AvastUI.exe、ashDisp.exe
```

#### (7) **ESET NOD32 Antivirus**

```
服务名：ekrn
进程名：egui.exe、eguiProxy.exe、ekrn.exe、EShaSrv.exe
```

#### (8) **ClemWin Free Antivirus**

```
进程名：ClamTray.exe、clamscan.exe
```

#### (9) **Sophos Anti-Virus****、Sophos Endpoint Security and Control**

```
服务名：Sophos Web Control、SAVService、SAVAdminService、swi_service、swi_filter
进程名：SavMain.exe、SavProgress.exe
```

#### (10) **Malwarebytes Anti-Malware****、Malwarebytes Premium Trial**

```
服务名：MBAMService
进程名：MBAMService.exe、mbam.exe、mbamtray.exe
```

#### (11) **GData（德国一款安全防护软件）**

*   绕过防护：停止 AntiVirusKit Client 服务，禁用 AVKWCtl 服务，结束 AVKWCtl.exe 进程。
    

```
服务名：GDScan（G Data扫描器）、AVKWCtl（G Data文件系统实时监控）、AntiVirusKit Client（G Data安全软件客户端）、AVKProxy（G Data杀毒代理）、GDBackupSvc（G Data备份服务）
进程名：GDScan.exe、AVKWCtl.exe、AVKCl.exe、AVKProxy.exe、AVKBackupService.exe、AVK.exe
```

#### (12) ****PC-cillin**** **趋势反病毒****、趋势科技防毒墙网络版客户端**

*   绕过防护：趋势科技防毒墙网络版客户端可直接用 taskkill /f /im ntrtscan.exe 命令结束进程来停止实时防护功能，1 分钟左右后自动启动并恢复该进程。
    

```
进程名：ntrtscan.exe、TMBMSRV.exe
```

#### (13) **McAfee AVERT Stinger、McAfee VirusScan Enterprise（麦咖啡）**

*   关闭防护：打开 VirusScan 控制台，关闭 “按访问扫描程序”。
    

```
服务名：McTaskManager、McShield、mfevtp、McAfeeEngineService、McAfeeFramework
进程名：Tbmon.exe、shstat.exe、McTray.exe、mfeann.exe、mfevtps.exe、UdaterUI.exe、naPrdMgr.exe、VsTskMgr.exe、McShield.exe、EngineServer.exe、FrameworkService.exe
```

#### (14) **Symantec endpoint protection（赛门铁克）**

*   绕过防护：可用 shellter 第三方工具免杀 MSF Payload 即可成功绕过，在实战中有过成功案例。
    

```
服务名：ccEvtMgr、ccSetMgr
进程名：ccEvtMgr.exe、ccSetMgr.exe、ccsvchst.exe、rtvscan.exe、smc.exe、smcGui.exe、snac.exe
```

#### (15) Kaspersky **卡巴斯基企业版 / 服务器版**

*   Kaspersky Endpoint Security、Kaspersky Anti-Virus 8.0 企业版
    
*   关闭防护：右键托盘图标，恢复保护和控制。
    
*   绕过防护：Admins/System 权限下可以 Kill 掉 kavtray.exe、kavfswp.exe 进程（执行 3-4 次），成功后会自动运行进程，但中间会间隔几秒后保护功能才生效，快速将 MSF Payload 传上去并执行。klnagent.exe，kavfs.exe 进程在 System、Administrators 权限下都 Kill 不掉 ，显示 Kill 掉成功后又会自动运行进程，朋友说一般杀毒软件都有自保护功能。
    

```
服务名：AVP（保护计算机远离病毒、木马、蠕虫、间谍软件和计算机犯罪。）
进程名：avp.exe、kavfs.exe（Kaspersky Anti-Virus Service）、klnagent.exe（Kaspersky Administraton Kit Network Agent）、kavtray.exe（Kaspersky Anti-Virus tray app“主进程”）、kavfswp.exe（Kaspersky Anti-Virus worker process）
```

#### (16) Windows Defender**（微软）**

*   Microsoft Security Essentials（Win7/2k3）
    
*   System Center Endpoint Protection（2k8/12）
    
*   Windows Defender Antivirus（Win8/10/2k16）
    
*   关闭防护：settings -> Read-time Protection->Enable real-time protection（勾去掉！）。
    

```
服务名：WinDefend、MsMpSvc（帮助用户防止恶意软件及其他潜在的垃圾软件。）
进程名：MsMpEng.exe、NisSrv.exe、MsSense.exe、msseces.exe、MpCmdRun.exe、MSASCui.exe、MSASCuiL.exe、SecurityHealthService.exe
```

****0x03 反病毒识别的相关项目****

#### (1) get_AV

get_AV 项目是 @Se7en 大佬用 PHP 写的一个 Windows 杀软在线对比辅助程序，并且自带了一些杀软进程数据，可以将我们自己搜集整理的杀软进程列表整合起来一起使用。

![](https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOfiaqslFGiaXMfGejEicHksQHspgJicPbW1aCFYlPtw8Tlnj8hl681qz7VhICMv43DGHke7kodJicgICPw/640?wx_fmt=png)

#### (2) SharpAVKB

SharpAVKB 项目是 @Uknow 大佬用 C# 写的一款 KB 补丁编号和杀软进程对比工具，这里我将以前自己搜集的这些 WAF 和反病毒软件的进程添加至 SharpAVKB 中，然后重新编译一下即可，可以直接用 CobaltStrike 的 execute-assembly 命令将该工具直接加载到内存中执行。

![](https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOfiaqslFGiaXMfGejEicHksQHsKTkGvXMEu4l0HLFVj0Ec221mE5tpXbiajXjOhAPC9s5Ou89VOfv5u7w/640?wx_fmt=png)

#### (3) ProcessTree

ProcessTree.cna 是 CobaltStrike 中的一款用于 ps 命令显示进程数并上色的插件，常见管理员工具进程为青色，浏览器进程为绿色，安全防护软件进程为红色，可在插件代码中自行添加相关进程。

![](https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOfiaqslFGiaXMfGejEicHksQHsPTMDFJVjDziaREuBeLp2yspBnqT3W8PfNojEibAfIicIdmmHIOeKdQFicQ/640?wx_fmt=png)

#### (4) 项目地址

*   https://github.com/gh0stkey/avList
    
*   https://github.com/r00tSe7en/get_AV
    
*   https://github.com/uknowsec/SharpAVKB
    
*   https://github.com/3had0w/Antivirus-detection
    
*   https://github.com/ars3n11/Aggressor-Scripts
    

  

![](https://mmbiz.qpic.cn/mmbiz_png/ndicuTO22p6ibN1yF91ZicoggaJJZX3vQ77Vhx81O5GRyfuQoBRjpaUyLOErsSo8PwNYlT1XzZ6fbwQuXBRKf4j3Q/640?wx_fmt=png)  

一如既往的学习，一如既往的整理，一如即往的分享。感谢支持![](https://mmbiz.qpic.cn/mmbiz_png/p5qELRDe5icl7QVywL8iaGT0QBGpOwgD1IwN0z9JicTRvzvnsJicNRr2gRvJib6jKojzC5CJJsFPkEbZQJ999HrH5Gw/640?wx_fmt=png)  

“如侵权请私聊公众号删文”

****扫描关注 LemonSec****  

![](https://mmbiz.qpic.cn/mmbiz_png/p5qELRDe5icncXiavFRorU03O5AoZQYznLCnFJLs8RQbC9sltHYyicOu9uchegP88kUFsS8KjITnrQMfYp9g2vQfw/640?wx_fmt=png)

**觉得不错点个 **“赞”**、“在看” 哦****![](https://mmbiz.qpic.cn/mmbiz_png/3k9IT3oQhT1YhlAJOGvAaVRV0ZSSnX46ibouOHe05icukBYibdJOiaOpO06ic5eb0EMW1yhjMNRe1ibu5HuNibCcrGsqw/640?wx_fmt=png)**