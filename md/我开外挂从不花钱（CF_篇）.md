<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/8pb2eqWR9tadLPE5X2MIkA)

**0x00 前言：**  

写在文章之前，其实我最早步入网安时代前，是一名游戏宅。  

和大多数游戏宅一样，我每天起来想的第一件事情，只想打游戏。

直到有一天，看到了个开挂的神仙，在游戏里按着我的头打，他改变了我的人生轨迹，让我逐渐走上网安这条道路。

![](https://mmbiz.qpic.cn/mmbiz_png/ORwL8p4cVxTgUQ3YoibLic5Z3zScBZhOicuu4u3fkqJ29NibklsTWjbaYfKRAZ952c90CmxUVc0R0aicBx5qNNFOryw/640?wx_fmt=png)

我也是当年的三亿鼠标梦想之一

（别笑，这玩意虽然现在看起来不是很好玩了，但在当时，对于一个十几岁学生而言，满满的热爱）  

![](https://mmbiz.qpic.cn/mmbiz_png/ORwL8p4cVxTgUQ3YoibLic5Z3zScBZhOicuQxibwJyQJFL7290j4VmDNicmQDLMgGCRPaUond8nMemgevvE090hF6nA/640?wx_fmt=png)

**0x01 事情经过：**

当我和往常一样，打开游戏，正常愉快的在打生化模式的时候，突然被一个在天上疯狂屠杀的神仙给秒了

![](https://mmbiz.qpic.cn/mmbiz_png/ORwL8p4cVxTgUQ3YoibLic5Z3zScBZhOicubIxLXvnMFPnGIUlzBKDQ9ULwBggJ0LXKXkccv0iaYWdjpicpLhe7Vic2w/640?wx_fmt=png)

然后从此在各种 QQ 群和网站找买外挂的，不知道是否有人还记得散人小嘀咕 (现已关闭)

![](https://mmbiz.qpic.cn/mmbiz_png/ORwL8p4cVxTgUQ3YoibLic5Z3zScBZhOicuGrayENeK3ydq0LJicTLsZAQg7ZtJRgaOZ6cdvRD7AOo0YrRdwrVws2g/640?wx_fmt=png)

但是奈何那个时候的我是个学生，而且还是家里不会给任何零花钱的那种，所以当我看到他们卖挂十几块钱一天的时候，我整个人就绝望了

![](https://mmbiz.qpic.cn/mmbiz_png/ORwL8p4cVxTgUQ3YoibLic5Z3zScBZhOicuhSRQicNOlTVxUmf824ND2W231sj3WnibP5wicKYcnwCqNuEoxVbWwmdvA/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/ORwL8p4cVxTgUQ3YoibLic5Z3zScBZhOicuYzIgQIszmqTryLmAuxXYIvy5ZHAKNsGaCTFnGxOc95wCZB7Uc5MCiag/640?wx_fmt=png)

那我能怎么办，既然没钱，要么自己写，要么黑掉它发卡的平台，要不就是破解他的程序保护。

这里我就按照我的三个阶段去说吧。

**0x02 自写外挂：**  

易语言，我觉得很多人对这个处于语言鄙视链底端的语言再熟悉不过了。

![](https://mmbiz.qpic.cn/mmbiz_png/ORwL8p4cVxTgUQ3YoibLic5Z3zScBZhOicubIcHrIdg12mRMxOdP49gMohtFVNrYTVLN5ARzssthNib5tWicBN14ibEg/640?wx_fmt=png)

其实我现在写的绝大多数工具，都是使用易去写的，因为我用它用的实在是太熟了。  

![](https://mmbiz.qpic.cn/mmbiz_png/ORwL8p4cVxTgUQ3YoibLic5Z3zScBZhOicuWUKDp5SkOcH3Xlztg8ruf6opfeBvEWuOP183JsjDZOkGOKseVY8qlA/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/ORwL8p4cVxTgUQ3YoibLic5Z3zScBZhOicuw4fHJDKWOlWicYicZFnvr4bYv3ZzKiazC4YBOGCW3ribibSxoWFWogxQkZA/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/ORwL8p4cVxTgUQ3YoibLic5Z3zScBZhOiculuyRDVZ45t47jy7VoJ7tS8qFeQt9uuD7aoJZyhL1g2YNdicVwIMQib7w/640?wx_fmt=png)

部分 shellcode  加密代码 基于 AES：

![](https://mmbiz.qpic.cn/mmbiz_png/ORwL8p4cVxTgUQ3YoibLic5Z3zScBZhOicuO4MQwGSmRkbXgCErhibSteWkugFnjjSGiaqrkCBobD4OF7sfdQ6nsELg/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/ORwL8p4cVxTgUQ3YoibLic5Z3zScBZhOicuvSF4w4D3yCtHYBso6x3MWKBIvPttZ2nctQprcpWuHBJcrXAiaILw91w/640?wx_fmt=png)

我 “扎实” 的程序基础，其实就是来自于那个时候学习易积累的：  

![](https://mmbiz.qpic.cn/mmbiz_png/ORwL8p4cVxTgUQ3YoibLic5Z3zScBZhOicuEHydKaOYA6MqIkYnZiaS3QxeibMoqtH3hNoso6hzSky1Xvyn4GFpsDRA/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/ORwL8p4cVxTgUQ3YoibLic5Z3zScBZhOicuLIRQhRdQfmeusb6I5ekJAhyAuBpHibamHj9u3rAnAYGlUjic4WzqukHA/640?wx_fmt=png)

其实那个时候比较简单，我见过好几个不同的外挂，用的驱动都是同一个人写的，他们要做的，只是按时更新驱动程序，更新人物基址和包，就可以实现，当时没钱买挂，只能自己写，因为框架和驱动都是公开的，唯一要做的就是替换人物基址信息。

![](https://mmbiz.qpic.cn/mmbiz_png/ORwL8p4cVxTgUQ3YoibLic5Z3zScBZhOicuEwhqlL2CTnDdicSdINwb9XJic5f3DoqmGhQ6aTxcKfWL2bCXs3fPHYxQ/640?wx_fmt=png)

不知道有没有记得使用 WPE 刷枪的

![](https://mmbiz.qpic.cn/mmbiz_png/ORwL8p4cVxTgUQ3YoibLic5Z3zScBZhOicucFW9GgUe96BQngsqT7tdYCBOgpWkUYAxxjmsvkTWQhibK5uYLZ7Sywg/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/ORwL8p4cVxTgUQ3YoibLic5Z3zScBZhOicuUUOqU68LDMTChFRGicqlZLibicRvcmPGukOrVpIsZrapCq2JOJw1FnE1Q/640?wx_fmt=png)

当年基本上所有的刷枪软件，都是靠获取 WPE 截取到的封包做到的，不少人上当受骗。

当然也写过一些别的，如果感兴趣的朋友，可以在

公众号回复：CS 易语言

获取到 CS 起源易程序的例子

**（特此声明，只能在单机中使用，仅作学习交流之用，请于下载 24 小时内删除！后门自测！限时自文章发出 24 小时之内获取！）**

**别问我为什么不分享 CF 的, emmmmmm**

![](https://mmbiz.qpic.cn/mmbiz_png/ORwL8p4cVxTgUQ3YoibLic5Z3zScBZhOicuicpyUfECMa3UQzyBRJoUrQ7YT8ics38GK2cHaLIRvAsMpc02xA4ibvWWA/640?wx_fmt=png)

**0x03 Web 渗透干掉发卡网：**

其实发卡网源码有很多，这里拿一套很具有代表性的发卡平台出来说吧!

![](https://mmbiz.qpic.cn/mmbiz_png/ORwL8p4cVxTgUQ3YoibLic5Z3zScBZhOicuMCtaKP3CfaMPC73foqDrM5E2Ou5H692JwTIbMxEMxZy6Oibeza86a0A/640?wx_fmt=png)

这套程序漏洞就比较多了，这里直接白盒审计一下  

![](https://mmbiz.qpic.cn/mmbiz_png/ORwL8p4cVxTgUQ3YoibLic5Z3zScBZhOicuGicmm6ibaSZoj4vCrGf6a7VqWvyj9aD07owAeU9vf6vibzkC53KEfhNCQ/640?wx_fmt=png)

在网站根目录下的 API.php 文件中，有个 SQL 注入，$_POST[“dh”] 不为空则将该参数拼接到 SQL 语句中，但是没有找到 $config,

![](https://mmbiz.qpic.cn/mmbiz_png/ORwL8p4cVxTgUQ3YoibLic5Z3zScBZhOicu8m0pOGMq1V5ADesTjBVZdw0ficc8C5Px7bBtaIBJfJPEexPvzgMQF9Q/640?wx_fmt=png)

我们全局找找，发现它原来是在主页有包含这个文件

![](https://mmbiz.qpic.cn/mmbiz_png/ORwL8p4cVxTgUQ3YoibLic5Z3zScBZhOicuUbSZsOtWYojk6k4Jibb7WzLtepmgMkT1cCNZn8XKCNb2dEY3Rfct0zA/640?wx_fmt=png)

我们丢 sqlmap 跑一下

![](https://mmbiz.qpic.cn/mmbiz_png/ORwL8p4cVxTgUQ3YoibLic5Z3zScBZhOiculVogDMDIOXAxEccQKIUEaDjWNIMOGv3tFDLzrJ686wiaHXVz3eichFsQ/640?wx_fmt=png)

基操跑数据库什么的了

我们解密 MD5 登入后台后，可以发现很多没用使用的卡密信息

![](https://mmbiz.qpic.cn/mmbiz_png/ORwL8p4cVxTgUQ3YoibLic5Z3zScBZhOicuRQe9DFPpVSWtEqfwnxal0eKCttfAKbOUvl3ohmKJTZrLvfbq6BM2pA/640?wx_fmt=png)

挑几个进游戏就可以了

![](https://mmbiz.qpic.cn/mmbiz_png/ORwL8p4cVxTgUQ3YoibLic5Z3zScBZhOicuoJLaZAVJZsEicJ5OtJ1MySGZPIAEI7uc1W51Wh4h5GbwwRva3V3p8fQ/640?wx_fmt=png)

 **但也请各位不要开挂！有句话说的话，开挂一时爽，全家 ** 场！**

这里不吊大家胃口，脱敏后，直接公开程序源代码，其他漏洞大家可自行审计

公众号回复：发卡网  

即可获取源代码

**（特此声明，仅作学习交流之用，请于下载 24 小时内删除！后门自测！限时自文章发出 24 小时之内获取！）**

**0x04 破解程序：**

其实比较简单，学一学就能上手，我们使用 OD 破解即可

当年很多软件是这个样子的（其实现在也是）

这里放一位专门破解辅助大神的破解过程，也比较详细，基本思路就是查壳，脱壳，找关键功能位置，上补丁。

![](https://mmbiz.qpic.cn/mmbiz_png/ORwL8p4cVxTgUQ3YoibLic5Z3zScBZhOiculxhZJB5fIprzI9pJGn3w4E7bpQtfHLoLroF0ibBaDRx4PWGRXpyQkuA/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/ORwL8p4cVxTgUQ3YoibLic5Z3zScBZhOicuNicLWGKblsTaa1S4lo9SG9yMGibUdYlPCEicNB34jicS9ST9iamGC1mfBVw/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/ORwL8p4cVxTgUQ3YoibLic5Z3zScBZhOicuDE4RqPjc0Z6BD3wiag5qaBTowBhWjQlGpYaECTkrbfXx3Wj96dvlNhQ/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/ORwL8p4cVxTgUQ3YoibLic5Z3zScBZhOicurRklp39hv63m5QGRSZFqAOXEZt0FMuEFhT65po7ZrbnnDhwFZaKKjA/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/ORwL8p4cVxTgUQ3YoibLic5Z3zScBZhOicutGoQvorQmrbnaTdtTQU3hia0sdcZBal7zyBTHUJrniaUfmNeCyRFx56w/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/ORwL8p4cVxTgUQ3YoibLic5Z3zScBZhOicuFqM7Ub9Ddpyx5o8FUwlzIolSLrbsQwXbTUHfPDHic1U6KzDuLfPrW6g/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/ORwL8p4cVxTgUQ3YoibLic5Z3zScBZhOicuE9bvIAvTibibEVWwK9mkdibM9r3CzjWrqTiabiaAuvydjuerYNxKSiaMaOQQ/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/ORwL8p4cVxTgUQ3YoibLic5Z3zScBZhOicutXn0m6oBHOiawdeuG7sJlkj97bLK64CQibcSIlREQeiaOFH3vI7OOkh9Q/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/ORwL8p4cVxTgUQ3YoibLic5Z3zScBZhOicuQgMAiaUMQuRmt3iblJ6oRibeXNA4KPmMdxheT7HJguLHJqUcu3RnJTPGA/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/ORwL8p4cVxTgUQ3YoibLic5Z3zScBZhOicuQ2ORgFFOgzuqxIqSOVibGdAMOcCDNe1S2cSoFbLVKGJEoG0ZmhvTQtQ/640?wx_fmt=png)

有的程序程序比较恶心，破解如果触发了它的保护机制，他会给你格盘

![](https://mmbiz.qpic.cn/mmbiz_png/ORwL8p4cVxTgUQ3YoibLic5Z3zScBZhOicuryaWk84ibMB3lqLNBQSZOVkia7OL6Y95etU4nPdjjBE3HdibnSjkeNocQ/640?wx_fmt=png)继续一点一点跟

![](https://mmbiz.qpic.cn/mmbiz_png/ORwL8p4cVxTgUQ3YoibLic5Z3zScBZhOicuPLlRicJBP3Up4uowKE2ibcZkLC2ic8gFIib2pH2YpmjkNiaPeBnf4lIeyog/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/ORwL8p4cVxTgUQ3YoibLic5Z3zScBZhOicuhHfBjJBhjLtvegLVq2Q20iautjWCIOnhcnH4yuJX3rsrFlJc1JsN9xg/640?wx_fmt=png)

往上看，jnz 改为 jmp

![](https://mmbiz.qpic.cn/mmbiz_png/ORwL8p4cVxTgUQ3YoibLic5Z3zScBZhOicuTaB39dyEnxFqxHGGwrSJT9qDAc8H2LWuhcibXanEibJhqEWv26ZfJDmA/640?wx_fmt=png)

然后就是去打补丁，一共 5 处地方，生成补丁就可以了 ，这辅助在 OD 内破解完直接登录无效，必须要打补丁

![](https://mmbiz.qpic.cn/mmbiz_png/ORwL8p4cVxTgUQ3YoibLic5Z3zScBZhOicufbC2ulMrm1EIHjCuaQRjHTTrE12kp3JOeL42xjF6EDQOuIN3YlmzcA/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/ORwL8p4cVxTgUQ3YoibLic5Z3zScBZhOicu71LY83ZCN5W8KjXDegicibHibzEqDicXoLgBxCVVdnbExEc1j4ypWYH9HA/640?wx_fmt=png)

**0x05 后话：**

考虑做一系列的 “我开挂从不花钱” 的文章，分别从不同的游戏，不同的发卡平台以及完整的整条外挂产业链入手。

具体看这篇文章的访问量和增粉数了，如果你喜欢，请一定要记得分享！

这将直接影响这个系列的推出！  

我的文章尽量提供源程序代码，和环境，让大家好去复现和体验！

![](https://mmbiz.qpic.cn/mmbiz_gif/4CQUZJ9euSzCEOz8Tib5cxFHtiaCf1K5IicGnVdxQSLHvbmqe49ibqJurZPPc72d41ibLgmvQYuztwUdpjibDXAaLyUw/640?wx_fmt=gif)