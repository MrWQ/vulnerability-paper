> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/e4_3DGCHsl0OV921WJx-sw)

该系列文章是讲解 Python OpenCV 图像处理知识，前期主要讲解图像入门、OpenCV 基础用法，中期讲解图像处理的各种算法，包括图像锐化算子、图像增强技术、图像分割等，后期结合深度学习研究图像识别、图像分类应用。希望文章对您有所帮助，如果有不足之处，还请海涵~

**本篇文章讲解图像灰度化处理的知识，结合 OpenCV 调用 cv2.cvtColor() 函数实现图像灰度操作，使用像素处理方法对图像进行灰度化处理。基础性知识希望对您有所帮助。**

*   一. 图像灰度化原理
    
*   二. 基于 OpenCV 的图像灰度化处理
    
*   三. 基于像素操作的图像灰度化处理
    
*   四. 总结
    

文章参考自己以前系列图像处理文章及 OpenCV 库函数。同时，本篇文章涉及到《计算机图形学》基础知识，请大家下来补充。该系列在 github 所有源代码：

*   https://github.com/eastmountyxz/  
    ImageProcessing-Python
    

前文回顾（下面的超链接可以点击喔）：

*   [[Python 图像处理] 一. 图像处理基础知识及 OpenCV 入门函数](http://mp.weixin.qq.com/s?__biz=Mzg5MTM5ODU2Mg==&mid=2247484670&idx=1&sn=c31b15b73f27a7ce44ae1350e7f708a2&chksm=cfccb433f8bb3d25c25f044caac29d358fe686602011d8e4cbdc504e3a587e756215ce051819&scene=21#wechat_redirect)
    
*   [Python 图像处理] 二. OpenCV+Numpy 库读取与修改像素
    
*   [[Python 图像处理] 三. 获取图像属性、兴趣 ROI 区域及通道处理](http://mp.weixin.qq.com/s?__biz=Mzg5MTM5ODU2Mg==&mid=2247487743&idx=2&sn=5c0baea7ecabffa609fc4bbfc3824c40&chksm=cfcca032f8bb2924e729647d7a00602d639eeb1d9686641460c0752f9858947311b6309b2634&scene=21#wechat_redirect)
    
*   [[Python 图像处理] 四. 图像平滑之均值滤波、方框滤波、高斯滤波、中值滤波及双边滤波](http://mp.weixin.qq.com/s?__biz=Mzg5MTM5ODU2Mg==&mid=2247488101&idx=1&sn=f7529e05195e98cd5992e7b8c10a369c&chksm=cfcca2a8f8bb2bbee28a7aa11a6a34a72b539398fa61b6df54d829f058008f15efd4b84d5757&scene=21#wechat_redirect)
    
*   [[Python 图像处理] 五. 图像融合、加法运算及图像类型转换](http://mp.weixin.qq.com/s?__biz=Mzg5MTM5ODU2Mg==&mid=2247488186&idx=1&sn=a529c96d6fdd0e5d372265a0287609de&chksm=cfcca277f8bb2b619eeb43b61e762ee7579f4f60647c4dad8ef5f92a19596cf553e51c1666c2&scene=21#wechat_redirect)
    
*   [[Python 图像处理] 六. 图像缩放、图像旋转、图像翻转与图像平移](http://mp.weixin.qq.com/s?__biz=Mzg5MTM5ODU2Mg==&mid=2247489178&idx=1&sn=9476b932ce22f9039266cf14eb9d348b&chksm=cfcca657f8bb2f417b9eda13f58619cbde74eb679b3736b3567d9e588a4a1baa2816c2d6595b&scene=21#wechat_redirect)
    
*   [[Python 图像处理] 七. 图像阈值化处理及民族服饰实验对比](http://mp.weixin.qq.com/s?__biz=Mzg5MTM5ODU2Mg==&mid=2247489212&idx=1&sn=cbe30c912ef9eeb2da252b2c68beed04&chksm=cfcca671f8bb2f67923b82dbbaaf2fc4c1fe6d6b5146931d659f4ede2a91f42bc592ca17415e&scene=21#wechat_redirect)
    
*   [[Python 图像处理] 八. 图像腐蚀与图像膨胀](http://mp.weixin.qq.com/s?__biz=Mzg5MTM5ODU2Mg==&mid=2247491023&idx=1&sn=fb6e82528df9bfd4d024c3ffc658153f&chksm=cfccad02f8bb2414a3dfb14dfe92bccc2b76a9bfd81ea6a5750de5fe7dcf3cf8fab49562419a&scene=21#wechat_redirect)
    
*   [[Python 图像处理] 九. 形态学之图像开运算、闭运算、梯度运算](http://mp.weixin.qq.com/s?__biz=Mzg5MTM5ODU2Mg==&mid=2247491051&idx=1&sn=7769199b36d076552563c4a29e0fd26f&chksm=cfccad26f8bb243083d26b74120bfdef6d13cf14d08679d4bd311aa2d1717bec672bda8fe123&scene=21#wechat_redirect)
    
*   [[Python 图像处理] 十. 形态学之图像顶帽运算和黑帽运算](http://mp.weixin.qq.com/s?__biz=Mzg5MTM5ODU2Mg==&mid=2247491575&idx=1&sn=4d0345abcc85b6539ce8b3e86e011681&chksm=cfccaf3af8bb262c04cedf7b4764852d3874e83fe66050159969811fe43dc0fce237be9d6ae5&scene=21#wechat_redirect)
    
*   [[Python 图像处理] 十一. 灰度直方图概念及 OpenCV 绘制直方图](http://mp.weixin.qq.com/s?__biz=Mzg5MTM5ODU2Mg==&mid=2247496096&idx=1&sn=c40336e179a9fad5cb3b4d64c93f856e&chksm=cfcf416df8b8c87b2476bd157324958513a251c306d8a64686a889d5f493c7676662fc9d1b95&scene=21#wechat_redirect)
    
*   [[Python 图像处理] 十二. 图像几何变换之图像仿射变换、图像透视变换和图像校正](http://mp.weixin.qq.com/s?__biz=Mzg5MTM5ODU2Mg==&mid=2247496551&idx=1&sn=3c9006f26a1459ebc3b91eed29c45106&chksm=cfcf43aaf8b8cabcaf9e60791da6adfd31aa41c609cf3abc7009f093e6fbbdf9bb08f8bed79f&scene=21#wechat_redirect)
    
*   [[Python 图像处理] 十三. 基于灰度三维图的图像顶帽运算和黑帽运算](http://mp.weixin.qq.com/s?__biz=Mzg5MTM5ODU2Mg==&mid=2247496726&idx=1&sn=1e4fcfa9ca0cd26ae68dbbacf9473bbc&chksm=cfcf44dbf8b8cdcd3d4a2fef5b50363cc651e7e42e82ff258006166d798e5518d092d4062e90&scene=21#wechat_redirect)
    
*   [Python 图像处理] 十四. 基于 OpenCV 和像素处理的图像灰度化处理  
    

> 学 Python 近八年，认识了很多大佬和朋友，感恩。深知自己很菜，得拼命努力前行，编程也没有什么捷径，干就对了。希望未来能更透彻学习和撰写文章，同时非常感谢参考文献中的大佬们的文章和分享，共勉。
> 
> - https://blog.csdn.net/eastmount

一. 图像灰度化原理
==========

像灰度化是将一幅彩色图像转换为灰度化图像的过程。彩色图像通常包括 R、G、B 三个分量，分别显示出红绿蓝等各种颜色，灰度化就是使彩色图像的 R、G、B 三个分量相等的过程。灰度图像中每个像素仅具有一种样本颜色，其灰度是位于黑色与白色之间的多级色彩深度，灰度值大的像素点比较亮，反之比较暗，像素值最大为 255（表示白色），像素值最小为 0（表示黑色）。

假设某点的颜色由 RGB(R,G,B) 组成，常见灰度处理算法如表 7.1 所示：

![](https://mmbiz.qpic.cn/mmbiz_png/0RFmxdZEDROt6d0gjicCxbAQokXMSBg0FPwFMsWpNBnXPutibYR2eian2fRoGXK6FaBMnArneOvvrhVNiciauxwjk4A/640?wx_fmt=png)

表 7.1 中 Gray 表示灰度处理之后的颜色，然后将原始 RGB(R,G,B) 颜色均匀地替换成新颜色 RGB(Gray,Gray,Gray)，从而将彩色图片转化为灰度图像。

一种常见的方法是将 RGB 三个分量求和再取平均值，但更为准确的方法是设置不同的权重，将 RGB 分量按不同的比例进行灰度划分。比如人类的眼睛感官蓝色的敏感度最低，敏感最高的是绿色，因此将 RGB 按照 0.299、0.587、0.144 比例加权平均能得到较合理的灰度图像，如公式 7.1 所示。

![](https://mmbiz.qpic.cn/mmbiz_png/0RFmxdZEDROt6d0gjicCxbAQokXMSBg0FGEzMKwEVicN4yEvpopwmrUcDZdPZmJHyfDibo6c0RuicpgkibnjUWc6CUA/640?wx_fmt=png)

二. 基于 OpenCV 的灰度化处理
===================

在日常生活中，我们看到的大多数彩色图像都是 RGB 类型，但是在图像处理过程中，常常需要用到灰度图像、二值图像、HSV、HSI 等颜色，OpenCV 提供了 cvtColor() 函数实现这些功能。其函数原型如下所示：

dst = cv2.cvtColor(src, code[, dst[, dstCn]])

*   src 表示输入图像，需要进行颜色空间变换的原图像
    
*   dst 表示输出图像，其大小和深度与 src 一致
    
*   code 表示转换的代码或标识
    
*   dstCn 表示目标图像通道数，其值为 0 时，则有 src 和 code 决定
    

该函数的作用是将一个图像从一个颜色空间转换到另一个颜色空间，其中，RGB 是指 Red、Green 和 Blue，一幅图像由这三个通道（channel）构成；Gray 表示只有灰度值一个通道；HSV 包含 Hue（色调）、Saturation（饱和度）和 Value（亮度）三个通道。在 OpenCV 中，常见的颜色空间转换标识包括 CV_BGR2BGRA、CV_RGB2GRAY、CV_GRAY2RGB、CV_BGR2HSV、CV_BGR2XYZ、CV_BGR2HLS 等。

下面是调用 cvtColor() 函数将图像进行灰度化处理的代码。

```
#encoding:utf-8
import cv2  
import numpy as np  

#读取原始图片
src = cv2.imread('miao.png')

#图像灰度化处理
grayImage = cv2.cvtColor(src,cv2.COLOR_BGR2GRAY)

#显示图像
cv2.imshow("src", src)
cv2.imshow("result", grayImage)

#等待显示
cv2.waitKey(0)
cv2.destroyAllWindows()
```

输出结果如下图所示，左边是彩色的苗族服饰原图，右边是将彩色图像进行灰度化处理之后的灰度图。其中，灰度图将一个像素点的三个颜色变量设置为相当，R=G=B，此时该值称为灰度值。

![](https://mmbiz.qpic.cn/mmbiz_png/0RFmxdZEDROt6d0gjicCxbAQokXMSBg0FTQSJWK1nIwKJdiaaBzy00X2ynH4aHxd48mfvd6tibiczmLkpRU9Fy4SfQ/640?wx_fmt=png)

同样，可以调用 grayImage = cv2.cvtColor(src, cv2.COLOR_BGR2HSV) 核心代码将彩色图像转换为 HSV 颜色空间，如下图所示。

![](https://mmbiz.qpic.cn/mmbiz_png/0RFmxdZEDROt6d0gjicCxbAQokXMSBg0FPfaePhhkibWjHTiavbEdw4ViaZibeMG0p2s9OJ2OA6iaVDrkwl7pMlGUNUQ/640?wx_fmt=png)

下面 Image_Processing_07_02.py 代码对比了九种常见的颜色空间，包括 BGR、RGB、GRAY、HSV、YCrCb、HLS、XYZ、LAB 和 YUV，并循环显示处理后的图像。

```
#encoding:utf-8
import cv2  
import numpy as np  
import matplotlib.pyplot as plt

#读取原始图像
img_BGR = cv2.imread('miao.png')

#BGR转换为RGB
img_RGB = cv2.cvtColor(img_BGR, cv2.COLOR_BGR2RGB)

#灰度化处理
img_GRAY = cv2.cvtColor(img_BGR, cv2.COLOR_BGR2GRAY)

#BGR转HSV
img_HSV = cv2.cvtColor(img_BGR, cv2.COLOR_BGR2HSV)

#BGR转YCrCb
img_YCrCb = cv2.cvtColor(img_BGR, cv2.COLOR_BGR2YCrCb)

#BGR转HLS
img_HLS = cv2.cvtColor(img_BGR, cv2.COLOR_BGR2HLS)

#BGR转XYZ
img_XYZ = cv2.cvtColor(img_BGR, cv2.COLOR_BGR2XYZ)

#BGR转LAB
img_LAB = cv2.cvtColor(img_BGR, cv2.COLOR_BGR2LAB)

#BGR转YUV
img_YUV = cv2.cvtColor(img_BGR, cv2.COLOR_BGR2YUV)

#调用matplotlib显示处理结果
titles = ['BGR', 'RGB', 'GRAY', 'HSV', 'YCrCb', 
          'HLS', 'XYZ', 'LAB', 'YUV']  
images = [img_BGR, img_RGB, img_GRAY, img_HSV, img_YCrCb,
          img_HLS, img_XYZ, img_LAB, img_YUV]  
for i in xrange(9):  
   plt.subplot(3, 3, i+1), plt.imshow(images[i], 'gray')  
   plt.title(titles[i])  
   plt.xticks([]),plt.yticks([])  
plt.show()
```

其运行结果如图所示：

![](https://mmbiz.qpic.cn/mmbiz_png/0RFmxdZEDROt6d0gjicCxbAQokXMSBg0FQu8heibWt2Nd6gaicldWkicuEicL2kvlhn9icgibkUmnicIA9ojibODXAh0b7A/640?wx_fmt=png)

三. 基于像素操作的灰度化处理
===============

前面讲述了调用 OpenCV 中 cvtColor() 函数实现图像灰度化的处理，接下来讲解基于像素操作的图像灰度化处理方法，主要是最大值灰度处理、平均灰度处理和加权平均灰度处理方法。

1. 最大值灰度处理方法

该方法的灰度值等于彩色图像 R、G、B 三个分量中的最大值，公式如下：

![](https://mmbiz.qpic.cn/mmbiz_png/0RFmxdZEDROt6d0gjicCxbAQokXMSBg0FUvObNvLNQZHJbyhjeTzRPZpmyMwicPnzia55gVAlzCc8Lfb9S7u3Blhw/640?wx_fmt=png)

其方法灰度化处理后的灰度图亮度很高，实现代码如下。

```
#encoding:utf-8
import cv2  
import numpy as np  
import matplotlib.pyplot as plt

#读取原始图像
img = cv2.imread('miao.png')

#获取图像高度和宽度
height = img.shape[0]
width = img.shape[1]

#创建一幅图像
grayimg = np.zeros((height, width, 3), np.uint8)

#图像最大值灰度处理
for i in range(height):
    for j in range(width):
        #获取图像R G B最大值
        gray = max(img[i,j][0], img[i,j][1], img[i,j][2])
        #灰度图像素赋值 gray=max(R,G,B)
        grayimg[i,j] = np.uint8(gray)

#显示图像
cv2.imshow("src", img)
cv2.imshow("gray", grayimg)

#等待显示
cv2.waitKey(0)
cv2.destroyAllWindows()
```

其输出结果如下图所示，其处理效果的灰度偏亮。

![](https://mmbiz.qpic.cn/mmbiz_png/0RFmxdZEDROt6d0gjicCxbAQokXMSBg0F436F8JicYUBEmdsAfBzFiaFjP6piapzVya51VJA777WQ7z8LWHzyD0cJg/640?wx_fmt=png)

2. 平均灰度处理方法  
该方法的灰度值等于彩色图像 R、G、B 三个分量灰度值的求和平均值，其计算公式如下所示：

![](https://mmbiz.qpic.cn/mmbiz_png/0RFmxdZEDROt6d0gjicCxbAQokXMSBg0F7nibiaCD1LbT3drAezo55bicwU7iaGicVr1iaTqUXvxRl04HibsCXVDlUtianw/640?wx_fmt=png)

平均灰度处理方法实现代码如下所示：

```
#encoding:utf-8
import cv2  
import numpy as np  
import matplotlib.pyplot as plt

#读取原始图像
img = cv2.imread('miao.png')

#获取图像高度和宽度
height = img.shape[0]
width = img.shape[1]

#创建一幅图像
grayimg = np.zeros((height, width, 3), np.uint8)
print grayimg

#图像平均灰度处理方法
for i in range(height):
    for j in range(width):
        #灰度值为RGB三个分量的平均值
        gray = (int(img[i,j][0]) + int(img[i,j][1]) + int(img[i,j][2]))  /  3
        grayimg[i,j] = np.uint8(gray)

#显示图像
cv2.imshow("src", img)
cv2.imshow("gray", grayimg)

#等待显示
cv2.waitKey(0)
cv2.destroyAllWindows()
```

其输出结果如下图所示：

![](https://mmbiz.qpic.cn/mmbiz_png/0RFmxdZEDROt6d0gjicCxbAQokXMSBg0FkLtibaHnwCAiam6cSp2QAsceGiarlU1LSJaVkSK13V8RO7QYwmib4BMfHA/640?wx_fmt=png)

3. 加权平均灰度处理方法  
该方法根据色彩重要性，将三个分量以不同的权值进行加权平均。由于人眼对绿色的敏感最高，对蓝色敏感最低，因此，按下式对 RGB 三分量进行加权平均能得到较合理的灰度图像。

![](https://mmbiz.qpic.cn/mmbiz_png/0RFmxdZEDROt6d0gjicCxbAQokXMSBg0FUCvV63Vq5zcGdFG469l3JJLMoW6w962GtIfPBSz0rDQ4a3BXWVUiblw/640?wx_fmt=png)

加权平均灰度处理方法实现代码如下所示：

```
#encoding:utf-8
import cv2  
import numpy as np  
import matplotlib.pyplot as plt

#读取原始图像
img = cv2.imread('miao.png')

#获取图像高度和宽度
height = img.shape[0]
width = img.shape[1]

#创建一幅图像
grayimg = np.zeros((height, width, 3), np.uint8)
print grayimg

#图像平均灰度处理方法
for i in range(height):
    for j in range(width):
        #灰度加权平均法
        gray = 0.30 * img[i,j][0] + 0.59 * img[i,j][1] + 0.11 * img[i,j][2]
        grayimg[i,j] = np.uint8(gray)

#显示图像
cv2.imshow("src", img)
cv2.imshow("gray", grayimg)

#等待显示
cv2.waitKey(0)
cv2.destroyAllWindows()
```

其输出结果如下图所示：

![](https://mmbiz.qpic.cn/mmbiz_png/0RFmxdZEDROt6d0gjicCxbAQokXMSBg0Fn8mwFCxRZx3WoTA4zXWCXph6HFA8FB7w6AcVSdr4T4EWcNibibn0xdvw/640?wx_fmt=png)

四. 总结
=====

写到这里，这篇文章就介绍结束。希望文章对大家有所帮助，如果有错误或不足之处，还请海涵。文章写于连续奔波考博，经历的事情太多，有喜有悲，需要改变自己好好对家人，也希望读者与我一起加油。

感谢在求学路上的同行者，不负遇见，勿忘初心。月是故乡圆啊～

![](https://mmbiz.qpic.cn/mmbiz_jpg/0RFmxdZEDRPr6xrwBEQfL0oAJ6Tlo2APeHpmluFUYK6gicKNJlhRwxDlNlRoFwKQnqvPG6VmJ2j99b7sDJglcTw/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1)

> 2022 年即将离去，又是忙碌的一年，感谢女神的鼓励和小珞治愈的笑容。十月份会更加忙碌，希望一切顺利。守得云开见明月，加油！
> 
> 读博四年，还是写了一些东西，从初入安全的无知到现在的懵懂，也记录一些笔记，也希望对大家有所帮助。今年确实没啥时间写博客了，也没太多时间详细解答博友的问题，还请见谅。图片中颜色越浅甚至白色的时候，自己往往越忙，更多的博客和代码是寒暑假分享，项目、学习、科研、技术，最重要的还是家庭和亲情，娜美人生，感恩前行。
> 
> ![](https://mmbiz.qpic.cn/mmbiz_jpg/0RFmxdZEDROt6d0gjicCxbAQokXMSBg0FVVWqSZkicohw5xibbcAzy65cZxn5pIueE38KvRGzCSN2Voz0FibYdZuAA/640?wx_fmt=jpeg)
> 
> **希望能早日毕业，回到家乡贵州继续当个教书匠，感觉好多要分享的博客，好多要上的课程，好多要开源的代码，好多要学习的知识，期待再次站在讲台前的那一天。继续沉下心去学习，虽菜但勤，继续加油，晚安娜!**
> 
> ![](https://mmbiz.qpic.cn/mmbiz_jpg/0RFmxdZEDROt6d0gjicCxbAQokXMSBg0FzZ8BAt5KicycfqhJf8KyK9SbKhxDV8Gt650BNxKvWGMNoJicFOI7Tgiag/640?wx_fmt=jpeg)

(By: 娜璋之家 2022-10-06 夜于地球)

参考文献：

*   杨秀璋等. 基于苗族服饰的图像锐化和边缘提取技术研究 [J]. 现代计算机，2018(10).
    
*   《数字图像处理》（第 3 版），冈萨雷斯著，阮秋琦译，电子工业出版社，2013 年.
    
*   《数字图像处理学》（第 3 版），阮秋琦，电子工业出版社，2008 年，北京.
    
*   《OpenCV3 编程入门》，毛星云，冷雪飞，电子工业出版社，2015.
    
*   Opencv 学习（十六）之颜色空间转换 cvtColor()
    
*   python+opencv + 图像特效（图像灰度处理、颜色翻转、图片融合，边缘检测，浮雕效果，颜色映射）