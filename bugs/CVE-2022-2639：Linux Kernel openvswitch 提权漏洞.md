> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/TtCKA5pNXGJq13Owc3vpeg)

**上方蓝色字体关注我们，一起学安全！**

**作者：bnlbnf****@Timeline Sec  
**

**本文字数：846**

**阅读时长：2～3min**

**声明：仅供学习参考使用，请勿用作违法用途，否则后果自负**

**0x01 简介**  

  

Open vSwitch 是一个开源的虚拟交换机，专门管理多租赁公共云计算环境，为网络管理员提供虚拟 VM 之间和之内的流量可见性和控制，已经成为大多数基于 Linux 虚拟机的默认选项。

**0x02 漏洞概述**  

  

**漏洞编号：CVE-2022-2639**

在 openvswitch 内核模块中发现整数强制错误。给定足够多的操作，在为新流的新操作复制和保留内存时，reserve_sfa_size() 函数不会按预期返回 -EMSGSIZE，这可能会导致越界写入访问。此漏洞允许本地用户崩溃或可能提升他们在系统上的权限。 

**0x03 影响版本**  

  

3.13 ≤ Linux Kernel < 5.18

**0x04 环境搭建**  

  

Kali Linux

https://www.kali.org/get-kali/#kali-virtual-machines

**0x05 漏洞复现**  

  

uname -r 查看内核版本

![](https://mmbiz.qpic.cn/mmbiz_png/VfLUYJEMVshXvlIZV3kyIyemn2ndiaia3RnTT7yiabN8N9W6ia7A4jMA5f41CicuibdS0qz6w9sTUOm2GOWdDh6bA2dg/640?wx_fmt=png)

下载漏洞 poc

https://github.com/avboy1337/CVE-2022-2639-PipeVersion

编译执行

```
gcc exploit.c -o exploit
./exploit
```

![](https://mmbiz.qpic.cn/mmbiz_png/VfLUYJEMVshXvlIZV3kyIyemn2ndiaia3R3FTxtCezUd5yZVeaU72vCzGQOGO7nqeGUZDvAGgWcSVaicE2xlRKTMg/640?wx_fmt=png)

**0x06 修复方式**  

  

可以通过将 openvswitch 内核模块列入黑名单来防止加载受影响的代码。

有关将内核模块列入黑名单的说明，请参阅

https://access.redhat.com/solutions/41278

```
参考链接：
```

https://access.redhat.com/security/cve/cve-2022-2639

https://nvd.nist.gov/vuln/detail/CVE-2022-2639

https://security-tracker.debian.org/tracker/CVE-2022-2639

  

![](https://mmbiz.qpic.cn/mmbiz_png/VfLUYJEMVsiaASAShFz46a4AgLIIYWJQKpGAnMJxQ4dugNhW5W8ia0SwhReTlse0vygkJ209LibhNVd93fGib77pNQ/640?wx_fmt=png)

  

![](https://mmbiz.qpic.cn/mmbiz_jpg/VfLUYJEMVshAoU3O2dkDTzN0sqCMBceq8o0lxjLtkWHanicxqtoZPFuchn87MgA603GrkicrIhB2IKxjmQicb6KTQ/640?wx_fmt=jpeg)

**阅读原文看更多复现文章**

Timeline Sec 团队  

安全路上，与你并肩前行