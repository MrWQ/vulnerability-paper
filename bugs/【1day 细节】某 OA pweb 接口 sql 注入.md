> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/Elj15LzKjkMskC6kbStM6g)

![](https://mmbiz.qpic.cn/mmbiz_png/h1AzajLJTBu7YOczrAwxaw0KAqv7gHNdsWu0BEtibKibaegocwoGb75HNNUpZ0ukoIu7XxnCpsONILQhseSns4zg/640?wx_fmt=png)

皓月当空，明镜高悬

![](https://mmbiz.qpic.cn/mmbiz_gif/h1AzajLJTBu7YOczrAwxaw0KAqv7gHNdZfzFIibGpEEEjcB4BuCfTfsf4KgL65xJd1EO5ibicom3eT9QDCHzvMr7w/640?wx_fmt=gif)

  
    今天暂时没有发现新的漏洞情报，所以分享一篇某 OA pweb 接口 sql 注入的细节内容。  

![](https://mmbiz.qpic.cn/mmbiz_png/h1AzajLJTBsGR5jHw9fpxuTmXiaCdhv2XNMr0dchtaHWwnQvxvpw9VHyyzZ3Nf1JmvqcU7Hs3bmSA0DbntvIchQ/640?wx_fmt=png)

1

github 上的常规 poc 是：

```
/pweb/careerapply/HrmCareerApplyPerView.jsp?id=1%20union%20select%201,2,sys.fn_sqlvarbasetostr(db_name()),db_name(1),5,6,7 HTTP/1.1
Host: 127.0.0.1:7443
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML,like Gecko)
Accept-Encoding: gzip, deflate
Connection: close

```

我们主要还是看一下是为什么存在这个漏洞。

首先有一个前提需要了解就是此 oa 默认是通过 Resin 部署的，所以它的路由和 Tomcat 这些中间件是不一样的，默认的路径是 WebApp 所有的内容，不存在 www 或者 webapps 一说。

那么我们首先分析一下路由，既然访问的是 HrmCareerApplyPerView.jsp 那么有两种方式可以找到，首先访问 jsp 的话肯定是可以找到一个源文件的，直接搜 HrmCareerApplyPerView.jsp 即可。

还有一种方法是直接通过访问路径去就是 WebApp 下面的 / pweb/careerapply 路径，也可以找到这个文件，在这个文件夹下面就可以找到这个 HrmCareerApplyPerView.jsp 文件，如下图所示：  
  

![](https://mmbiz.qpic.cn/mmbiz_png/h1AzajLJTBsGR5jHw9fpxuTmXiaCdhv2XSiboLOfKx3XGiaI0zHPsfoHUA7rfX9MzvPlV7G4pIBr5bCnYU9zibWoOw/640?wx_fmt=png)

看一下文件内的内容，可以看通过 id 进行传参，保存为 id

request.getParameter 方法在获取的时候是不会区分到底是 get 还是 post 请求的传参，这里是都可以解析的。

![](https://mmbiz.qpic.cn/mmbiz_png/h1AzajLJTBsGR5jHw9fpxuTmXiaCdhv2XUeAa8ZKsiayG7Exav3cnWnMRTru7LCl6gDqcemic0MRhjibF3VB4RnxSg/640?wx_fmt=png)

然后在下面的代码中直接就拼接了，算是非常经典的 sql 注入了，应该是老代码，否则不会这么写的。

![](https://mmbiz.qpic.cn/mmbiz_png/h1AzajLJTBsGR5jHw9fpxuTmXiaCdhv2XicgAe2niacKyy5NUGtRz6KRmcVypm46ZX1MNQ7qE47ndoJSpxnZPe7dA/640?wx_fmt=png)

以上。

![](https://mmbiz.qpic.cn/mmbiz_png/h1AzajLJTBsGR5jHw9fpxuTmXiaCdhv2XyzlwsZDUwVYeShmG5PSjqqOpUW3KCwb8q4pVmBso9BrqVTibFm576rQ/640?wx_fmt=png)

近期文章：

[【8-29 网安面试题】今天的题目很简单，我猜你可能不会  
](http://mp.weixin.qq.com/s?__biz=Mzg4MDg5NzAxMQ==&mid=2247484843&idx=1&sn=772b303b7bfebde91f5178944bbcd375&chksm=cf6f7b37f818f22196b97caa7967c4f5d3f097608df9207c8860b0fc300e22378d7a211403d8&scene=21#wechat_redirect)

[【8-27 网安面试题】这些基础题你还记得吗  
](http://mp.weixin.qq.com/s?__biz=Mzg4MDg5NzAxMQ==&mid=2247484823&idx=1&sn=33b81fbc4fb970c623e77d7a5ef46525&chksm=cf6f7b0bf818f21d3450c49112319228ee7fb2557f4914af6808ec6fc7fa3f9c5bd38780228c&scene=21#wechat_redirect)

[](http://mp.weixin.qq.com/s?__biz=Mzg4MDg5NzAxMQ==&mid=2247484823&idx=1&sn=33b81fbc4fb970c623e77d7a5ef46525&chksm=cf6f7b0bf818f21d3450c49112319228ee7fb2557f4914af6808ec6fc7fa3f9c5bd38780228c&scene=21#wechat_redirect)[【严重漏洞】 Apache FreeRDP 出现多个 cve 漏洞](http://mp.weixin.qq.com/s?__biz=Mzg4MDg5NzAxMQ==&mid=2247484859&idx=1&sn=eb3e9f6d87304e78741397da0c29936b&chksm=cf6f7b27f818f2313bb5832d63d54d85dc146bf3ebcc06278a2c8dd59605e7b1d442b0a3fa25&scene=21#wechat_redirect)  
[【严重漏洞】 Apache FreeRDP 出现多个 cve 漏洞](http://mp.weixin.qq.com/s?__biz=Mzg4MDg5NzAxMQ==&mid=2247484859&idx=1&sn=eb3e9f6d87304e78741397da0c29936b&chksm=cf6f7b27f818f2313bb5832d63d54d85dc146bf3ebcc06278a2c8dd59605e7b1d442b0a3fa25&scene=21#wechat_redirect)

[【高危漏洞】【未修复】EduSoho 企培开源版存在未授权访问漏洞  
](http://mp.weixin.qq.com/s?__biz=Mzg4MDg5NzAxMQ==&mid=2247484863&idx=1&sn=fd7d16aef7c10a2699fb491b0ea02bbe&chksm=cf6f7b23f818f235e455e36c1ff8cf56d2dd964ea7f37a11ce67e7c63d2cb705f212ad02278e&scene=21#wechat_redirect)

[【高危漏洞】达梦大数据分析平台存在未授权访问漏洞](http://mp.weixin.qq.com/s?__biz=Mzg4MDg5NzAxMQ==&mid=2247484863&idx=2&sn=f6032b4c7a109a838b9392ef2950abce&chksm=cf6f7b23f818f23587ab5d2095882f8ff6a1bb0e205a67c49016dfe860ed4abe67b47e5467ac&scene=21#wechat_redirect)

[【严重漏洞】CVE-2023-34968  Samba 信息泄露漏洞](http://mp.weixin.qq.com/s?__biz=Mzg4MDg5NzAxMQ==&mid=2247484853&idx=1&sn=e1e42f0123d773143f6eb8b56669ec70&chksm=cf6f7b29f818f23fe32ad614b7c99821d28a1f20e3b8ca2fc4543b754e6c1de14e878862b4ff&scene=21#wechat_redirect)

[【高危漏洞】启明星辰信息安全技术有限公司 4A 统一安全管控平台存在命令执行漏洞](http://mp.weixin.qq.com/s?__biz=Mzg4MDg5NzAxMQ==&mid=2247484849&idx=1&sn=30d011f2463c4912c42491289a590062&chksm=cf6f7b2df818f23b8376cbb2f6e2da22b223ea184c98106ddbbae747b44a0d2299a3c3202d27&scene=21#wechat_redirect)

[【高危漏洞】CVE-2023-40195-Apache Airflow 存在反序列化漏洞](http://mp.weixin.qq.com/s?__biz=Mzg4MDg5NzAxMQ==&mid=2247484843&idx=2&sn=b6bcc3857a123bc3a0f79238617ada50&chksm=cf6f7b37f818f2212881d7cbb330d01874949be7a51e6433fbc79450d7ec968bc3eaaca37b51&scene=21#wechat_redirect)