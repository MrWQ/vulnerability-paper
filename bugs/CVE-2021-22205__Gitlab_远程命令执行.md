<meta name="referrer" content="no-referrer"/>
> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/DGD6kabuELC4UQWobwV1hg)

公众号

上班时间日常划水刷 hackone，看到了这报告，不得不佩服大佬的操作，本文只做复现。攻击者可利用该漏洞在目标服务器上执行任意命令，该漏洞影响从 11.9 开始的所有版本，由于 Gitlab 未正确验证传递到文件解析器的图像文件从而导致命令执行。攻击者可构造恶意请求利用该漏洞在目标系统执行任意指令，最终导致 Gitlab 服务器被控制。建议受影响用户将 GitLab 升级至最新版本进行防护，做好资产自查以及预防工作，以免遭受黑客攻击。原理分析见原文：

```
https://hackerone.com/reports/1154542
```

**影响版本**

Gitlab CE/EE < 13.10.3

Gitlab CE/EE < 13.9.6

Gitlab CE/EE < 13.8.8

**漏洞复现**  

1. 下载原文的 POC 文件 echo_vakzz.jpg.zip  

![](https://mmbiz.qpic.cn/mmbiz_png/flBFrCh5pNYg42Gjj6SibLSpiavUENOFwafUUibWVgtkkSlI9YFBhmlJMFOdzbVK8icH4Okkd7sRn6ic1ic8iaSQ5YXug/640?wx_fmt=png)

2. 解压 echo_vakzz.jpg.zip 文件，在图片 echo_vakzz.jpg 最后修改要执行的命令

![](https://mmbiz.qpic.cn/mmbiz_png/flBFrCh5pNYg42Gjj6SibLSpiavUENOFwaVlxCY6qA45QBuUlYOGf3ujqawcU2LlzBl4VwXvx5UG4jDHfUCV2nLw/640?wx_fmt=png)

3. 在 Gitlab 中新建 snippets，在 Description 字段中，点击 "Attach a file"，上传已经写好命令的图片 echo_vakzz.jpg

![](https://mmbiz.qpic.cn/mmbiz_png/flBFrCh5pNYg42Gjj6SibLSpiavUENOFwaCnb4nYpsicR4HibncQ7gA9oSbtHkp6rYAMrRqjQVOSHQgxRt6zc9HFbA/640?wx_fmt=png)

4. 命令成功执行

![](https://mmbiz.qpic.cn/mmbiz_png/flBFrCh5pNYg42Gjj6SibLSpiavUENOFwaRLYibIgKVQGH2AibkP7jpT4fY0fmqicHvxGOiclm7zcDNCKGeBYIsIa5XA/640?wx_fmt=png)

原理请参考原文：https://hackerone.com/reports/1154542

**修复建议**  

建议用户将 GitLab 社区版（CE）和企业版（EE）版本升级至 13.10.3、13.9.6 和 13.8.8 进行防护。  

公众号