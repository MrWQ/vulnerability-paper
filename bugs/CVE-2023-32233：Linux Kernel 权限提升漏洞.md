> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/WMMlIn8BjrFRuN1-V2mldQ)

> 关注我们❤️，添加星标🌟，一起学安全！  
> 作者：inSight@Timeline Sec  
> 本文字数：635  
> 阅读时长：1～3min  
> 声明：仅供学习参考使用，请勿用作违法用途，否则后果自负  

0x01 简介  

----------

Linux Kernel 是 Linux 操作系统的主要组件，也是计算机硬件与其进程之间的核心接口。它负责两者之间的通信，还要尽可能高效地管理资源。

0x02 漏洞概述  

------------

**漏洞编号：CVE-2023-32233**

Linux Kernel 的 Netfilter nf_tables 子系统存在释放后重用漏洞，由于匿名集处理不当，当处理批处理请求时，`Netfilter nf_tables(net/netfilter/nf_tables_api.c)`中存在 use-after-free 漏洞，可利用该漏洞对内核内存执行任意读写操作，成功利用该漏洞的本地用户可获得 root 权限或导致系统崩溃。

0x03 影响版本  

------------

v5.1-rc1 <= Linux Kernel <= 6.3.1

0x04 环境搭建  

------------

一旦在易受攻击的系统上启动了 PoC，该系统可能会处于不稳定状态，并且内核内存可能被破坏。建议在专用系统上测试 PoC，以避免可能的数据损坏。

复现环境系统版本为 ubantu23.04  系统内核为 6.2.0-20

![](https://mmbiz.qpic.cn/sz_mmbiz_png/VfLUYJEMVsgY5hV1SBIMGGDkj7MiaibqO1OhvwonsLP1FWp3NBcHpghJQeSsFDToeE2eicQicFcUoTUNn8icESWL5Xg/640?wx_fmt=png)

0x05 漏洞复现  

------------

从 https://github.com/Liuk3r/CVE-2023-32233 下载 exp 到虚拟机 随后安装相关依赖

```
sudo apt install gcc libmnl-dev libnftnl-dev


```

![](https://mmbiz.qpic.cn/sz_mmbiz_png/VfLUYJEMVsgY5hV1SBIMGGDkj7MiaibqO16RibliaxgRHpd81icRsF09IYw38wZEc919xEaicWpGsiccvHMfcicSSJLg8g/640?wx_fmt=png)

编译 exp

```
gcc -Wall -o exploit exploit.c -lmnl -lnftnl


```

![](https://mmbiz.qpic.cn/sz_mmbiz_png/VfLUYJEMVsgY5hV1SBIMGGDkj7MiaibqO11r2G3LtjIcqJVUZLic49ichDToM9g6dGonaVgMYa2PyIicpETFPCo5MWg/640?wx_fmt=png)

执行`./exploit`

![](https://mmbiz.qpic.cn/sz_mmbiz_png/VfLUYJEMVsgY5hV1SBIMGGDkj7MiaibqO1WrQdC9DETPG4QwicBWSWKsVscwicrwIKNvnOWhucc0AzSAkcbCGLeZzw/640?wx_fmt=png)![](https://mmbiz.qpic.cn/sz_mmbiz_png/VfLUYJEMVsgY5hV1SBIMGGDkj7MiaibqO1s2f1CGhk4MIrKp8F2ZOIMicqicibDmkGVsTPJmQVhiaUUTofcgAblLYILA/640?wx_fmt=png)

可以看到已经是 root 用户了

0x06 修复方式  

------------

目前该漏洞已经修复，受影响用户可升级到以下版本：

Linux kernel 版本 >= 6.4-rc1

Linux kernel 版本 < 5.1-rc1

参考链接  

-------

https://www.openwall.com/lists/oss-security/2023/05/15/5

https://github.com/Liuk3r/CVE-2023-32233

**推荐服务**

![](https://mmbiz.qpic.cn/mmbiz_gif/VfLUYJEMVsjT9XsXuYuJ5o1RJZ95l1HcXV5tiaKbHOU6uPrSgotxOAWBYGLbxmjWj4bib26lsefdkTR94Zj8Djdw/640?wx_fmt=gif)

**历史漏洞**

[CVE-2022-2639](http://mp.weixin.qq.com/s?__biz=MzA4NzUwMzc3NQ==&mid=2247491418&idx=1&sn=a67dd319b48b5656bdb046fe526e62d1&chksm=903939aaa74eb0bcc8b3b29f1ec52aed61722da1be919be754f0aa3d80264de78db5939dc77c&scene=21#wechat_redirect)

[CVE-2022-0847](http://mp.weixin.qq.com/s?__biz=MzA4NzUwMzc3NQ==&mid=2247490109&idx=1&sn=07a02885a81bc1473e86c5b5b7dc0faf&chksm=90393ccda74eb5db443ef62a93660f042e9811341eba19184f0cd4da833cb2c4685a5869e33c&scene=21#wechat_redirect)  

[CVE-2021-3493](http://mp.weixin.qq.com/s?__biz=MzA4NzUwMzc3NQ==&mid=2247488297&idx=1&sn=92ec8332ec1fc5b47a5d94766cc6b679&chksm=903935d9a74ebccf598aebcc4765e7811c02f69de4706345dda85c77aaa2624dcb754b4cb224&scene=21#wechat_redirect)

[CVE-2019-13272](http://mp.weixin.qq.com/s?__biz=MzA4NzUwMzc3NQ==&mid=2247483881&idx=1&sn=b1f39a6e0afeb0d12142ed4d7e401ebe&chksm=90392719a74eae0fb723fc29ba70f6ca60acc5e8f4adc3ef0350940ef88fa586c05ed3d46512&scene=21#wechat_redirect)  

**后台功能**  

回复【1】领取新人学习资料  
回复【2】进入漏洞查询功能  
回复【3】获取加群方式  
回复【4】领取安全电子书籍  

回复【5】进入 SRC-QQ 交流群

**商务合作  
**

[Timeline Sec 团队可合作项目清单](http://mp.weixin.qq.com/s?__biz=MzA4NzUwMzc3NQ==&mid=2247491949&idx=1&sn=5fd239d21a4a07859707b810c2a431ab&chksm=903ac79da74d4e8bf12c52fa3f3a0b14a9fbca35472362d4c40a4d9a6968a16e8d449896889c&scene=21#wechat_redirect)