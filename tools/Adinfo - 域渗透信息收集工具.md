> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/58yYi2Mlzx-pgmPMcV4HGQ)

<table><tbody><tr><td width="557" valign="top" height="62"><p><strong>声明：</strong>该公众号分享的安全工具和项目均来源于网络，仅供安全研究与学习之用，如用于其他用途，由使用者承担全部法律及连带责任，与工具作者和本公众号无关。</p></td></tr></tbody></table>

**工具介绍**

此为去年实习时依照 goddi 二开的基于 go 的 ldap 查询工具，修复了连接时可能会存在的 bug、依照攻防及域信息收集经验 dump 快而有用的域信息，刚学 go 的时候写的，能跑就行。

**使用方式**

1. 输出所有信息  

```
./Adinfo -d redteam.lab --dc 192.168.131.130 -u fff -H 5e95607216d9a4b7654d831beb9ee95c
./Adinfo -d redteam.lab --dc 192.168.131.130 -u fff -p Qq123456..

```

![](https://mmbiz.qpic.cn/mmbiz_png/79gZQNibQ6udsWcibjvAVSZYmjdJr4oAW1H5V6RCCAVUGkJgSG8D5OdJ9wk65ql4bcUicjQ9YzrP1TCl0XicbaWXqw/640?wx_fmt=png)

2. 当域很大或者目前只需要特定属性的值，可以指定下面的参数进行查询

```
      --getPolicy                get domain Policy
      --getDCandExchangeDNS      get DC and Exchange DNS
      --getAllDNS                get all domain DNS
      --getmaq                   get domain MAQ
      --getdomainVersion         get domain Version
      --getMail                  get domain Mail
      --getSID                   get domain SID
      --getExchangeInformation   get Exchange Information
      --getDomainTrusts          get trusts domain
      --getSPN                   get all SPN
      --getGPO                   get all GPO
      --getDomainAdmins          get all domain admins
      --dclocaladministrators    get dc local administrators
      --BackupOperators          get dc local Backup Operators
      --getDC                    get all DomainControllers
      --getAllUser               get all domain user
      --getUsefulUserName        get all not Disabled and Locked user(only name)
      --getHighlevelUser         get users that admincount=1(only name)
      --getNotusefulUser         get not useful user(Locked or Disabled)
      --getUsersNoExpire         get users not expire
      --getComputers             get all domain computers
      --getComputersName         get all domain computers(only name)
      --getDomainGroup           get all domain group
      --getCreatorSID            get all CreatorSID
      --getADCS                  get ADCS information
      --getOU                    get domain OU
      --checkLAPS                get is have LAPS, If the current user has permission, all LAPS passwords will be exported.
      --checkbackdoor            check backdoor：MAQ、AsReproast、Kerberoast、SIDHistory、GetRBCD、UnconstrainedDeligation、ConstrainedDeligation、SensitiveDelegateAccount
      --Krbtgttime               get Krbtgt password last set time

```

**举以下三例说明：**

(1). 查看域内 ADCS 信息，并具体的 FQDN 和 ip

```
./Adinfo_darwin -d redteam.lab --dc 192.168.131.130 -u fff -p Qq123456..  --getADCS

```

![](https://mmbiz.qpic.cn/mmbiz_png/79gZQNibQ6udsWcibjvAVSZYmjdJr4oAW1cYJj0Q5oY3XrAMico7Ur9GPk4CXfWnBd1asGKLjJ5XHqc5siaibTlRZhQ/640?wx_fmt=png)

(2). 获取域内所有的 DNS 信息

```
./Adinfo_darwin -d redteam.lab --dc 192.168.131.130 -u fff -p Qq123456.. --getAllDNS

```

![](https://mmbiz.qpic.cn/mmbiz_png/79gZQNibQ6udsWcibjvAVSZYmjdJr4oAW1AC1dN4EaoAIsG5MxJFZt0DLZqmZ4kBahrhG2PPTbs0f5AZldCWWawA/640?wx_fmt=png)

![](https://mmbiz.qpic.cn/mmbiz_png/79gZQNibQ6udsWcibjvAVSZYmjdJr4oAW1rzEesJwkluibhPJmNWQU67BPavAXGTvzZgGGCJd1MRl1re9ibHs5Tw6A/640?wx_fmt=png)

(3). 获取域内所有用户名（过滤掉了 disabled 和 Locked user，只输出用户名到 Users_OnlyName.csv 中，将 csv 重命名为 txt 就能对所有有用的域用户进行密码喷洒）

```
./Adinfo_darwin -d redteam.lab --dc 192.168.131.130 -u fff -p Qq123456.. --getUsefulUserName

```

![](https://mmbiz.qpic.cn/mmbiz_png/79gZQNibQ6udsWcibjvAVSZYmjdJr4oAW1r35IwiaFRG68tt5aRiayGow54sfZ4xULicSJLzbybnv7uTZgGUoVAYiadQ/640?wx_fmt=png)

**下载地址**

**点击下方名片进入公众号**

**回复关键字【****1018****】获取******下载链接****

关注公众号回复 “1208” 可以领取个人常用高效爆破字典，“0221”2020 年酒仙桥文章打包，“1212” 杀软对比源码 + 数据源，“0421”Windows 提权工具包。

往期推荐工具

[渗透测试常用的数据库综合利用工具](http://mp.weixin.qq.com/s?__biz=MzA4NzU1Mjk4Mw==&mid=2247484579&idx=1&sn=2f2054508220223100066edf3064b37b&chksm=9036e21ba7416b0d7afecc97d3338d954023a51a5622939782273f264207363e4ea8ba9d18de&scene=21#wechat_redirect)

[RequestTemplate 红队内网渗透工具](http://mp.weixin.qq.com/s?__biz=MzA4NzU1Mjk4Mw==&mid=2247484512&idx=1&sn=90d24f2727ba99c870d7112c406bf208&chksm=9036e2d8a7416bce7e190896de3c7cbd428d385d5563717bce46b0c7f51f33ea18d3e0f1af1e&scene=21#wechat_redirect)

[Railgun - 一款 GUI 界面的渗透工具](http://mp.weixin.qq.com/s?__biz=MzA4NzU1Mjk4Mw==&mid=2247484499&idx=1&sn=edeae57e8306db1bfdcb72e0b0b655d2&chksm=9036e2eba7416bfdbe6a495b60a89d1a677fc745aa512036072224fc1537d8931276e55f7c90&scene=21#wechat_redirect)

[GoBypass - Golang 免杀生成工具](http://mp.weixin.qq.com/s?__biz=MzA4NzU1Mjk4Mw==&mid=2247484019&idx=1&sn=05133dd5cb31474078eb4ab019f164f3&chksm=9036e4cba7416ddd92c8f9147bb2d283ddedcdfb4d46ed5987d192863008be9bc655025e0697&scene=21#wechat_redirect)

[ByPassBehinder 冰蝎 WebShell 免杀工具](http://mp.weixin.qq.com/s?__biz=MzA4NzU1Mjk4Mw==&mid=2247484096&idx=1&sn=487a1f9daf0090071913aeceeb266d53&chksm=9036e478a7416d6ebced132fe4a03bb1d2584d7fb3eb433612151648743322ff900ae849d572&scene=21#wechat_redirect)

[SweetBabyScan 内网资产探测漏扫工具](http://mp.weixin.qq.com/s?__biz=MzA4NzU1Mjk4Mw==&mid=2247484070&idx=1&sn=eb4cd4f6aac6e0a0ef26a75e4bc2bc7a&chksm=9036e41ea7416d088f70e8593099f750c81b079de1b4b14219276b352a2e83a3eb1d5829c94b&scene=21#wechat_redirect)

[掩日 - 适用于红队的综合免杀工具](http://mp.weixin.qq.com/s?__biz=MzA4NzU1Mjk4Mw==&mid=2247483997&idx=1&sn=1a87fc6bfec2a48dd3dfa5bc2852e8e8&chksm=9036e4e5a7416df3ff7f5b4cf55b4c8c57cde271128de0b9fcdf381a19afb207223deb88fb61&scene=21#wechat_redirect)

[AuxTools 浮鱼渗透辅助工具箱 V1](http://mp.weixin.qq.com/s?__biz=MzA4NzU1Mjk4Mw==&mid=2247483907&idx=1&sn=4e7cf5de0472f6685edb64a598e6aff8&chksm=9036e4bba7416dad5aa253462a84d0c47fdb4e89914c70bd5a3fbbd8b4ef05572a4e7e702faa&scene=21#wechat_redirect).0

[POCbomber 红队快速打点漏洞检测工具](http://mp.weixin.qq.com/s?__biz=MzA4NzU1Mjk4Mw==&mid=2247483790&idx=1&sn=35e3a0fa64cff8d72313fa41ddcbfc3c&chksm=9036e736a7416e20dcd23cfede5c887bfecf5e489234eeb67040bcbbc6326cb42373d226a186&scene=21#wechat_redirect)