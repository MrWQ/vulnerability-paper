> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/1RL9zd0gy8ITCqQCwHVhxA)

本项目其实就是个简单的代理服务器，经过我小小的修改。加了个代理池进来。**渗透、爬虫的时候很容易就会把自己 ip 给 ban 了，所以就需要 ip 代理池了。**  

![](https://mmbiz.qpic.cn/mmbiz_png/3ZX4O1QxGtOKMeFp1hTBxIERWLORqFiamX6vKOjaKUY4vqktLloonZUdZH6rOErFsZqyPibGjrHAQMoefLyNx4NA/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1&random=0.017215196881184447)

**ProxyPool 爬虫代理 IP 池**
=======================

```
git clone git@github.com:jhao104/proxy_pool.git
```

爬虫代理 IP 池项目, 主要功能为定时采集网上发布的免费代理验证入库，定时验证入库的代理保证代理的可用性，提供 API 和 CLI 两种使用方式。同时你也可以扩展代理源以增加代理池 IP 的质量和数量。

*   文档: https://proxy-pool.readthedocs.io/zh/latest/
    
*   支持版本: ![](https://mmbiz.qpic.cn/mmbiz_svg/574VdhMFwaEdw7t9vojsu6peiaFlh3amzBnyw9ibM5E21Tf5NiaQaJTcThRgRdsu794PUeSlk0XcbnEwvRXQHI03hWy1uWXqUc7/640?wx_fmt=svg&wxfrom=5&wx_lazy=1&wx_co=1&random=0.11910178189113196) ![](https://mmbiz.qpic.cn/mmbiz_svg/574VdhMFwaEdw7t9vojsu6peiaFlh3amzhmtWEW1wlXNhCTMicUCPTZ60R7sczYDA933lxyibsxOVT6IroXoHfQSTKOO15KkXEl/640?wx_fmt=svg&wxfrom=5&wx_lazy=1&wx_co=1&random=0.8673711736215051)
    
*   测试地址: http://demo.spiderpy.cn (勿压谢谢)
    
*   付费代理推荐: luminati-china. 国外的亮数据 BrightData（以前叫 luminati）被认为是代理市场领导者，覆盖全球的 7200 万 IP，大部分是真人住宅 IP，成功率扛扛的。付费套餐多种，需要高质量代理 IP 的可以注册后联系中文客服，开通后有 5 美金赠送和教程指引 (PS: 用不明白的同学可以参考这个使用教程)。
    

**运行项目**

##### 下载代码:  

*   git clone
    

```
https://github.com/jhao104/proxy_pool/releases 下载对应zip文件
```

*   releases
    

```
pip install -r requirements.txt
```

##### 安装依赖:  

```
# setting.py 为项目配置文件# 配置API服务HOST = "0.0.0.0"               # IPPORT = 5000                    # 监听端口# 配置数据库DB_CONN = 'redis://:pwd@127.0.0.1:8888/0'# 配置 ProxyFetcherPROXY_FETCHER = [    "freeProxy01",      # 这里是启用的代理抓取方法名，所有fetch方法位于fetcher/proxyFetcher.py
    "freeProxy02",    # ....]
```

##### 更新配置:

```
# 如果已经具备运行条件, 可用通过proxyPool.py启动。# 程序分为: schedule 调度程序 和 server Api服务# 启动调度程序python proxyPool.py schedule# 启动webApi服务python proxyPool.py server
```

#### 启动项目:

```
docker pull jhao104/proxy_pool

docker run --env DB_CONN=redis://:password@ip:port/0 -p 5010:5010 jhao104/proxy_pool:latest
```

### Docker Image  

```
docker-compose up -d
```

### docker-compose

项目目录下运行:

```
import requestsdef get_proxy():    return requests.get("http://127.0.0.1:5010/get/").json()def delete_proxy(proxy):    requests.get("http://127.0.0.1:5010/delete/?proxy={}".format(proxy))# your spider codedef getHtml():    # ....
    retry_count = 5
    proxy = get_proxy().get("proxy")    while retry_count > 0:        try:            html = requests.get('http://www.example.com', proxies={"http": "http://{}".format(proxy)})            # 使用代理访问
            return html
        except Exception:            retry_count -= 1
    # 删除代理池中代理
    delete_proxy(proxy)    return None
```

### **使用**

*   Api
    

启动 web 服务后, 默认配置下会开启 http://127.0.0.1:5010 的 api 接口服务:

![](https://mmbiz.qpic.cn/mmbiz_png/CBJYPapLzSEyqGHAOIbouHOHNWicFqibwGkqWLnh9KBiaORXl14aLnWVwG8ogdmiajXrsORnPXehv3Oc8G2Zolyic1g/640?wx_fmt=png&random=0.9572713624195452)

*   爬虫使用
    

　　如果要在爬虫代码中使用的话， 可以将此 api 封装成函数直接使用，例如：

```
class ProxyFetcher(object):    # ....

    # 自定义代理源获取方法
    @staticmethod
    def freeProxyCustom1():  # 命名不和已有重复即可

        # 通过某网站或者某接口或某数据库获取代理
        # 假设你已经拿到了一个代理列表
        proxies = ["x.x.x.x:3128", "x.x.x.x:80"]        for proxy in proxies:            yield proxy
        # 确保每个proxy都是 host:ip正确的格式返回
```

### **扩展代理**

项目默认包含几个免费的代理获取源，但是免费的毕竟质量有限，所以如果直接运行可能拿到的代理质量不理想。所以，提供了代理获取的扩展方法。

添加一个新的代理源方法如下:

*   1、首先在 ProxyFetcher 类中添加自定义的获取代理的静态方法， 该方法需要以生成器 (yield) 形式返回 host:ip 格式的代理，例如:
    

```
PROXY_FETCHER = [    "freeProxy01",    
    "freeProxy02",    # ....
    "freeProxyCustom1"  #  # 确保名字和你添加方法名字一致]
```

*   2、添加好方法后，修改 setting.py 文件中的 PROXY_FETCHER 项：
    

在`PROXY_FETCHER`下添加自定义方法的名字:

```
https://github.com/jhao104/proxy_pool
```

　　schedule 进程会每隔一段时间抓取一次代理，下次抓取时会自动识别调用你定义的方法。

**免费代理源**

目前实现的采集免费代理网站有 (排名不分先后, 下面仅是对其发布的免费代理情况, 付费代理测评可以参考 https://zhuanlan.zhihu.com/p/33576641):

![](https://mmbiz.qpic.cn/mmbiz_png/CBJYPapLzSEyqGHAOIbouHOHNWicFqibwGuPHSdJDfPw7pHcQiaM3Jr0ZqIld3FGXZ0NfjtEQnuGPImwTiaE25obmQ/640?wx_fmt=png&random=0.20573653264823388)

(具体地址可看项目地址)

**项目地址**

```
https://github.com/jhao104/proxy_pool
```

**免责声明**

由于传播、利用本公众号渗透安全团队所提供的信息而造成的任何直接或者间接的后果及损失，均由使用者本人负责，公众号渗透安全团队及作者不为**此**承担任何责任，一旦造成后果请自行承担！如有侵权烦请告知，我们会立即删除并致歉。谢谢！

**星球的最近主题和星球内部工具一些展示**

![图片](https://mmbiz.qpic.cn/mmbiz_png/pPVXCo8Wd8DoPAeCmmRrq5RapaO9wicnVibg4X6ml8p5fmt8YvW2cWAykN5pkicVA2WUwORtagbJpYrIRqqianUkxw/640?wx_fmt=png)

**![图片](https://mmbiz.qpic.cn/mmbiz_jpg/pPVXCo8Wd8C9OFoaCusYZ0Ds0a8Tq7QBWgwV2j6sZibBnOlYJPNS320vHhjBVWL6T7Fx78MU4Bbcwry8MvAFRUQ/640?wx_fmt=jpeg)**

**![图片](https://mmbiz.qpic.cn/mmbiz_png/pPVXCo8Wd8CzYcn7C4DHT0vibm3SyRASB2Rz5WYRNLKHragHRliaADVFCc97licvVdY0lfRDeIK9MibelOPMiapTT3w/640?wx_fmt=png)**

****![图片](https://mmbiz.qpic.cn/mmbiz_png/pPVXCo8Wd8Ba4tX0KhZpbvicYRO8X29Gn1sZYKrSaSEUtvv1rsxyr1v2qJCQPQkvtH2WBr2z4mibQcfm916Zu7Hw/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)****

****![图片](https://mmbiz.qpic.cn/mmbiz_png/pPVXCo8Wd8Ba4tX0KhZpbvicYRO8X29GnU8O18GsUV7eWF0IuQgGcMzLxuCmeI0dLeplcRE7jVIpBr81ZqwbBDQ/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)****

![图片](https://mmbiz.qpic.cn/mmbiz_png/pPVXCo8Wd8Dzf5nbpPBZhiaTQdVOOtpS19TgwO0FY90QpzFU4p1Jibu9LvJluiadD50PunGzIAUUrfPLSY7AKeypA/640?wx_fmt=png)

![图片](https://mmbiz.qpic.cn/mmbiz_png/pPVXCo8Wd8BtJIB9JTOkH4xyFxk6ZeJsA634wZSpoYOOLWvES4EIO4Vf1138VLPoMAbkJOoOoib4NpyxmO4iba6Q/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

![图片](https://mmbiz.qpic.cn/mmbiz_jpg/pPVXCo8Wd8D6iaWEDOibQjicquKYQZQ2UaauvjgCYtjtzMzzfPbZS2YU2ticI7uaUOcdmQacVG8nDvBCytdErXhEFQ/640?wx_fmt=jpeg)

欢迎加入星球！

![图片](https://mmbiz.qpic.cn/mmbiz_jpg/pPVXCo8Wd8BeJib8edhStt5MNsiakqkhnBcoF7yJb2Rgm5r0QRodWOnn09cH21vicWgIbHsqgCaEYncHlwRUuLOHw/640?wx_fmt=jpeg)

**关 注 有 礼**

  

  

关注下方公众号回复 “666” 可以领取一套精品渗透测试工具集和百度云视频链接。

![图片](https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOeSsicAgIUNHtMib9a69NOWXw1A7mgRqqiat1SycQ0b6e5mBqC0pVJ3oicrQnCTh4gqMGiaKUPicTsUc4Tw/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1) 还在等什么？赶紧点击下方名片关注学习吧！![图片](https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOeSsicAgIUNHtMib9a69NOWXw1A7mgRqqiat1SycQ0b6e5mBqC0pVJ3oicrQnCTh4gqMGiaKUPicTsUc4Tw/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

![图片](https://mmbiz.qpic.cn/mmbiz_png/ndicuTO22p6ibN1yF91ZicoggaJJZX3vQ77Vhx81O5GRyfuQoBRjpaUyLOErsSo8PwNYlT1XzZ6fbwQuXBRKf4j3Q/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)  

**推荐阅读**

[**************群聊 | 技术交流群 - 群除我佬**************](http://mp.weixin.qq.com/s?__biz=MzkxNDAyNTY2NA==&mid=2247489372&idx=1&sn=5e14ba5fa59059fb1ee405e56ef90d40&chksm=c175eaf3f60263e5ef5415a8a9fc134f0890fdb9c25ab956116d17109baf98b3bd6bed572a2d&scene=21#wechat_redirect)

[****干货｜史上最全一句话木马****](http://mp.weixin.qq.com/s?__biz=MzkxNDAyNTY2NA==&mid=2247489259&idx=1&sn=b268701409ad4e8785cd5ebc23176fc8&chksm=c175eb44f60262527120100bd353b3316948928bd7f44cf9b6a49f89d5ffafad88c6f1522226&scene=21#wechat_redirect)

[**干货 | CS 绕过 vultr 特征检测修改算法**](http://mp.weixin.qq.com/s?__biz=MzkxNDAyNTY2NA==&mid=2247486980&idx=1&sn=6d65ae57f03bd32fddb37d7055e5ac8e&chksm=c175f3abf6027abdad06009b2fe964e79f2ca60701ae806b451c18845c656c12b9948670dcbc&scene=21#wechat_redirect)  

[**实战 | 用中国人写的红队服务器搞一次内网穿透练习**](http://mp.weixin.qq.com/s?__biz=MzkxNDAyNTY2NA==&mid=2247488628&idx=1&sn=ff2c617cccc00fe262ed9610c790fe0e&chksm=c175e9dbf60260cd0e67439304c822d28d510f1e332867e78a07d631ab27143309d14e27e53f&scene=21#wechat_redirect)  

[**实战 | 渗透某培训平台经历**](http://mp.weixin.qq.com/s?__biz=MzkxNDAyNTY2NA==&mid=2247488613&idx=1&sn=12884f3d196ac4f5c262a587590d516d&chksm=c175e9caf60260dcc0d5d81a560025d548c61fda975d02237d344fd79adc77ac592e7e562939&scene=21#wechat_redirect)  

[**实战 | 一次曲折的钓鱼溯源反制**](http://mp.weixin.qq.com/s?__biz=MzkxNDAyNTY2NA==&mid=2247489278&idx=1&sn=5347fdbf7bbeb3fd37865e191163763f&chksm=c175eb51f602624777fb84e7928bb4fa45c30f35e27f3d66fc563ed97fa3c16ff06d172b868c&scene=21#wechat_redirect)

好文分享收藏赞一下最美点在看哦