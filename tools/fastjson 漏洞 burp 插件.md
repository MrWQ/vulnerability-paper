> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/VeECyFT3M-YPX4DfQOmjNg)

  

<table width="676"><tbody><tr><td width="557" valign="top" height="62"><section><strong>声明：</strong>该公众号大部分文章来自作者日常学习笔记，也有部分文章是经过作者授权和其他公众号白名单转载，未经授权，严禁转载，如需转载，联系开白。</section><section>请勿利用文章内的相关技术从事非法测试，如因此产生的一切不良后果与文章作者和本<br>公众号无关。</section></td></tr></tbody></table>

**fastjson 漏洞 burp 插件检测 fastjson<1.2.68 基于 dnslog，fastjson<=1.2.24 和 1.2.33<=fatjson<=1.2.47 的不出网检测和 TomcatEcho,SpringEcho 回显方案。**  

#### 用法：

加到 burp 插件就行了，流量经过 burp 就检测。结果在 ISSUES 中看到，如果 fastjson<=1.2.24 和 1.2.33<=fatjson<=1.2.47 的话，自动发送结果到 Repeater 如下图。

#### 注意：

只检测 post，且类型是 application/json

##### 如下图：

检测结果 ISSUES 中看到：

![](https://mmbiz.qpic.cn/mmbiz_png/icdRm5bGXSHcYkm4X1mjS4AFqxWsDafa7PKlOib5z9zXuwScnZElaN2URc9YyRjtQmudAJ1fxY4bibru1AkoAdhDQ/640?wx_fmt=png)

也可以在自定义界面看到![](https://mmbiz.qpic.cn/mmbiz_png/icdRm5bGXSHcYkm4X1mjS4AFqxWsDafa7ayGicfJ205f5aBkKzticURFs0nhLJHSkH9sUa8JibN2EHeX5qYzevShwg/640?wx_fmt=png)

fastjson1.2.47 回显存在的话，自动发到 Repeater 回显结果，添加 Testcmd 头执行命令：

![](https://mmbiz.qpic.cn/mmbiz_png/icdRm5bGXSHcYkm4X1mjS4AFqxWsDafa74qQ2YMvrwT43DvpibpLJla9q1y5YVfaUicF2N78cY0NeDAEl0h1OiavgQ/640?wx_fmt=png)

一键反弹 shell：![](https://mmbiz.qpic.cn/mmbiz_png/icdRm5bGXSHcYkm4X1mjS4AFqxWsDafa71oJvCMT8Cc7VND45B5Ol8e6e891q0KoRxnRaoF3yHsibY0xjhOyzr2w/640?wx_fmt=png)

加入第二种回显方案： 也是自动检测，存在的话会发送到 repeater 中，如图，修改 echo:test 和 Testcmd: 命令：![](https://mmbiz.qpic.cn/mmbiz_png/icdRm5bGXSHcYkm4X1mjS4AFqxWsDafa7j3xn5ZhDjxW2kias3fibRTMWbibeicib6G3ExOqh1XmfU9x7QUaYZOOVDew/640?wx_fmt=png)

第三种回显方案： 自动检测后，发送到 repeater 种，修改 header，加入 Testcmd: 命令![](https://mmbiz.qpic.cn/mmbiz_png/icdRm5bGXSHcYkm4X1mjS4AFqxWsDafa7MmQyCfAtG6iajybnyVvcFgvMoM6SWSJoQkaYV0e3ghPDTWmvIib3LVOA/640?wx_fmt=png)

#### 实现文件上传功能，可上传文件如下图所示，内存马没弄出来，所以是灰色的。由于 javassist 限制，文件上传大小不能超过 64kB，后面再研究限制，除了上传 webshell，也可以上传其他任意文件（不存在回显链的无法上传），点击 url，右键，弹出文件上传界面：

![](https://mmbiz.qpic.cn/mmbiz_png/icdRm5bGXSHcYkm4X1mjS4AFqxWsDafa7Ap7P67w9iau4BbcDuciaYvQefVIGxpbPbBZXV6geiavXqMs1iahcWqcq9g/640?wx_fmt=png)

#### 实现右键菜单一键 send to FastScan 扫描，只扫描 post 且类型为 application/json 的：

![](https://mmbiz.qpic.cn/mmbiz_png/icdRm5bGXSHcYkm4X1mjS4AFqxWsDafa7SEzuoibibiayHc23no98NWfoNWeUfwxC2m32kq0G9A8JeSysfKRia2oeNg/640?wx_fmt=png)

**项目地址：https://github.com/zilong3033/fastjsonScan**

**扫码加管理微信进交流群**  

![](https://mmbiz.qpic.cn/mmbiz_jpg/icdRm5bGXSHeN6m5P97SK2S59DnAicY9JaibaMibeL4xibPBngg5NeOwFHHjQLeIUL0kWxSrSicKJ5vRT8D0bH1XyY4A/640?wx_fmt=jpeg)

# **往期推荐**  

[JScanner 一款递归式网站路径检测工具](http://mp.weixin.qq.com/s?__biz=MzU3MDU5ODg1Ng==&mid=2247485678&idx=1&sn=a97036ac2105139f541631a20994d949&chksm=fcedbc49cb9a355facfc5a224da7dd4f3461e3859fb63b2f63fddeb762e04bb3d10346ac60c6&scene=21#wechat_redirect)  

[一款 API 水平越权漏洞检测工具](http://mp.weixin.qq.com/s?__biz=MzU3MDU5ODg1Ng==&mid=2247485665&idx=1&sn=5acd4be7b7a219096a77e6e78b74ea33&chksm=fcedbc46cb9a3550f0eed61d52dee97eb82f48a11f05035c63e75c191c729bd867b65877b35e&scene=21#wechat_redirect)  

[内网横向移动工具箱](http://mp.weixin.qq.com/s?__biz=MzU3MDU5ODg1Ng==&mid=2247485655&idx=1&sn=289e07fa4c52f38cae2de496c9013d01&chksm=fcedbc70cb9a3566ec67cb0924ee66bcfb3fc071fe26324b9cede120839cd828e9cd3d9fce81&scene=21#wechat_redirect)  

[毒液爬行器：专为捡洞而生的爬虫神器](http://mp.weixin.qq.com/s?__biz=MzU3MDU5ODg1Ng==&mid=2247485536&idx=1&sn=5dd6e4d69755b76bce9990a6ebfadf81&chksm=fcedbcc7cb9a35d1300ef71abe4f12bd5218c36a7af7b7d04c471d7ba5cb15a1a776fdaeccbc&scene=21#wechat_redirect)  

[团队小老弟的内网打靶记录 - 2](http://mp.weixin.qq.com/s?__biz=MzU3MDU5ODg1Ng==&mid=2247485507&idx=1&sn=dad352d9bed825782015ae93a6b90d0d&chksm=fcedbce4cb9a35f2c9cb567af29acf7a3871e993ac23b8ce80c687f259bd04343f6e2a7c0f40&scene=21#wechat_redirect)  

[团队小老弟的内网打靶记录 - 1](http://mp.weixin.qq.com/s?__biz=MzU3MDU5ODg1Ng==&mid=2247485466&idx=1&sn=4ba6125df5043378d547f25e6c73214d&chksm=fcedbcbdcb9a35ab057e63add0d2e3445301251b6ee5959b73a4201d51094e9833428a598c62&scene=21#wechat_redirect)  

[云环境利用框架（Cloud exploitation framework）主要用来方便红队人员在获得 AK 的后续工作。](http://mp.weixin.qq.com/s?__biz=MzU3MDU5ODg1Ng==&mid=2247485420&idx=1&sn=8709f99456c4324d82b8b6daa4398d17&chksm=fcedb34bcb9a3a5d2c52e5ad264ea2fa65e74b17033524845f600cfcdda5c42dd5d7010f1db2&scene=21#wechat_redirect)  

[《FanZhi - 攻击与反制的艺术》](http://mp.weixin.qq.com/s?__biz=MzU3MDU5ODg1Ng==&mid=2247485391&idx=1&sn=8bf98d4411325f1c523840df9dd5679a&chksm=fcedb368cb9a3a7e4b12f3b72f951e734e2f617613ae167cd8c7f8624efc8a6ed9c92dc07890&scene=21#wechat_redirect)  

[一个集成的 BurpSuite 漏洞探测插件](http://mp.weixin.qq.com/s?__biz=MzU3MDU5ODg1Ng==&mid=2247485378&idx=1&sn=9954d338d1f280450883d3847e370417&chksm=fcedb365cb9a3a73f31a0af77261f2026761d1905f1732e5432cbcb990eed2f1e2ac5e2d75ed&scene=21#wechat_redirect)  

[一款基于 go 写的端口扫描工具，集 masscan+nmap+wappalyzer + 证书于一体](http://mp.weixin.qq.com/s?__biz=MzU3MDU5ODg1Ng==&mid=2247485333&idx=1&sn=bcc48b2d9eb8e5a884b6d12f1c1d6318&chksm=fcedb332cb9a3a24426c9d35016c9b82c6fe4a841aab40d142d39319ff3da44874c259c4a632&scene=21#wechat_redirect)  

[Thinkphp 图形化漏洞利用工具](http://mp.weixin.qq.com/s?__biz=MzU3MDU5ODg1Ng==&mid=2247485329&idx=1&sn=56658b8074e9d372b6584605f051c68e&chksm=fcedb336cb9a3a2051bd42059d787ab9bcd89d1e3ff3886f350349b80e6ac8d6acce9df93c54&scene=21#wechat_redirect)  

[icp 备案查询工具](http://mp.weixin.qq.com/s?__biz=MzU3MDU5ODg1Ng==&mid=2247485311&idx=1&sn=3c1a4d56dc7e5335b7b5eb976f2ab1ef&chksm=fcedb3d8cb9a3acefe1b0a5c08d6870d58b9384417712dbb0cf056b1f850aab31ba206507d76&scene=21#wechat_redirect)  

[一款信息泄漏利用工具，适用于. git/.svn/.DS_Store 泄漏和目录列出](http://mp.weixin.qq.com/s?__biz=MzU3MDU5ODg1Ng==&mid=2247485301&idx=1&sn=50a6827b51cbae37a1a0ac22a7e73d70&chksm=fcedb3d2cb9a3ac40daab70d8e4731f698fa56a91cdf69fe30decc32bfb12fe9c00272fa881d&scene=21#wechat_redirect)  

[Hunter 资产测绘平台的图形化工具](http://mp.weixin.qq.com/s?__biz=MzU3MDU5ODg1Ng==&mid=2247485294&idx=1&sn=a53bfc26a2ba7cd6bdce990a1cf273dc&chksm=fcedb3c9cb9a3adf84fcc1386be41bba99113b63cea7a9857f948a0df9706f340321df713256&scene=21#wechat_redirect)  

[(签名掠夺者)：一款数字签名复制器，可将其他官方 exe 中数字签名复制到没有签名的 exe 中。](http://mp.weixin.qq.com/s?__biz=MzU3MDU5ODg1Ng==&mid=2247485287&idx=1&sn=bf32829d73643da48ef429aaeae5ab4b&chksm=fcedb3c0cb9a3ad66190523a7c2b95382b5e0bb984588dcde39865aefab06a7eeefc2d6a5999&scene=21#wechat_redirect)  

[JsProxy: 所到之处皆为代理节点](http://mp.weixin.qq.com/s?__biz=MzU3MDU5ODg1Ng==&mid=2247485282&idx=1&sn=77bd9449515209aed83a22ed968af38b&chksm=fcedb3c5cb9a3ad38978a4ce1494ca93627fa738e61d6735c4cd0798dd8e1583cee989da8238&scene=21#wechat_redirect)  

[WebSocket 内存马 / Webshell，一种新型内存马 / WebShell 技术](http://mp.weixin.qq.com/s?__biz=MzU3MDU5ODg1Ng==&mid=2247485218&idx=1&sn=253e80ffe166a1d6f2d49e4ce3a3d9aa&chksm=fcedb385cb9a3a93f2af164a433ea7450fbc42de90b1e155ed6002083def4686410395dc4d53&scene=21#wechat_redirect)  

[Chunsou（春蒐），Web 指纹资产识别，风险收敛以及企业互联网资产风险摸查识别工具](http://mp.weixin.qq.com/s?__biz=MzU3MDU5ODg1Ng==&mid=2247485204&idx=1&sn=6fb5b82803fe00de48be2400a9246149&chksm=fcedb3b3cb9a3aa5208f0e8c45a260cc482fb73ff40afa45f745a7eb45a389a48792e8c0518c&scene=21#wechat_redirect)  

[Nacos Hessian 反序列化漏洞利用工具](http://mp.weixin.qq.com/s?__biz=MzU3MDU5ODg1Ng==&mid=2247485190&idx=1&sn=c53db63cfaf46560d3369806321bc275&chksm=fcedb3a1cb9a3ab754c81a351965d1551b591ec5626af76aa5673d2400a9171729de39f80e9e&scene=21#wechat_redirect)  

[myscan 集成多个框架的漏洞扫描工具](http://mp.weixin.qq.com/s?__biz=MzU3MDU5ODg1Ng==&mid=2247485181&idx=1&sn=2f91540e572397e15627cddb2ba24c4d&chksm=fcedb25acb9a3b4c2f7ee781fbca46ee1385afe194581f801c8721c72911a51211ac7779d173&scene=21#wechat_redirect)  

[Burp 的 JS API 接口过滤插件](http://mp.weixin.qq.com/s?__biz=MzU3MDU5ODg1Ng==&mid=2247485160&idx=1&sn=55fb551de62132f0aacaff2821b24eb2&chksm=fcedb24fcb9a3b59e8bebafb9189e912a5e844c4c176df200e4cd4459510a7f8580a8f8aaac5&scene=21#wechat_redirect)  

[通达 OA 检测工具](http://mp.weixin.qq.com/s?__biz=MzU3MDU5ODg1Ng==&mid=2247485131&idx=1&sn=bccb90bc296d87908f073ac8f6c317a0&chksm=fcedb26ccb9a3b7aeeb7c6beec9ba5fe7af4168ff731dfe1429c2daaebe3425d888b7da1eb80&scene=21#wechat_redirect)  

[从零学习 Webshell 免杀手册](http://mp.weixin.qq.com/s?__biz=MzU3MDU5ODg1Ng==&mid=2247485091&idx=1&sn=591916b62674003afd2f57bba780cef5&chksm=fcedb204cb9a3b1209e510ed72ad42984a6ef5b62736164bd5474ff28d81b99ae9f9368ad0e2&scene=21#wechat_redirect)  

[爬网站 JS 文件，自动 fuzz api 接口，指定 api 接口](http://mp.weixin.qq.com/s?__biz=MzU3MDU5ODg1Ng==&mid=2247485069&idx=1&sn=e94bad6d0f927441b7cb5c533d2e369d&chksm=fcedb22acb9a3b3cfb57e9d40f8898c51fa4c9fa3562bd112b5d489f9cba5cf81637d1558b53&scene=21#wechat_redirect)  

[生成各类免杀 webshell 适合市面上常见的几种 webshell 管理工具、冰蝎、蚁剑、哥斯拉](http://mp.weixin.qq.com/s?__biz=MzU3MDU5ODg1Ng==&mid=2247485058&idx=1&sn=ac47be9a9d0c6aba0ec991e5213a903e&chksm=fcedb225cb9a3b3312a895ec7da3819216fde632546b644f943a6b31c3b6efa6db3624f6edf7&scene=21#wechat_redirect)  

[一款新的 webshell 管理工具](http://mp.weixin.qq.com/s?__biz=MzU3MDU5ODg1Ng==&mid=2247485049&idx=1&sn=e02753cc60ea620882710bf9cf7b23b0&chksm=fcedb2decb9a3bc82b6dc1d9da9bc9c112ceedf608732c8d3338b04c4ffa5b44ebe28355272c&scene=21#wechat_redirect)  

[浏览器插件 -- 右键检测图片是否存在 Exif 漏洞](http://mp.weixin.qq.com/s?__biz=MzU3MDU5ODg1Ng==&mid=2247485033&idx=1&sn=184c7486a3fb0f06b27885e881146561&chksm=fcedb2cecb9a3bd82564162a5a013261acad3b244ba67af527b211175701b5ebc617f731fafe&scene=21#wechat_redirect)  

[一个自动化通用爬虫 用于自动化获取网站的 URL](http://mp.weixin.qq.com/s?__biz=MzU3MDU5ODg1Ng==&mid=2247485003&idx=1&sn=914d8bcd37af1e43ea293b20a6b7976e&chksm=fcedb2eccb9a3bfa7174dfba94b4b85570ab818f875acbcef26163c173ae7c67c4c153f6d191&scene=21#wechat_redirect)  

[一个查询 IP 地理信息和 CDN 服务提供商的离线终端工具](http://mp.weixin.qq.com/s?__biz=MzU3MDU5ODg1Ng==&mid=2247484994&idx=1&sn=55a0986b58d7bff15e8f55fd4b495204&chksm=fcedb2e5cb9a3bf3bc6d55f4e292fa43b4cb563012593b0f7832c040e0616f2aac53975dc31b&scene=21#wechat_redirect)  

[红队批量脆弱点搜集工具](http://mp.weixin.qq.com/s?__biz=MzU3MDU5ODg1Ng==&mid=2247484965&idx=1&sn=70e48cdcb7683b227bc3f8d8efd05a6a&chksm=fcedb282cb9a3b942c93edec939bf9943a66d7345c40916e3c17a369ace2d0a9eed83ccf5ae8&scene=21#wechat_redirect)  

[Spring 漏洞综合利用工具——Spring_All_Reachable](http://mp.weixin.qq.com/s?__biz=MzU3MDU5ODg1Ng==&mid=2247484989&idx=1&sn=bfa97e5279e921e26631b9f93a75eefe&chksm=fcedb29acb9a3b8c178d47f04eaee53aabeb8e27b2c06e12d7f8a0916ea288b2a7ad94f4da3e&scene=21#wechat_redirect)  

[利用字符集编码绕过 waf 的 burpsuite 插件](http://mp.weixin.qq.com/s?__biz=MzU3MDU5ODg1Ng==&mid=2247484894&idx=1&sn=33cec3b0baa230be290d7c62935d0dd5&chksm=fcedb179cb9a386f103c044a2fcb481e31efc4358c808b38c7d4cd961ec99cbd72ac80175b8a&scene=21#wechat_redirect)  

[云安全 - AK/SK 泄露利用工具](http://mp.weixin.qq.com/s?__biz=MzU3MDU5ODg1Ng==&mid=2247484850&idx=1&sn=785ebf6284c536262a08a6713cbcac8a&chksm=fcedb115cb9a38030cfe0024ecd722b3269d6eeddcd0845433f73ab68660ed776019b7a1f649&scene=21#wechat_redirect)  

[可以自定义规则的密码字典生成器](http://mp.weixin.qq.com/s?__biz=MzU3MDU5ODg1Ng==&mid=2247484816&idx=1&sn=80a19335226b0e242a36a85486c541fc&chksm=fcedb137cb9a382100c0fbb51875de2a1183f46acccced953d4ee927c3f627d8d8e4a3f660d4&scene=21#wechat_redirect)  

[MySql、Oracle、金仓、达梦、神通等数据库、Redis 等管理工具](http://mp.weixin.qq.com/s?__biz=MzU3MDU5ODg1Ng==&mid=2247484787&idx=1&sn=766263e71666745fca6a1fe71b016170&chksm=fcedb1d4cb9a38c2cccc8c58afb34b31677974540d45ad9db5f032c0eba6c7ff26527c0dbd2c&scene=21#wechat_redirect)  

[JNDI/LDAP 注入利用工具](http://mp.weixin.qq.com/s?__biz=MzU3MDU5ODg1Ng==&mid=2247484743&idx=1&sn=42224dd27e62cb0d7a5cbdebf4dbbf19&chksm=fcedb1e0cb9a38f6b091c5a753c80b411bb92197ea02439a0493886ad55b7203fed057ec7718&scene=21#wechat_redirect)  

[jmx 未授权访问 弱口令批量检测 GUI 工具 - jmxbfGUI](http://mp.weixin.qq.com/s?__biz=MzU3MDU5ODg1Ng==&mid=2247484738&idx=1&sn=3d7cf4b2ec5bc5a92de3db9c57fe036e&chksm=fcedb1e5cb9a38f3e8d8fce41bfd4ac22d001c075bfe2f1425f1a90643ede8b93bce377fa787&scene=21#wechat_redirect)