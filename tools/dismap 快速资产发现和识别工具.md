> æœ¬æ–‡ç”± [ç®€æ‚¦ SimpRead](http://ksria.com/simpread/) è½¬ç ï¼Œ åŸæ–‡åœ°å€ [mp.weixin.qq.com](https://mp.weixin.qq.com/s/Q3rOeXmQLyszLHL3zJ8S2g)

**About dismap**

Dismap å®šä½æ˜¯ä¸€ä¸ªé€‚ç”¨äºå†…å¤–ç½‘çš„èµ„äº§å‘ç°å’Œè¯†åˆ«å·¥å…·ï¼›å…¶ç‰¹è‰²åŠŸèƒ½åœ¨äºå¿«é€Ÿè¯†åˆ« Web æŒ‡çº¹ä¿¡æ¯ï¼Œå®šä½èµ„äº§ç±»å‹ã€‚è¾…åŠ©çº¢é˜Ÿå¿«é€Ÿå®šä½ç›®æ ‡èµ„äº§ä¿¡æ¯ï¼Œè¾…åŠ©è“é˜Ÿå‘ç°ç–‘ä¼¼è„†å¼±ç‚¹ã€‚  

Dismap æ‹¥æœ‰å®Œå–„çš„æŒ‡çº¹è§„åˆ™åº“ï¼Œå¯è½»æ¾è‡ªå®šä¹‰æ–°è¯†åˆ«è§„åˆ™ã€‚

è¯†åˆ«ç»“æœå¯ç›´æ¥ä¸¢ç»™ Vulmap(>=0.8)Â è¿›è¡Œæ¼æ´æ‰«æå®ç°ç®€æ˜“è”åŠ¨ã€‚

é¡¹ç›®åœ°å€ï¼š

https://github.com/zhzyker/dismap

å·¥å…·æœ€åˆå®šä½ä¸ºå†…ç½‘å·¥å…·ï¼Œè‡ªæˆ‘æ„Ÿè§¦åœ¨å¤§å‹æ”»é˜²æ´»åŠ¨ä¸­ï¼Œç»å¸¸ç”±äºç²¾åŠ›æœ‰é™ç•¥è¿‡å†…ç½‘ç½‘ç«™ï¼Œè€Œé å†…ç½‘æ•°æ®åº“ã€å¼±å£ä»¤ã€FTPã€SMB ä¹‹ç±»çš„ç›®æ ‡æ¥åˆ·åˆ†ï¼Œä½†å¤šæ•°å†…ç½‘å¾€å¾€åˆ†æ•°è¾¾ä¸åˆ°è‡ªå·±é¢„æœŸï¼Œæ•…æ€ç†è®ºä¸Šå†…ç½‘ç½‘ç«™è„†å¼±æ€§è‚¯å®šæ¯”å¤–ç½‘é«˜ï¼Œå®é™…ä¸Šç¡®ä¸æ€ä¹ˆæ‰“ï¼Œè¿˜æ˜¯å†…ç½‘ç²¾åŠ›åˆ†é…çš„å·®å¼‚ï¼Œåˆæ€æä¸€ä¸ªå¿«é€Ÿè¯†åˆ«ç½‘æ®µï¼ˆå†…ç½‘ï¼‰æ‰€æœ‰ Web èµ„äº§ç±»å‹å‡ºæ¥çš„å·¥å…·ï¼Œå²‚ä¸å°±èƒ½é’ˆå¯¹æ€§é€®å¥½æ‰“çš„æ‹¿åˆ†äº†~

åç»­å› æµ‹è¯•éœ€æ±‚ç»å¸¸åœ¨äº’è”ç½‘ï¼ˆå¤–ç½‘ï¼‰ä¸­æ‰«æè¯†åˆ«æµ‹è¯•ï¼ŒæƒŠå¥‡çš„å‘ç°è¿™ç©æ„æ‰«æ•´ä¸ªå¤–ç½‘ç½‘æ®µæ—¶æ•ˆæœè¿œè¿œé«˜äºè‡ªå·±é¢„æœŸï¼Œå¾€å¾€ä¸€ä¸ª C æ®µ 200 å·¦å³ä¸ªå­˜æ´» IP å‡ ä¸ª Tomcatã€å¤šå°‘ Shiroã€ä¸€å † Springã€ä¸€äº› Struts2 çš„ç½‘ç«™æ¸…æ¸…æ¥šæ¥šæ‘†åœ¨çœ¼å‰ï¼Œå¶å°”åœ¨è¹¦å‡ºæ¥ä¸€å †å…¶ä»– Web åº”ç”¨ï¼Œç®€ç›´ä¸è¦å¤ªå¿«ä¹ã€‚

  
æˆæƒé—®é¢˜ä»…è´´è‡ªå·±æ­å»ºç¯å¢ƒçš„æ•ˆæœå›¾ï¼š  

![](https://mmbiz.qpic.cn/mmbiz_png/An1f3uZYamLz8EaH0iaaib6bntCkMdBGxzdK3Y6pSsNoChhXVBjsVomHR7xNicicibNoewut2OhcGTEIJOYWE3s44ug/640?wx_fmt=png)

**Get &Â Run**

ä¸‹è½½é“¾æ¥ï¼š

https://github.com/zhzyker/dismap/releases

é»˜è®¤ç¼–è¯‘äº†ä»¥ä¸‹æ”¯æŒçš„ç³»ç»Ÿç±»å‹ï¼š

dismap-darwin-amd64Â Â 6.66 MB

dismap-darwin-arm64Â Â 6.48 MB

dismap-linux-amd64Â Â 6.78 MB

dismap-linux-x86Â Â 6.02 MB

dismap-windows-amd64.exeÂ Â 6.77 MB

dismap-windows-x86.exeÂ Â 6.07 MB

```
# Linux and MacOS
zhzyker@debian:~$ chmod +x dismap
zhzyker@debian:~$Â ./dismapÂ -h
# Windows
C:\Users\zhzyker\Desktop>Â dismap.exeÂ -h
```

```
-file string
    Select a URL file for batch identification
    # ä»æ–‡ä»¶ä¸­è¯»å– Url è¿›è¡Œæ‰¹é‡è¯†åˆ«
-ip string
    Network segment [e.g. -ip 192.168.1.0/24 or -ip 192.168.1.1-10]
    # æŒ‡å®šä¸€ä¸ªç½‘æ®µ,æ ¼å¼ç¤ºä¾‹: 192.168.1.1/24  192.168.1.1-100  192.168.1.1-192.168.1.254
-np
    Not use ICMP/PING to detect surviving hosts
    # ä¸è¿›è¡Œä¸»æœºå­˜æ´»æ£€æµ‹,è·³è¿‡å­˜æ´»æ£€æµ‹ç›´æ¥è¯†åˆ« Url
-output string
    Save the scan results to the specified file (default "output.txt")
    # è‡ªå®šä¹‰è¯†åˆ«ç»“æœè¾“å‡ºæ–‡ä»¶,é»˜è®¤è¿½åŠ åˆ° output.txt ä¸­
-port string
    Custom scan ports [e.g. -port 80,443 or -port 1-65535]
    # è‡ªå®šä¹‰éœ€è¦æ‰«æçš„ Web ç«¯å£,é»˜è®¤ç«¯å£åœ¨ /config/config.go ä¸­
-thread int
    Number of concurrent threads, (adapted to two network segments 2x254) (default 508)
    # å¤šçº¿ç¨‹æ•°é‡,é»˜è®¤508(ä¸¤ä¸ªCæ®µçš„æ•°é‡),çº¿ç¨‹è¶Šé«˜å­˜æ´»å’Œè¯†åˆ«ä¸¢å¤±ç‡å¯èƒ½è¶Šé«˜,ä¸å»ºè®®è¶…è¿‡2000
-timeout int
    Response timeout time, the default is 5 seconds (default 5)
    # ä¸»æœºå­˜æ´»æ¢æµ‹å’Œ Http è¶…æ—¶æ—¶é—´,é»˜è®¤å‡ä¸º5ç§’
-url string
    Specify a target URL [e.g. -url https://example.com]
    # è¯†åˆ«å•ä¸ª Url æ—¶ç”¨è¯¥é€‰é¡¹æŒ‡å®š
```

```
Rule:
  Name: name /* å®šä¹‰è§„åˆ™åç§° */
Â Â Type:Â header|body|icoÂ Â /*Â æ”¯æŒè¯†åˆ«çš„ç±»å‹,Â headerã€bodyã€icoÂ ä»»æ„ç»„åˆ,Â icoÂ ä¸ºå•ç‹¬è¯·æ±‚Â favicon.icoÂ å¹¶è®¡ç®—Â MD5*/
Â Â Mode:Â and|orÂ /*Â ç±»å‹çš„åˆ¤æ–­é€»è¾‘å…³ç³»Â */
  Rule
    InBody: str  /* éœ€è¦æŒ‡å®šå“åº” Body ä¸­å­˜åœ¨ str åˆ™å‘½ä¸­ */
    InHeader: str  /* éœ€è¦æŒ‡å®šå“åº” Hedaer ä¸­å­˜åœ¨ str åˆ™å‘½ä¸­ */
    InIcoMd5: str_md5  /* favicon.ico çš„ MD5 å€¼ */
  Http:
    ReqMethod: GET|POST  /* è‡ªå®šä¹‰è¯·æ±‚æ–¹æ³•,ç›®å‰æ”¯æŒ GET å’Œ POST */
    ReqPath: str  /* è‡ªå®šä¹‰è¯·æ±‚ Web è·¯å¾„ */
    ReqHeader: []str  /* è‡ªå®šä¹‰ Http è¯·æ±‚çš„ Header */
    ReqBody: str  /* è‡ªå®šä¹‰ POST è¯·æ±‚æ—¶çš„ Body */
```

**Optons**

åŠŸèƒ½å’Œå‚æ•°ä½¿ç”¨è§£è¯»è§†é¢‘ï¼ˆBilibiliï¼‰:

https://www.bilibili.com/video/BV13L411b79E

å¸¸è§„å‚æ•°ï¼š

```
# å³åœ¨å“åº”Bodyä¸­æ£€æŸ¥æ˜¯å¦å­˜åœ¨å­—ç¬¦<flink-root></flink-root>
{"Apahce Flink", "body", "", InStr{"(<flink-root></flink-root>)", "", ""}, ReqHttp{"", "", nil, ""}},

#Â è‡ªå®šä¹‰è¯·æ±‚è®¿é—®/myportal/control/main,åˆ¤æ–­è‡ªå®šä¹‰è¯·æ±‚çš„ç»“æœä¸­æ˜¯å¦å­˜åœ¨æŒ‡å®šçš„ header å­—ç¬¦å’Œ body å­—ç¬¦ã€‚å¯ä»¥å‘ç°å‡æ”¯æŒæ­£åˆ™è¡¨è¾¾å¼
{"ApacheÂ OFBiz",Â "body|header",Â "or",Â InStr{"(ApacheÂ OFBiz|apache.ofbiz)",Â "(Set-Cookie:Â OFBiz.Visitor=(.*))",Â ""},Â ReqHttp{"GET",Â "/myportal/control/main",Â nil,Â ""}},
```

**RuleLab**

è§„åˆ™åº“å¤§è‡´æ ¼å¼ï¼š  

```
######          dismap 0.1 output file          ######
###### asset discovery and identification tools ######
######   by:https://github.com/zhzyker/dismap   ######
[+] [200] [Apache Struts2] { http://192.168.43.134:8080/struts2-showcase-2.3.12/showcase.action } [Struts2 Showcase]
[+] [404] [Weblogic] { http://192.168.43.134:7001 } [None]
[-] [404] { http://192.168.43.134:8080/fast/ } [HTTP Status 404 â€“ Not Found]
[+] [200] [Apache Tomcat] { http://192.168.43.134:8080 } [Apache Tomcat/8.5.56]
[+]Â [200]Â [ApacheÂ Shiro]Â {Â http://192.168.43.134:8080/samples-web-1.2.4/login.jspÂ }Â [None]
```

ç®€å•ç¤ºä¾‹ï¼š

```
# å³åœ¨å“åº”Bodyä¸­æ£€æŸ¥æ˜¯å¦å­˜åœ¨å­—ç¬¦<flink-root></flink-root>
{"Apahce Flink", "body", "", InStr{"(<flink-root></flink-root>)", "", ""}, ReqHttp{"", "", nil, ""}},
#Â è‡ªå®šä¹‰è¯·æ±‚è®¿é—®/myportal/control/main,åˆ¤æ–­è‡ªå®šä¹‰è¯·æ±‚çš„ç»“æœä¸­æ˜¯å¦å­˜åœ¨æŒ‡å®šçš„ header å­—ç¬¦å’Œ body å­—ç¬¦ã€‚å¯ä»¥å‘ç°å‡æ”¯æŒæ­£åˆ™è¡¨è¾¾å¼
{"ApacheÂ OFBiz",Â "body|header",Â "or",Â InStr{"(ApacheÂ OFBiz|apache.ofbiz)",Â "(Set-Cookie:Â OFBiz.Visitor=(.*))",Â ""},Â ReqHttp{"GET",Â "/myportal/control/main",Â nil,Â ""}},
```

å¯¹äºè§„åˆ™åº“çš„è¯¦ç»†è¯´æ˜è§ Github  

**Linkage**

ç›®å‰å¼€æºçš„ä¸¤æ¬¾å·¥å…· (dismap v0.1 and vulmap>=0.8 ) å¯è¿›è¡Œç®€æ˜“è”åŠ¨ä½¿ç”¨ï¼Œå³æŠŠè¯†åˆ«ç»“æœç›´æ¥ä¸¢ç»™æ¼æ´æ‰«æã€‚  

Dismap é»˜è®¤ä¼šå°†æ‰«æç»“æœè¿½åŠ ä¿å­˜åˆ° output.txt ï¼Œå¤§è‡´è¿™ä¸ªæ ·å­ï¼š

```
######          dismap 0.1 output file          ######
###### asset discovery and identification tools ######
######   by:https://github.com/zhzyker/dismap   ######
[+] [200] [Apache Struts2] { http://192.168.43.134:8080/struts2-showcase-2.3.12/showcase.action } [Struts2 Showcase]
[+] [404] [Weblogic] { http://192.168.43.134:7001 } [None]
[-] [404] { http://192.168.43.134:8080/fast/ } [HTTP Status 404 â€“ Not Found]
[+] [200] [Apache Tomcat] { http://192.168.43.134:8080 } [Apache Tomcat/8.5.56]
[+]Â [200]Â [ApacheÂ Shiro]Â {Â http://192.168.43.134:8080/samples-web-1.2.4/login.jspÂ }Â [None]
```

Vulmap å¯ä»¥ç›´æ¥ç”¨ -f é€‰é¡¹æŒ‡å®šè¯¥æ–‡ä»¶ï¼š  

![](https://mmbiz.qpic.cn/mmbiz_png/An1f3uZYamLz8EaH0iaaib6bntCkMdBGxzTl8HlW2X1hM1o6icdG8bl1DU0hkpumlRK6RiaWPUA6xftDiambUue2ACg/640?wx_fmt=png)

ä¸äº¦ä¹ä¹~![](https://mmbiz.qpic.cn/mmbiz_jpg/An1f3uZYamLz8EaH0iaaib6bntCkMdBGxzGYnQxtlEm1UR8AmCH1BeLCUE3tn1M52nubdUU6PXT8Hw051J2rGgUA/640?wx_fmt=jpeg) å¥½ç”¨è®°å¾— StarÂ ğŸŒŸ