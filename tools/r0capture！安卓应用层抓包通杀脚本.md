> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/lCtr6ZZZaiHNodZxxnrLMQ)

**文章转自公众号：Hack 分享吧**

**工具简介**

```
仅限安卓平台，测试安卓7、8、9、10、11、12、13 可用 ；
无视所有证书校验或绑定，不用考虑任何证书的事情；
通杀TCP/IP四层模型中的应用层中的全部协议；
通杀协议包括：Http,WebSocket,Ftp,Xmpp,Imap,Smtp,Protobuf等等、以及它们的SSL版本；
通杀所有应用层框架，包括HttpUrlConnection、Okhttp1/3/4、Retrofit/Volley等等；
无视加固，不管是整体壳还是二代壳或VMP，不用考虑加固的事情；
如果有抓不到的情况欢迎提issue，或者直接加vx：r0ysue，进行反馈~

```

**2023 年 6 月 18 日更新：**  

```
测试Pixel4/安卓13/KernelSU/Frida16 功能工作正常 正常抓包 导出证书

```

**2021 年 1 月 14 日更新：**

```
增加App收发包函数定位功能
增加App客户端证书导出功能
新增host连接方式“-H”，用于Frida-server监听在非标准端口时的连接

```

**工具用法**

**推荐环境：**

```
https://github.com/r0ysue/AndroidSecurityStudy/blob/master/FRIDA/A01/README.md

```

切记仅限安卓平台 7、8、9、10、11 可用 ，禁止使用模拟器。  

**Spawn 模式：**

```
python3 r0capture.py -U -f com.coolapk.market -v

```

**Attach 模式，抓包内容保存成 pcap 文件供后续分析：**

```
python3 r0capture.py -U 酷安 -v -p iqiyi.pcap

```

建议使用 Attach 模式，从感兴趣的地方开始抓包，并且保存成 pcap 文件，供后续使用 Wireshark 进行分析。  

> 老版本 Frida 使用包名，新版本 Frida 使用 APP 名。APP 名必须是点开 app 后，frida-ps -U 显示的那个 app 名字。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/79gZQNibQ6ufLucqxibDaFicjJFiaBWlTZ7Fk6ianzQJDJTW7UHqbQKXNL8fVDP2H8Tgy9iaLaQyaIcp8fVZSZX2JjyQ/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

收发包函数定位：Spawn 和 attach 模式均默认开启；

> 可以使用 python r0capture.py -U -f cn.soulapp.android -v  >> soul3.txt 这样的命令将输出重定向至 txt 文件中稍后过滤内容

![](https://mmbiz.qpic.cn/sz_mmbiz_png/79gZQNibQ6ufLucqxibDaFicjJFiaBWlTZ7FsGWjzWrVsw6BKZJiauVxTdFia1qOVU2I6icOEAf9MQldqgbHUbUHSJV8g/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

客户端证书导出功能：默认开启；必须以 Spawm 模式运行；

*   运行脚本之前必须手动给 App 加上存储卡读写权限；
    
*   并不是所有 App 都部署了服务器验证客户端的机制，只有配置了的才会在 Apk 中包含客户端证书  
    
*   导出后的证书位于 / sdcard/Download / 包名 xxx.p12 路径，导出多次，每一份均可用，密码默认为：r0ysue，推荐使用 keystore-explorer 打开查看证书。  
    

![](https://mmbiz.qpic.cn/sz_mmbiz_png/79gZQNibQ6ufLucqxibDaFicjJFiaBWlTZ7FGbm1Cu2euBHSrD5iaYSRVlUCFJFsFq5aClDeRKpwdGfblU8ibH5NAJYw/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

新增 host 连接方式 “-H”，用于 Frida-server 监听在非标准端口时的连接。有些 App 会检测 Frida 标准端口，因此 frida-server 开在非标准端口可以绕过检测。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/79gZQNibQ6ufLucqxibDaFicjJFiaBWlTZ7FSYNoQQPuRlX96L7GubicYbVgZqdP3PnS3IGhD6eicicqcz0y9a2JrflYA/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

**原创稿件征集**

征集原创技术文章中，欢迎投递

投稿邮箱：edu@antvsion.com

文章类型：黑客极客技术、信息安全热点安全研究分析等安全相关

通过审核并发布能收获 200-800 元不等的稿酬。

[更多详情，点我查看！](http://mp.weixin.qq.com/s?__biz=MjM5MTYxNjQxOA==&mid=2652885477&idx=1&sn=39e97a60d7b68d19569284654e74ffa1&chksm=bd59ad288a2e243e4d89b7c456fbd44a93d241c881075b342af22431d93dca56e52076ed75ce&scene=21#wechat_redirect)

![](https://mmbiz.qpic.cn/mmbiz_gif/7QRTvkK2qC6iavic0tIJIoZCwKvUYnFFiaibgSm6mrFp1ZjAg4ITRicicuLN88YodIuqtF4DcUs9sruBa0bFLtX59lQQ/640?wx_fmt=gif&wxfrom=5&wx_lazy=1)

开学大狂欢，戳 “阅读原文”