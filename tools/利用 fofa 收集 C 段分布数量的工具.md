> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [mp.weixin.qq.com](https://mp.weixin.qq.com/s/ptZQurdTuuYBXoflUGSuxQ)<table><tbody><tr><td width="557" valign="top" height="62"><p><strong>声明：</strong>该公众号分享的安全工具和项目均来源于网络，仅供安全研究与学习之用，如用于其他用途，由使用者承担全部法律及连带责任，与工具作者和本公众号无关。</p></td></tr></tbody></table>

现在只对常读和星标的公众号才展示大图推送，建议大家把 Hack 分享吧 “设为星标”，否则可能看不到了！  

**工具介绍**

一款基于 fofa 根据域名或 fofa 语法收集 C 段分布数量的工具  

**工具更新**

2023.6.28 更新  

修复了 fofa 近期对 api 中的 cloud_name 的 field 进行限制导致工具无法正常执行的 bug。目前已删除了 cloud_name 的标签查询，主要通过 org 标签来判断是否为云服务器。实际上 org 标签判断的广度其实高于 cloud_name 标签  

### 2023.5.29 更新

*   1. 修复了 count 计数去重存在问题的 bug
    
*   2. 添加 - cloud 参数，可识别该段是否为云服务器
    

云服务器的 fofa 指纹目前整理如下，主要识别方式通过 org 和 cloud_name 2 个字段进行判别，命中 cloud_name 基本上确定是云了，如果命中 org 字段可能是云也有可能是云厂商自家的资产。

```
华为云 - Huawei Cloud Service data center [cloud_]
阿里云 - Hangzhou Alibaba Advertising Co.,Ltd. & Alibaba US Technology Co., Ltd. [cloud_]
腾讯云 - Shenzhen Tencent Computer Systems Company Limited & Tencent Building, Kejizhongyi Avenue [cloud_]
百度云 - Beijing Baidu Netcom Science and Technology Co., Ltd. [cloud_]
亚马逊云 - AMAZON-02 & AMAZON-AES [cloud_]
google云 - GOOGLE-IT & GOOGLE [cloud_]
azure云 - MICROSOFT-CORP-MSN-AS-BLOCK [cloud_]
Cloudflare - CLOUDFLARENET [cloud_]

```

效果如下

```
main.exe -f 1.txt -sc -cloud

```

![](https://mmbiz.qpic.cn/sz_mmbiz_png/79gZQNibQ6ueomWubYoorWIc2VAxr4D9g16gcicgAMvjwzXkgEibS6uMfNKzUCfMTvuFyZdicO1L4mUfBGa3UomCag/640?wx_fmt=png)

**编译运行‍**

```
cd Ceyes/main
go build

```

之后会在目标下产生一个 main 的可执行文件，第一次使用直接运行它，会在相同目录下生成一个 config.yaml 文件 内容如下  

```
fofa_email: ""
Fofa_api: ""

```

填上自己的 fofa 邮箱和 api 即可，这里最好用高级会员，因为高级会员 api 一次可以查 1W 条数据，方便更加全面的统计 c 段分布。如果是普通会员的 api 查的数据很少，不一定全面。

**使用方式**

功能点如下  

```
main.exe -h
Usage of main.exe:
  -cloud
        check cloud
  -d string
        domain deafult use dork like (domain= xxx || host= xxx)
  -f string
        domain text
  -s string
        fofa search dork
  -sc
        sort result by count, deafult ip sort

```

#### 排序功能

通过 - sc 参数可以对结果进行排序，加上 - sc 参数会将结果按 c 段个数排序，不加 - sc 则按 ip 进行排序

#### 用法 1 根据 fofa 语句查询分布情况

这里得注意下，因为 fofa 语法中要用到双引号，所有正确写法如下

```
main.exe -s "title=\"北京大学\"" -sc

```

![](https://mmbiz.qpic.cn/sz_mmbiz_png/79gZQNibQ6ueomWubYoorWIc2VAxr4D9gPeVRtiaXiaptm8MkEiblg7OSLwgwdzN43SzKJTbgibXeibMqI13QFogic4rw/640?wx_fmt=png)

#### 用法 2 根据主域名查询分布情况

```
main.exe -d "jd.com" -sc

```

![](https://mmbiz.qpic.cn/sz_mmbiz_png/79gZQNibQ6ueomWubYoorWIc2VAxr4D9g6afLBfDfGDMibEYAgOdXJ5lFOoM0sPbAblS86Z240K51yvYz3nF5OKg/640?wx_fmt=png)

#### 用法 3 通过文件进行域名查询

这里文件内容通常是收集到主域名，比如下

```
//1.txt
qq.com
weixin.com
tencent.com

```

Ceyes 工具会对目标进行每个域名的 ip 分布进行信息收集，也会对最后的结果进行汇总

![](https://mmbiz.qpic.cn/sz_mmbiz_png/79gZQNibQ6ueomWubYoorWIc2VAxr4D9gGSTT2Gq8cibPnFS6W3d8FibNYibbDAic0U3SMEyLrj94PfcEPib86jOkAPA/640?wx_fmt=png)

当然我之前写到 IEyes 可以通过查备案快速收集域名，配合起来用也很不错

```
https://github.com/SiJiDo/IEyes

```

![](https://mmbiz.qpic.cn/sz_mmbiz_png/79gZQNibQ6ueomWubYoorWIc2VAxr4D9gJSmPbL1qiaruAvTq51vyllGxQDWeEyBicZtSCfsIX8FDfa6FRw2WR13g/640?wx_fmt=png)

**下载地址**

**点击下方名片进入公众号**

**回复关键字【****2310****15****】获取******下载链接****

**信 安 考 证**

  

  

需要考以下各类安全证书的可以联系我，价格优惠、组团更便宜，还送【潇湘信安】知识星球 **1** 年！

<table><tbody><tr><td width="557" valign="top"><p>CISP、PTE、PTS、DSG、IRE、IRS、NISP、PMP、CCSK、CISSP、ISO27001...</p></td></tr></tbody></table>

![](https://mmbiz.qpic.cn/mmbiz_jpg/XOPdGZ2MYOeH17P4KeKnWkbLrWiaWOb0F1PCq8qME7Y67R45o7kW1iabxmbbd4yldq5cA3HsQZo2Q6lB3rYUVSUA/640?wx_fmt=jpeg)

往期推荐工具

[渗透测试常用的数据库综合利用工具](http://mp.weixin.qq.com/s?__biz=MzA4NzU1Mjk4Mw==&mid=2247484579&idx=1&sn=2f2054508220223100066edf3064b37b&chksm=9036e21ba7416b0d7afecc97d3338d954023a51a5622939782273f264207363e4ea8ba9d18de&scene=21#wechat_redirect)

[RequestTemplate 红队内网渗透工具](http://mp.weixin.qq.com/s?__biz=MzA4NzU1Mjk4Mw==&mid=2247484512&idx=1&sn=90d24f2727ba99c870d7112c406bf208&chksm=9036e2d8a7416bce7e190896de3c7cbd428d385d5563717bce46b0c7f51f33ea18d3e0f1af1e&scene=21#wechat_redirect)

[Railgun - 一款 GUI 界面的渗透工具](http://mp.weixin.qq.com/s?__biz=MzA4NzU1Mjk4Mw==&mid=2247484499&idx=1&sn=edeae57e8306db1bfdcb72e0b0b655d2&chksm=9036e2eba7416bfdbe6a495b60a89d1a677fc745aa512036072224fc1537d8931276e55f7c90&scene=21#wechat_redirect)

[GoBypass - Golang 免杀生成工具](http://mp.weixin.qq.com/s?__biz=MzA4NzU1Mjk4Mw==&mid=2247484019&idx=1&sn=05133dd5cb31474078eb4ab019f164f3&chksm=9036e4cba7416ddd92c8f9147bb2d283ddedcdfb4d46ed5987d192863008be9bc655025e0697&scene=21#wechat_redirect)

[ByPassBehinder 冰蝎 WebShell 免杀工具](http://mp.weixin.qq.com/s?__biz=MzA4NzU1Mjk4Mw==&mid=2247484096&idx=1&sn=487a1f9daf0090071913aeceeb266d53&chksm=9036e478a7416d6ebced132fe4a03bb1d2584d7fb3eb433612151648743322ff900ae849d572&scene=21#wechat_redirect)

[SweetBabyScan 内网资产探测漏扫工具](http://mp.weixin.qq.com/s?__biz=MzA4NzU1Mjk4Mw==&mid=2247484070&idx=1&sn=eb4cd4f6aac6e0a0ef26a75e4bc2bc7a&chksm=9036e41ea7416d088f70e8593099f750c81b079de1b4b14219276b352a2e83a3eb1d5829c94b&scene=21#wechat_redirect)

[掩日 - 适用于红队的综合免杀工具](http://mp.weixin.qq.com/s?__biz=MzA4NzU1Mjk4Mw==&mid=2247483997&idx=1&sn=1a87fc6bfec2a48dd3dfa5bc2852e8e8&chksm=9036e4e5a7416df3ff7f5b4cf55b4c8c57cde271128de0b9fcdf381a19afb207223deb88fb61&scene=21#wechat_redirect)

[AuxTools 浮鱼渗透辅助工具箱 V1](http://mp.weixin.qq.com/s?__biz=MzA4NzU1Mjk4Mw==&mid=2247483907&idx=1&sn=4e7cf5de0472f6685edb64a598e6aff8&chksm=9036e4bba7416dad5aa253462a84d0c47fdb4e89914c70bd5a3fbbd8b4ef05572a4e7e702faa&scene=21#wechat_redirect).0

[POCbomber 红队快速打点漏洞检测工具](http://mp.weixin.qq.com/s?__biz=MzA4NzU1Mjk4Mw==&mid=2247483790&idx=1&sn=35e3a0fa64cff8d72313fa41ddcbfc3c&chksm=9036e736a7416e20dcd23cfede5c887bfecf5e489234eeb67040bcbbc6326cb42373d226a186&scene=21#wechat_redirect)